"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1572],{8992:(e,t,a)=>{a.d(t,{E:()=>m,i:()=>f});var r=a(27545),n=a(28674),s=a(48611),o=a(12703),l=a(31781),d=a(52337),i=a(24595),c=a(2006),u=a(91572),p=a(90590);let m={private:{babyIcon:(0,r.jsx)(o.F,{size:14}),icon:(0,r.jsx)(l.C,{})},team:{babyIcon:(0,r.jsx)(s.z,{className:"p-[3px]",size:16}),icon:(0,r.jsx)(s.z,{})},"team-edit":{babyIcon:(0,r.jsx)(s.z,{className:"p-[3px]",size:16}),icon:(0,r.jsx)(s.z,{}),visibleInPicker:!1},unlisted:{babyIcon:(0,r.jsx)(d.N,{className:"p-[3px]",size:16}),icon:(0,r.jsx)(d.N,{})},public:{babyIcon:(0,r.jsx)(n.q,{className:"p-[3px]",size:16}),icon:(0,r.jsx)(n.q,{})}};function f(e){let{chatId:t,privacy:a}=e,n=(0,i.k)("chatPrivacy"),{setShareDialog:s}=(0,u.B)();return a&&t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.E,{className:"pointer-events-auto hidden gap-0 text-[11px] sm:flex",onClick:()=>s({chatId:t,privacy:a}),size:"sm",variant:"outline",children:[m[a].babyIcon,(0,r.jsx)("p",{children:n("label",a)})]}),(0,r.jsx)(p.Tooltip,{content:n("label",a),children:(0,r.jsx)("button",{className:"flex sm:hidden",onClick:()=>s({chatId:t,privacy:a}),children:m[a].icon})})]}):null}},20862:(e,t,a)=>{a.d(t,{D:()=>s});var r=a(56243),n=a.n(r);function s(e,t){return t?"".concat(n()(t.slice(0,50)),"-").concat(e):e}},23105:(e,t,a)=>{a.d(t,{C1:()=>p,Ir:()=>u,K1:()=>s,Mb:()=>r,RA:()=>c,_z:()=>n,n1:()=>m,pe:()=>d,qQ:()=>o,qR:()=>l});let r=(e,t,a)=>{if(!e)return;let r=e.findIndex(e=>e===t);return r<0?e:[...e.slice(0,r),a]},n=(e,t)=>void 0===e?[t]:[...e,t],s=e=>e&&e.length>0?e[e.length-1]:void 0,o=(e,t)=>e?[...e.slice(0,e.length-1),t]:n(void 0,t),l=(e,t)=>{if(!e)return;let a=e.findIndex(e=>e===t);if(!(a<0))return e[a-1]},d="<ROOT_MESSAGE>";function i(e){let t=new Map;for(let a of e){let e=a.parentId||d;t.set(e,[...t.get(e)||[],a])}return t}function c(e){let t=i(e),a=new Set,r=new Map,s=(e,o)=>{var l;if(e&&a.has(e.id))return;let i=t.get(e?e.id:d);e&&a.add(e.id);let c=[];for(let e=0;e<(null!==(l=null==i?void 0:i.length)&&void 0!==l?l:0);e++){let t=i[e],a=n(o,t.id);c.push(a),s(t,a)}r.set(e?e.id:d,c)};return s(void 0,void 0),r}function u(e,t){let a=i(e),r=new Set,n=[];return!function e(t){if(!r.has(t))for(let s of(r.add(t),a.get(t)||[]))n.push(s.messageId),e(s.messageId)}(t||d),n}function p(e,t){let a=t,r=i(e),o=s(a)||d,l=r.get(o)||[],c=new Set;for(;l.length>0;){let{id:e}=l[0];if(c.has(e))break;c.add(e),a=n(a,e),l=r.get(e)||[]}return a}function m(e,t,a){let r,o=t;if(0===e.length)return;let l=i(e),c=e=>{var t,a;let r=new Set,o=null===(t=l.get(e&&s(e)||d))||void 0===t?void 0:t[0],i=e;for(;o&&!r.has(o.messageId);)r.add(o.messageId),i=n(i,o.messageId),o=null===(a=l.get(o.messageId))||void 0===a?void 0:a[0];return i};if(!o)return c();e.some(e=>e.messageId===o)||(o=e.reduce((e,t)=>e.createdAt>t.createdAt?e:t).messageId,null==a||a());let u=new Set;return!function e(t,a){if(!u.has(t||d))for(let s of(u.add(t||d),l.get(t||d)||[])){let t=n(a,s.messageId);if(s.messageId===o){r=t;return}e(s.messageId,t)}}(void 0,void 0),c(r)}},25542:(e,t,a)=>{a.d(t,{hN:()=>v,jh:()=>N});var r=a(87240),n=a(65618),s=a(88701),o=a(23338);let l=o.z.object({id:o.z.string(),name:o.z.string(),url:o.z.string(),content:o.z.string().or(o.z.instanceof(ArrayBuffer)).optional(),status:o.z.enum(["uploading","done","compressing"]).optional(),size:o.z.number(),isImage:o.z.boolean(),isSavedDraft:o.z.boolean().optional(),v0Type:s.bZ,tokens:o.z.number().optional(),contentType:o.z.string().optional()}),d="new-chat-prompt-draft",i=o.z.object({version:o.z.literal(1),drafts:o.z.record(o.z.string(),o.z.object({message:o.z.string(),isMessageTrimmed:o.z.boolean().optional(),isExpandedDraft:o.z.boolean().optional(),quote:o.z.string().optional(),inputHeight:o.z.number().optional(),localFileInfos:o.z.array(l),fileMap:o.z.record(o.z.string(),o.z.object({name:o.z.string().optional(),contentType:o.z.string().optional(),url:o.z.string(),size:o.z.number(),isSavedDraft:o.z.boolean().optional(),v0Type:s.bZ})),updatedAt:o.z.number()}))});var c=a(39149),u=a(41664),p=a(45629),m=a(82325),f=a(79603),g=a(62787);let h="chat-prompt-drafts",I=e=>({version:1,drafts:{[e]:{message:"",localFileInfos:[],fileMap:{},updatedAt:Date.now()}}});function x(e){let t=JSON.parse(JSON.stringify(e));for(let e in t.drafts){for(let a of(t.drafts[e].fileMap={},t.drafts[e].localFileInfos))delete a.content;if(t.drafts[e].localFileInfos=t.drafts[e].localFileInfos.slice(0,3),t.drafts[e].message){let a=t.drafts[e].message.length>=100;t.drafts[e].isMessageTrimmed=a,t.drafts[e].message=a?"":t.drafts[e].message}t.drafts[e].quote&&(t.drafts[e].quote=t.drafts[e].quote.slice(0,200))}r.A.set(n.kK,JSON.stringify(t),{expires:n.Cy})}let y=e=>{let t;let{chatId:a,newData:r}=e,n=a||d,s=localStorage.getItem(h);try{if((t=i.parse(JSON.parse(s||"{}"))).drafts[n]||(t.drafts[n]=I(n).drafts[n]),Object.keys(t.drafts).length>6){let{minKey:e,minValue:a}={minKey:"",minValue:1/0};for(let r in t.drafts)r!==d&&r!==n&&t.drafts[r].updatedAt<a&&(e=r,a=t.drafts[r].updatedAt);e&&delete t.drafts[e]}}catch(e){t=I(n)}t.drafts[n]={...t.drafts[n],...r},t.drafts[n].updatedAt=Date.now();try{localStorage.setItem(h,JSON.stringify(t)),x(t)}catch(e){var o,l;(0,g.u)("PromptDraftSaveError",{errorMsg:e instanceof Error?e.message:String(e),messageLength:null===(o=r.message)||void 0===o?void 0:o.length,quoteLength:null===(l=r.quote)||void 0===l?void 0:l.length})}},v=e=>{let t;let{chatId:a}=e,s=localStorage.getItem(h);try{t=i.parse(JSON.parse(s||"{}")),delete t.drafts[a||d],localStorage.setItem(h,JSON.stringify(t)),x(t)}catch(e){localStorage.removeItem(h),r.A.remove(n.kK)}},b=e=>{let t=e||d,a=localStorage.getItem(h);try{let e=i.parse(JSON.parse(a||"{}"));x(e);let r=e.drafts[t];if(!r)return x(e),null;return{...r,source:"localStorage",key:t}}catch(e){return r.A.remove(n.kK),localStorage.removeItem(h),null}};function N(){let{chatId:e}=(0,p.xz)(),{isEmpty:t}=(0,m.tZ)(),a=(0,f.usePathname)(),{data:r,mutate:n}=(0,u.Ay)(["chat:drafts",t?null:e]);return(0,c.useEffect)(()=>{if((null==r?void 0:r.source)==="cookie"){let a=b(t?void 0:e);n(a?{...a,isExpandedDraft:r.isMessageTrimmed}:null)}},[r,n,t,e]),{setDraft:n,draft:r,handleSavePromptDraft:(0,c.useCallback)(r=>{var n;(null===(n=r.localFileInfos)||void 0===n?void 0:n.some(e=>"application/zip"===e.contentType))&&(r={...r,localFileInfos:r.localFileInfos.filter(e=>"application/zip"!==e.contentType)}),a.startsWith("/chat/projects")||y({chatId:t?void 0:e,newData:r})},[t,e,a])}}},36324:(e,t,a)=>{a.d(t,{U:()=>d});var r=a(27545),n=a(85551),s=a(53568),o=a(93947),l=a(39149);function d(e){let{isCopied:t,size:a,className:d,customIcon:i}=e,[c,u]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{t&&u(!0)},[t]),(0,r.jsx)("span",{"aria-hidden":!0,className:d,children:(0,r.jsx)(s.kd,{children:t?(0,r.jsx)(s.eJ,{children:(0,r.jsx)(n.J,{size:a})},"check"):(0,r.jsx)(s.eJ,{preventAnimation:!c,children:i||(0,r.jsx)(o.T,{size:a})},"copy")})})}},38898:(e,t,a)=>{a.d(t,{f:()=>b});var r=a(27545),n=a(39149),s=a(70244),o=a(45629),l=a(76441),d=a(82325),i=a(62787),c=a(91572),u=a(24595),p=a(6145);let m=(0,p.createServerReference)("403be4de740ff043bcef891148d742e75c26744a64",p.callServer,void 0,p.findSourceMapURL,"updateChatPrivacy");var f=a(36990),g=a(8992),h=a(10928),I=a(3906),x=a(65177),y=a(10289),v=a(39823);function b(e){let{privacy:t,variant:a,chatId:u}=e,{isTeam:p,activeScope:g}=(0,h.k6)(),[I,x]=(0,n.useTransition)(),{chatId:y}=(0,o.xz)(),{setChatPrivacy:v}=(0,d.kM)(),{revalidate:b}=(0,l.m)(),{setShareDialog:j,showShareDialog:w}=(0,c.B)(),{ownerId:k}=(0,d.tZ)(),[q,z]=(0,n.useState)(!1),Q=!k||k===(null==g?void 0:g.id),C=(0,n.useCallback)(e=>{u===y&&v(e),"object"==typeof w&&j({chatId:u,privacy:e})},[u,y,w,v,j]),A=(0,n.useCallback)(e=>{!I&&u&&e!==t&&(C(e),("public"===e||"team"===e)&&(0,i.u)("ShareChat",{targetChatId:u,team:"team"===e}),x(async()=>{let r=await m({chatId:u,privacy:e});b(),"error"in r?((0,f.z)(Error(r.error))||s.oR.error("Failed to update ".concat("chat"===a?"chat":"chat and block"," privacy")),C(null!=t?t:"private")):s.oR.success("".concat("chat"===a?"Chat":"Chat and block"," privacy updated"))}))},[I,u,t,C,b,a]);return(0,r.jsx)(N,{pending:I,hideWarning:"block"===a,privacy:t,setPrivacy:A,open:q,setOpen:z,isOwnedByCurrentTeam:Q,isTeam:p})}function N(e){let{pending:t,privacy:a,setPrivacy:n,open:s,setOpen:o,hideWarning:l,isOwnedByCurrentTeam:d,isTeam:i}=e,c=(0,u.k)("chatPrivacy"),p=d&&("team"===a||"team-edit"===a);return(0,r.jsxs)("div",{className:"flex w-full flex-col justify-between gap-3",children:[(0,r.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,r.jsxs)(x.l6,{disabled:t,value:a,onValueChange:n,open:s,onOpenChange:o,children:[(0,r.jsx)(x.bq,{className:"h-8 w-full rounded-md border border-gray-200 px-2 text-left",children:(0,r.jsx)(x.yv,{placeholder:"Select privacy setting",className:"flex w-full flex-row justify-between",children:a?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-gray-500",children:g.E[a].icon}),(0,r.jsx)("span",{children:c("title",a)})]}):null})}),(0,r.jsx)(x.gC,{className:"max-w-[95vw]",children:Object.keys(g.E).map(e=>{if((!i||!d)&&("team"===e||"team-edit"===e))return null;let n=g.E[e];return!1===n.visibleInPicker?null:(0,r.jsx)(x.eb,{value:e,className:(0,I.cn)("flex cursor-pointer items-center justify-between p-3 hover:bg-gray-100",a===e&&"bg-gray-100"),onSelect:e=>e.preventDefault(),iconOnRight:!0,icon:t?(0,r.jsx)(y.y,{}):void 0,children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-gray-500",children:n.icon}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:c("title",e)}),(0,r.jsx)("p",{className:"line-clamp-1 text-sm text-gray-500",children:c("description",e)})]})]})},e)})})]}),p&&(0,r.jsxs)(x.l6,{disabled:t,value:a,onValueChange:n,children:[(0,r.jsx)(x.bq,{className:"h-8 min-w-28 max-w-28 rounded-lg border border-gray-200 px-2 text-left text-sm",children:(0,r.jsx)(x.yv,{placeholder:"Select privacy setting",children:(0,r.jsx)("span",{children:c("teamSecondaryOptions",a)})})}),(0,r.jsx)(x.gC,{className:"w-[350px] rounded-lg border border-gray-200 shadow-lg",children:["team","team-edit"].map(e=>(0,r.jsx)(x.eb,{value:e,className:(0,I.cn)("flex cursor-pointer items-center justify-between p-3 hover:bg-gray-100",a===e&&"bg-gray-100"),iconOnRight:!0,icon:t?(0,r.jsx)(y.y,{}):void 0,children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-gray-500",children:g.E[e].icon}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:c("teamSecondaryOptions",e)}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:c("teamSecondaryDescription",e)})]})]})},e))})]})]}),"public"!==a||l?null:(0,r.jsx)(v.$,{})]})}},39823:(e,t,a)=>{a.d(t,{$:()=>o});var r=a(27545),n=a(79453),s=a(54797);function o(){return(0,r.jsxs)(n.Fc,{variant:"default",className:"relative flex flex-row gap-1 rounded-md border-none bg-gray-100 px-2 py-1.5",children:[(0,r.jsx)("div",{className:"absolute left-[9px] top-[9px] text-gray-500",children:(0,r.jsx)(s.$,{className:"h-4 w-4"})}),(0,r.jsx)(n.TN,{className:"ml-6 text-gray-800",children:"Viewers will have access to all code in this chat, including API keys and credentials."})]})}},45629:(e,t,a)=>{a.d(t,{Pk:()=>p,jo:()=>u,xz:()=>c});var r=a(41664),n=a(51267),s=a(39149),o=a(64991),l=a(47901),d=a(79603);let i=["/chat/internal","/chat/projects","/chat/upgrade","/chat/explore","/chat/block-subdomain","/chat/blocks","/chat/history"];function c(){let{data:e,mutate:t}=(0,r.Ay)("chat:id"),a=(0,d.usePathname)();return(0,s.useEffect)(()=>{i.includes(a)&&t(void 0,!1)},[a,t]),{chatId:e}}function u(){let{chatId:e}=c(),{saveLeafMessageId:t,cacheForkKey:a}=(0,l.f)(),{mutate:r}=(0,n.iX)();return(0,s.useCallback)(n=>{r(["chat:state",e],r=>{let s=null!=r?r:o.k;return(s.activeForkKey&&a(s.activeForkKey),"function"==typeof n)?{...s,...n(s)}:(n.activeForkKey&&n.saveLeafMessageId&&e&&(delete n.saveLeafMessageId,t({chatId:e,activeForkKey:n.activeForkKey})),{...s,...n})})},[e,r,a,t])}function p(){let{chatId:e}=c(),{data:t}=(0,r.Ay)(["chat:state",e]);return{...null!=t?t:o.k,chatId:null!=e?e:"something_went_wrong"}}},47901:(e,t,a)=>{a.d(t,{f:()=>c});var r=a(23105),n=a(69388),s=a(41664),o=a(45629),l=a(39149);let d={};async function i(e,t){let{arg:a}=t,n=(0,r.K1)(a.activeForkKey);if(n)return fetch(e,{method:"POST",body:JSON.stringify({chatId:a.chatId,messageId:n})}).then(e=>e.json())}function c(){let{chatId:e}=(0,o.xz)(),{trigger:t}=(0,n.A)("/chat/api/chat/leaf",i),{data:a,mutate:r}=(0,s.Ay)(["chat:leaf:cache",e],null),c=(0,l.useCallback)(e=>{r(t=>{if(!e)return t;let a=!1,r={...t||d};for(let t of e)r[t]!==e&&(r[t]=e,a=!0);return a?r:t})},[r]),u=(0,l.useCallback)(e=>{let{chatId:a,activeForkKey:r}=e;a&&t({chatId:a,activeForkKey:r})},[c,t]);return{cacheForkKey:c,saveLeafMessageId:u,forkKeyCache:a||d,switchForkKey:c}}},53568:(e,t,a)=>{a.d(t,{Dp:()=>p,Ez:()=>i,eJ:()=>u,kd:()=>m});var r=a(27545),n=a(39149),s=a(26552),o=a(71581),l=a(2731),d=a(73950);let i={duration:.35,ease:[.35,.2,.14,.95]},c={x:0,y:0,z:0,rotate:0,scale:1,skew:0,opacity:1};function u(e){let{children:t,preventAnimation:a=!1}=e;return(0,r.jsx)(l.P.span,{animate:{opacity:1},initial:{opacity:+!!a},children:t})}function p(e){let{children:t,variants:a,transition:u}=e,{ref:p,controls:m,fullVariants:f}=function(e,t,a){let r=(0,s.I)(),l=(0,n.useContext)(d.w),u=(0,o.E)(),p=(0,n.useRef)(null),m=(0,n.useRef)("idle"),f=(0,n.useRef)(!1),g=(0,n.useRef)(!1),h=(0,n.useMemo)(()=>({idle:{...c,...t.idle},hover:{...c,...t.hover},tap:{...c,...t.tap}}),[t]),I=(0,n.useCallback)(async e=>{let t=h[m.current],r=h[e];if(f.current&&!1===t.interruptible||g.current||e===m.current&&f.current)return;f.current=!0;let n=m.current;m.current=e;try{await u.start({...r,transition:r.transition||a||i})}catch(e){m.current=n}finally{if(f.current=!1,r.after&&m.current===e){let{state:e,delay:t=0}=r.after;g.current=!0,setTimeout(()=>{g.current=!1,I(e)},1e3*t)}else m.current!==e&&I(m.current)}},[u,a,h]);return(0,n.useEffect)(()=>{if(!l||r)return;let t=function e(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t?"BUTTON"===t.tagName||"A"===t.tagName?t:a>10?(console.warn("Animated Icon can't find valid parent element (<button> or <a>) after 10 iterations. Falling back to root element."),null):e(t.parentElement,a+1):null}(p.current);if(t)return l.registerIcon(e,{parent:t,transitionTo:I}),()=>{l.unregisterIcon(e)}},[]),{ref:p,controls:u,fullVariants:h}}((0,n.useRef)(Math.random().toString(36).substr(2,9)).current,a,u);return(0,r.jsx)(l.P.span,{animate:m,className:"transition-none",initial:"idle",ref:p,variants:f,children:t})}function m(e){let{children:t,hideOverflow:a}=e;return(0,r.jsx)("span",{className:"grid [&>*]:[grid-area:1/1] ".concat(a?"overflow-hidden":""),children:t})}},64991:(e,t,a)=>{a.d(t,{O:()=>n,k:()=>r});let r={messages:[],isLoading:!1,activeForkKey:void 0,isContinuing:!1,isStreaming:!1,isAuthor:!1,isRestoring:!1},n={title:"",isEmpty:!0,isNew:!1,authorId:"",ownerId:""}},65177:(e,t,a)=>{a.d(t,{bq:()=>m,eb:()=>I,gC:()=>h,l6:()=>c,s3:()=>u,yv:()=>p});var r=a(27545),n=a(39149),s=a(10200),o=a(3906),l=a(51971),d=a(13818),i=a(85551);let c=s.bL,u=s.YJ,p=s.WT,m=n.forwardRef((e,t)=>{let{className:a,children:n,chevron:d,hideChevron:i=!1,...c}=e;return(0,r.jsxs)(s.l9,{className:(0,o.cn)("border-input bg-background ring-offset-background placeholder:text-muted-foreground flex h-10 w-full items-center justify-between rounded-md border px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),ref:t,...c,children:[n,i?null:(0,r.jsx)(s.In,{asChild:!0,children:null!=d?d:(0,r.jsx)(l.y,{className:"size-4 translate-y-[0.5px] text-gray-500 [&_path]:fill-gray-500"})})]})});m.displayName=s.l9.displayName;let f=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.PP,{className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),ref:t,...n,children:(0,r.jsx)(d.r,{className:"h-4 w-4"})})});f.displayName=s.PP.displayName;let g=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.wn,{className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),ref:t,...n,children:(0,r.jsx)(l.y,{className:"h-4 w-4"})})});g.displayName=s.wn.displayName;let h=n.forwardRef((e,t)=>{let{className:a,children:n,position:l="popper",...d}=e;return(0,r.jsx)(s.ZL,{children:(0,r.jsxs)(s.UC,{className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,ref:t,...d,children:[(0,r.jsx)(f,{}),(0,r.jsx)(s.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,r.jsx)(g,{})]})})});h.displayName=s.UC.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.JU,{className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),ref:t,...n})}).displayName=s.JU.displayName;let I=n.forwardRef((e,t)=>{let{className:a,children:n,icon:l,iconOnRight:d,...c}=e;return(0,r.jsxs)(s.q7,{className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),ref:t,...c,children:[(0,r.jsx)("span",{className:(0,o.cn)("absolute flex h-3.5 w-3.5 items-center justify-center",d?"right-2":"left-2"),children:(0,r.jsx)(s.VF,{children:l||(0,r.jsx)(i.J,{className:"h-3 w-3"})})}),(0,r.jsx)(s.p4,{children:n})]})});I.displayName=s.q7.displayName,n.forwardRef((e,t)=>{let{className:a,children:n,...l}=e;return(0,r.jsxs)(s.q7,{ref:t,className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(s.VF,{children:(0,r.jsx)(i.J,{className:"h-4 w-4"})})}),(0,r.jsx)(s.p4,{children:n})]})}).displayName=s.q7.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.wv,{className:(0,o.cn)("bg-muted -mx-1 my-1 h-px",a),ref:t,...n})}).displayName=s.wv.displayName},73950:(e,t,a)=>{a.d(t,{AnimatedIconProvider:()=>o,w:()=>s});var r=a(27545),n=a(39149);let s=(0,n.createContext)(null);function o(e){let{children:t}=e,[a,o]=(0,n.useState)(()=>new Map),l=(0,n.useRef)(null),d=(0,n.useCallback)(e=>{let t=e.target;a.forEach((a,r)=>{if(a.parent.contains(t))switch(e.type){case"mouseover":l.current!==r&&(l.current=r,a.transitionTo("hover"));break;case"mouseout":a.parent.contains(e.relatedTarget)||(l.current=null,a.transitionTo("idle"));break;case"mousedown":a.transitionTo("tap");break;case"mouseup":a.transitionTo(l.current===r?"hover":"idle")}else"mouseover"===e.type&&l.current===r&&(l.current=null,a.transitionTo("idle"))})},[a]);(0,n.useEffect)(()=>(window.addEventListener("mouseover",d,!0),window.addEventListener("mouseout",d,!0),window.addEventListener("mousedown",d,!0),window.addEventListener("mouseup",d,!0),()=>{window.removeEventListener("mouseover",d,!0),window.removeEventListener("mouseout",d,!0),window.removeEventListener("mousedown",d,!0),window.removeEventListener("mouseup",d,!0)}),[d]);let i=(0,n.useCallback)((e,t)=>{o(a=>new Map(a).set(e,t))},[]),c=(0,n.useCallback)(e=>{o(t=>{let a=new Map(t);return a.delete(e),a})},[]);return(0,r.jsx)(s.Provider,{value:{registerIcon:i,unregisterIcon:c},children:t})}},76441:(e,t,a)=>{a.d(t,{m:()=>d,r:()=>i});var r=a(39149),n=a(41664),s=a(10928),o=a(21276);function l(e,t){let{activeScopeSlug:a}=(0,s.k6)(),{data:l,isLoading:d,mutate:i}=(0,n.Ay)(["chat:".concat(e),a],async t=>{let[,a]=t;if(a)try{let t=await fetch("history"===e?"/chat/api/history":"/chat/api/favorites",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to load chat ".concat(e));let a=await t.json();if(!a)throw Error("Failed to load chat ".concat(e));return a.map(e=>({...e,updatedAt:new Date(e.updatedAt)}))}catch(e){if(e==o.hB)return;throw e}},{fallbackData:t}),c=(0,r.useCallback)((e,t)=>{let a=e(l||[]);i(a,{optimisticData:a,revalidate:t})},[l,i]);return{data:l,isLoading:d,revalidate:(0,r.useCallback)(()=>i(),[i]),setData:c}}function d(e){return l("history",e)}function i(e){return l("favorites",e)}},76927:(e,t,a)=>{a.d(t,{C:()=>n});var r=a(39149);function n(e){let{timeout:t=2e3}=e,[a,n]=r.useState(!1);return{isCopied:a,copyToClipboard:async e=>{"writeText"in navigator.clipboard&&e&&(await navigator.clipboard.writeText(e),n(!0),setTimeout(()=>{n(!1)},t))}}}},79453:(e,t,a)=>{a.d(t,{Fc:()=>d,TN:()=>i});var r=a(27545),n=a(39149),s=a(33339),o=a(3906);let l=(0,s.F)("[&>svg]:text-foreground relative w-full rounded-lg border p-4 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=n.forwardRef((e,t)=>{let{className:a,variant:n,...s}=e;return(0,r.jsx)("div",{className:(0,o.cn)(l({variant:n}),a),ref:t,role:"alert",...s})});d.displayName="Alert",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("h5",{className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",a),ref:t,...n})}).displayName="AlertTitle";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{className:(0,o.cn)("text-sm [&_p]:leading-relaxed",a),ref:t,...n})});i.displayName="AlertDescription"},82325:(e,t,a)=>{a.d(t,{dW:()=>c,kM:()=>u,sC:()=>i,tZ:()=>d});var r=a(41664),n=a(45629),s=a(39149),o=a(64991),l=a(25542);function d(){let{chatId:e}=(0,n.xz)(),{data:t,mutate:a}=(0,r.Ay)(["chat:meta",e]),l=(0,s.useRef)(null!=t?t:o.O);return{setMetadata:(0,s.useCallback)(e=>a(t=>({...null!=t?t:l.current,...e})),[a]),...null!=t?t:o.O}}function i(){let{chatId:e}=(0,n.xz)(),{handleSavePromptDraft:t}=(0,l.jh)(),{data:a,mutate:o}=(0,r.Ay)(["chat:quote",e]);return{quote:a,setQuote:(0,s.useCallback)(e=>{o(e),t({quote:e||void 0})},[o])}}function c(){let{chatId:e}=(0,n.xz)(),{data:t,mutate:a}=(0,r.Ay)(["chat:shareable",e]);return{shareable:t,setShareable:a}}function u(){let{chatId:e}=(0,n.xz)(),{data:t,mutate:a}=(0,r.Ay)(["chat:privacy",e]);return{chatPrivacy:t,setChatPrivacy:a}}},85422:(e,t,a)=>{a.d(t,{DropdownMenu:()=>i,DropdownMenuContent:()=>h,DropdownMenuGroup:()=>u,DropdownMenuItem:()=>I,DropdownMenuTrigger:()=>c,Hr:()=>m,Ht:()=>N,M5:()=>g,V0:()=>v,hO:()=>b,lp:()=>x,lv:()=>p,mB:()=>y,nV:()=>f});var r=a(27545),n=a(39149),s=a(7329),o=a(3906),l=a(92289),d=a(85551);let i=e=>{let{...t}=e;return(0,r.jsx)(s.bL,{modal:!1,...t})};i.displayName=s.bL.displayName;let c=s.l9,u=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.YJ,{className:(0,o.cn)("p-1.5",a),ref:t,...n})});u.displayName=s.YJ.displayName,s.ZL;let p=s.Pb,m=s.z6,f=n.forwardRef((e,t)=>{let{className:a,inset:n,variant:l="default",...d}=e;return(0,r.jsx)(s.ZP,{className:(0,o.cn)("[_>svg]:!text-gray-500 relative flex h-8 w-full select-none items-center gap-3 rounded-md px-1.5 text-sm text-gray-900 outline-none transition-colors data-[disabled]:pointer-events-none data-[state=open]:bg-gray-100 data-[disabled]:opacity-50 [&_svg]:size-4 [&_svg]:transition-colors",n&&"pl-8","destructive"===l?"text-red-700 focus:bg-[#FF666618] [&_svg]:!text-red-700":"text-gray-900 focus:bg-gray-100 [&_svg]:!text-gray-500",a),ref:t,...d})});f.displayName=s.ZP.displayName;let g=n.forwardRef((e,t)=>{let{className:a,sideOffset:n=12,...l}=e;return(0,r.jsx)(s.G5,{className:(0,o.cn)("bg-background-subtle z-50 min-w-[13.5rem] max-w-[28rem] origin-[var(--radix-dropdown-menu-content-transform-origin)] overflow-hidden rounded-xl shadow-sm [&_svg]:shrink-0","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),ref:t,sideOffset:n,...l})});g.displayName=s.G5.displayName;let h=n.forwardRef((e,t)=>{let{className:a,sideOffset:n=4,...l}=e;return(0,r.jsx)(s.ZL,{children:(0,r.jsx)(s.UC,{className:(0,o.cn)("bg-background-subtle z-50 min-w-[13.5rem] max-w-[28rem] overflow-hidden rounded-xl shadow-sm [&_svg]:shrink-0","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[var(--radix-dropdown-menu-content-transform-origin)]",a),ref:t,sideOffset:n,...l})})});h.displayName=s.UC.displayName;let I=n.forwardRef((e,t)=>{let{className:a,inset:n,variant:l="default",svgStyling:d=!0,...i}=e;return(0,r.jsx)(s.q7,{className:(0,o.cn)("relative flex h-8 w-full select-none items-center gap-3 whitespace-nowrap rounded-md px-1.5 text-sm text-gray-900 outline-none transition-colors focus:bg-gray-100 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_span]:truncate",n&&"pl-8",d&&"[&_svg]:size-4 [&_svg]:transition-colors",d&&{"[&_svg]:!text-gray-500 [&[data-highlighted]_svg]:!text-gray-900":"default"===l,"[&_svg]:!text-red-700":"destructive"===l,"[&_svg]:!text-blue-700":"blue"===l,"[&_svg]:!text-amber-600":"gold"===l,"[&_svg]:!text-green-700":"green"===l},{"text-red-700 focus:bg-[#FF666618]":"destructive"===l,"text-green-700 focus:bg-[#66FF6618]":"green"===l},a),ref:t,...i})});I.displayName=s.q7.displayName;let x=n.forwardRef((e,t)=>{let{className:a,inset:n,...l}=e;return(0,r.jsx)(s.JU,{className:(0,o.cn)("h-8 content-center px-1.5 text-[13px] text-gray-500",n&&"pl-8",a),ref:t,...l})});x.displayName=s.JU.displayName;let y=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.wv,{className:(0,o.cn)("h-px bg-gray-200",a),ref:t,...n})});y.displayName=s.wv.displayName;let v=e=>{let{className:t,...a}=e;return(0,r.jsx)("span",{className:(0,o.cn)("ml-auto text-xs tracking-widest text-gray-500 [&_svg]:size-3.5 [&_svg]:!text-gray-500",t),...a})};v.displayName="DropdownMenuShortcut";let b=n.forwardRef((e,t)=>{let{className:a,children:n,checked:l,...i}=e;return(0,r.jsxs)(s.H_,{checked:l,className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),ref:t,...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(s.VF,{children:(0,r.jsx)(d.J,{className:"h-4 w-4"})})}),n]})});b.displayName=s.H_.displayName;let N=n.forwardRef((e,t)=>{let{className:a,children:n,...d}=e;return(0,r.jsxs)(s.hN,{className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),ref:t,...d,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center rounded-full border",children:(0,r.jsx)(s.VF,{children:(0,r.jsx)(l.A,{className:"h-2 w-2 fill-current"})})}),n]})});N.displayName=s.hN.displayName},88701:(e,t,a)=>{a.d(t,{Je:()=>F,PW:()=>K,bZ:()=>Q});var r=a(65504),n=a(16951),s=a(74493),o=a(96364),l=a(82345),d=a(877),i=a(7345),c=a(72443),u=a(86506),p=a(69792),m=a(58276),f=a(25189),g=a(99359),h=a(25910),I=a(51312),x=a(17780),y=a(7273),v=a(23338);function b(){let e=(0,r._)(["lower(",")"]);return b=function(){return e},e}let N={createdAt:(0,n.vE)("createdAt").defaultNow().notNull(),updatedAt:(0,n.vE)("updatedAt").defaultNow(),deletedAt:(0,n.vE)("deletedAt")},j=v.z.object({diff:v.z.string().optional(),originalCode:v.z.string(),findAndReplace:v.z.string().optional()});v.z.array(v.z.object({searchValue:v.z.string(),replaceValue:v.z.string()})),v.z.object({source:v.z.string().optional(),diffInfo:v.z.object({type:v.z.undefined(),...j.shape}).or(v.z.object({type:v.z.literal("multi-file"),fileToDiffMap:v.z.record(v.z.string(),j)})).optional(),remoteInfo:v.z.object({originalSources:v.z.record(v.z.string(),v.z.string()).optional(),accepted:v.z.boolean().optional()}).optional(),resultId:v.z.string().optional(),title:v.z.string().optional(),lang:v.z.string().optional(),meta:v.z.object({file:v.z.string().optional(),type:v.z.string().optional(),project:v.z.string().optional(),title:v.z.string().optional(),id:v.z.string().optional(),sqlExecutionState:v.z.enum(["applied","error","cancelled"]).optional()}).optional(),env:v.z.array(v.z.object({target:v.z.array(v.z.string()),configurationId:v.z.string().optional(),comment:v.z.string().optional(),id:v.z.string(),key:v.z.string(),createdAt:v.z.number(),updatedAt:v.z.number(),createdBy:v.z.string(),updatedBy:v.z.string().optional(),type:v.z.string(),value:v.z.string()})).optional()}),v.z.array(v.z.object({target:v.z.array(v.z.string()),configurationId:v.z.string().optional(),comment:v.z.string().optional(),id:v.z.string(),key:v.z.string(),createdAt:v.z.number(),updatedAt:v.z.number(),createdBy:v.z.string(),updatedBy:v.z.string().optional(),type:v.z.string(),value:v.z.string()})).optional(),v.z.object({title:v.z.string(),isMultiFile:v.z.boolean().optional(),remote:v.z.object({v:v.z.enum(["1"]),tunnel:v.z.string()}).optional(),from:v.z.string().optional(),isFigmaChat:v.z.boolean().optional(),context:v.z.object({ai:v.z.boolean().optional()}).optional()});let w=(0,s.cJ)("chats",{...N,chatId:(0,o.Qq)("chatId").primaryKey().notNull(),authorId:(0,o.Qq)("authorId").notNull(),ownerId:(0,o.Qq)("ownerId").notNull(),shareable:(0,l.zM)("shareable").notNull().default(!1),projectId:(0,o.Qq)("projectId").references(()=>k.projectId),metadata:(0,d.Fx)("metadata").$type(),summary:(0,o.Qq)("summary"),summaryLastMessageId:(0,o.Qq)("summaryLastMessageId"),currentLeafMessageId:(0,o.Qq)("currentLeafMessageId"),privacy:(0,o.Qq)("privacy").$type().default("private")},e=>({authorIdIndex:(0,i.Pe)("chatsAuthorIdIndex").on(e.authorId),projectIdIndex:(0,i.Pe)("chatsProjectIdIndex").on(e.projectId),ownerIdUpdatedAtIndex:(0,i.Pe)("chatsOwnerIdUpdatedAtIndex").on(e.ownerId,e.deletedAt.desc().nullsFirst(),e.updatedAt.desc()).concurrently()})),k=(0,s.cJ)("projects",{...N,projectId:(0,o.Qq)("projectId").primaryKey().notNull(),name:(0,o.Qq)("name").notNull(),description:(0,o.Qq)("description"),ownerId:(0,o.Qq)("ownerId"),creatorId:(0,o.Qq)("creatorId").notNull(),settings:(0,d.Fx)("settings").$type(),privacy:(0,o.Qq)("privacy").$type().default("private"),vercelProjectId:(0,o.Qq)("vercelProjectId"),env:(0,d.Fx)("env").$type()},e=>({ownerIdIndex:(0,i.Pe)("projectsOwnerIdIndex").on(e.ownerId)}));(0,x.K1)(k,e=>{let{one:t,many:a}=e;return{chats:a(P),sources:a(V),hasUserFavoritedProject:t(D)}});let q=(0,s.cJ)("sources",{...N,sourceId:(0,o.Qq)("sourceId").primaryKey().notNull(),type:(0,o.Qq)("type").$type().notNull(),title:(0,o.Qq)("title"),description:(0,o.Qq)("description"),url:(0,o.Qq)("url"),content:(0,o.Qq)("content"),metadata:(0,d.Fx)("metadata").$type(),errorMessage:(0,o.Qq)("errorMessage"),status:(0,o.Qq)("status").$type().default("pending"),startedAt:(0,n.vE)("startedAt"),finishedAt:(0,n.vE)("finishedAt"),progress:(0,c.x)("progress").default(0),textContentUrl:(0,o.Qq)("textContentUrl")});(0,I.aJ)(q),(0,x.K1)(q,e=>{let{many:t}=e;return{projects:t(V),chats:t(T),messages:t(J)}}),(0,I.aJ)(w),(0,x.K1)(w,e=>{let{one:t,many:a}=e;return{messages:a(C),summaryLastMessage:t(C,{fields:[w.summaryLastMessageId],references:[C.messageId]}),blocks:a(M),sources:a(T),project:t(P),userFavoritedChats:t(B)}});let z=(0,u.rL)("messageType",["message","forked-block","forked-chat","open-in-v0","refinement","added-environment-variables","added-integration","deleted-file","moved-file","renamed-file","edited-file","replace-src","reverted-block","fix-with-v0"]),Q=v.z.enum(["screenshot","figma","zip"]).optional(),C=(0,s.cJ)("messages",{...N,messageId:(0,o.Qq)("messageId").primaryKey().notNull(),chatId:(0,o.Qq)("chatId").notNull().references(()=>w.chatId),content:(0,o.Qq)("content").notNull(),ragSources:(0,d.Fx)("sources").$type(),role:(0,p.yf)("role",{length:255}).notNull(),attachments:(0,d.Fx)("attachments").$type(),finishReason:(0,o.Qq)("finishReason").$type(),messageFeedback:(0,d.Fx)("messageFeedback").$type(),parentId:(0,o.Qq)("parentId"),type:z("type").notNull(),modelId:(0,o.Qq)("modelId").$type(),usage:(0,d.Fx)("usage").$type(),authorId:(0,o.Qq)("authorId").notNull(),metadata:(0,d.Fx)("metadata").$type()},e=>({chatIdIndex:(0,i.Pe)("messagesChatIdIndex").on(e.chatId),authorIdIndex:(0,i.Pe)("messagesAuthorIdIndex").on(e.authorId),createdAtIndex:(0,i.Pe)("messagesCreatedAtIndex").on(e.createdAt)}));(0,I.aJ)(C).shape.type,(0,x.K1)(C,e=>{let{one:t,many:a}=e;return{chat:t(w,{fields:[C.chatId],references:[w.chatId]}),blocks:a(M),feedback:a(R),parent:t(C,{fields:[C.parentId],references:[C.messageId]}),summary:t(A,{fields:[C.messageId],references:[A.messageId]}),sources:a(J)}});let A=(0,s.cJ)("chatMessageSummaries",{...N,chatId:(0,o.Qq)("chatId").notNull().references(()=>w.chatId),messageId:(0,o.Qq)("messageId").notNull().references(()=>C.messageId),content:(0,o.Qq)("content").notNull(),usage:(0,d.Fx)("usage").$type()},e=>({messageIdx:(0,i.Pe)("chatMessageSummariesMessageIdIndex").on(e.messageId),chatMessageUniqueIdx:(0,i.GL)("chatMessageSummariesUniqueIndex").on(e.chatId,e.messageId)}));(0,x.K1)(A,e=>{let{one:t}=e;return{chat:t(w,{fields:[A.chatId],references:[w.chatId]}),message:t(C,{fields:[A.messageId],references:[C.messageId]})}});let S=(0,m._z)({dataType:()=>"text",fromDriver:e=>"react-project"===e?"code-project":e}),E=(0,m._z)({dataType:()=>"jsonb",fromDriver(e){var t;return(null===(t=e.meta)||void 0===t?void 0:t.type)==="react-project"&&(e.meta.type="code-project"),e}}),M=(0,s.cJ)("blocks",{...N,blockId:(0,o.Qq)("blockId").primaryKey().notNull(),blockType:S("blockType").notNull(),chatId:(0,o.Qq)("chatId").notNull().references(()=>w.chatId),messageId:(0,o.Qq)("messageId").notNull().references(()=>C.messageId),data:E("data"),removeBranding:(0,l.zM)("removeBranding").notNull().default(!1),shared:(0,l.zM)("shared").notNull().default(!1),forkedFromBlockId:(0,o.Qq)("forkedFromBlockId"),isBlocked:(0,l.zM)("isBlocked").default(!1),allowCrawling:(0,l.zM)("allowCrawling"),hasSourceBeenEdited:(0,l.zM)("hasSourceBeenEdited").default(!1),latestDeploymentInfo:(0,d.Fx)("latestDeploymentInfo").$type(),templateVersionId:(0,o.Qq)("templateVersionId"),templateCanonId:(0,o.Qq)("templateCanonId"),nextLiteVersion:(0,f.nd)("nextLiteVersion")},e=>{var t;return{chatIdIndex:(0,i.Pe)("blocksChatIdIndex").on(e.chatId),messageIdIndex:(0,i.Pe)("blocksMessageIdIndex").on(e.messageId),createdAtIndex:(0,i.Pe)("blocksCreatedAtIndex").on(e.createdAt),lowerBlockIdIndex:(0,i.Pe)("blockId_lower_idx").on((t=e.blockId,(0,y.ll)(b(),t)))}});(0,I.aJ)(M),(0,x.K1)(M,e=>{let{one:t}=e;return{chat:t(w,{fields:[M.chatId],references:[w.chatId]}),message:t(C,{fields:[M.messageId],references:[C.messageId]}),forkedFromBlock:t(M,{fields:[M.forkedFromBlockId],references:[M.blockId]}),subdomains:t(L),templateVersion:t(Z,{fields:[M.templateVersionId],references:[Z.templateVersionId]}),template:t(G,{fields:[M.templateCanonId],references:[G.templateCanonId]})}});let F=(0,u.rL)("status",["triage","corrected","external_fix","ignored","pending","assigned","resolved"]),K=(0,u.rL)("type",["upvote","downvote"]),R=(0,s.cJ)("feedback",{type:K("type").default("downvote").notNull(),feedbackId:(0,g.vX)("feedbackId").primaryKey(),messageId:(0,o.Qq)("messageId").notNull().references(()=>C.messageId),leafMessageId:(0,o.Qq)("leafMessageId"),submitterId:(0,o.Qq)("submitterId"),reasons:(0,o.Qq)("reasons").array().notNull(),freeform:(0,o.Qq)("freeform").notNull(),quote:(0,o.Qq)("quote"),status:F("status").default("triage").notNull(),comment:(0,o.Qq)("comment"),createdAt:(0,n.vE)("createdAt").defaultNow().notNull(),updatedAt:(0,n.vE)("updatedAt").defaultNow(),deletedAt:(0,n.vE)("deletedAt"),correctionId:(0,o.Qq)("correctionId"),categories:(0,o.Qq)("categories").array().notNull().default([])});(0,x.K1)(R,e=>{let{one:t}=e;return{message:t(C,{fields:[R.messageId],references:[C.messageId]}),correction:t(_,{fields:[R.correctionId],references:[_.correctionId]})}});let _=(0,s.cJ)("corrections",{correctionId:(0,o.Qq)("correctionId").primaryKey().notNull(),feedbackId:(0,f.nd)("feedbackId"),correctorId:(0,o.Qq)("correctorId"),messageId:(0,o.Qq)("messageId"),prompt:(0,o.Qq)("prompt").notNull(),response:(0,o.Qq)("response").notNull(),promotedBlocks:(0,o.Qq)("promotedBlocks").array().notNull(),suppressedBlocks:(0,o.Qq)("suppressedBlocks").array().notNull(),promotedSources:(0,o.Qq)("promotedSources").array().notNull(),suppressedSources:(0,o.Qq)("suppressedSources").array().notNull(),status:(0,o.Qq)("status").$type().default("unset").notNull(),approvedById:(0,o.Qq)("approvedById"),approvedAt:(0,n.vE)("approvedAt"),rejectionReason:(0,o.Qq)("rejectionReason"),createdAt:(0,n.vE)("createdAt").defaultNow().notNull(),updatedAt:(0,n.vE)("updatedAt").defaultNow(),deletedAt:(0,n.vE)("deletedAt")});(0,x.K1)(_,e=>{let{many:t,one:a}=e;return{feedback:t(R),message:a(C,{fields:[_.messageId],references:[C.messageId]})}});let P=(0,s.cJ)("projectsAndChats",{project:(0,o.Qq)("projectId"),chat:(0,o.Qq)("chatId")},e=>({projectIdx:(0,i.Pe)("project_idx").on(e.project),chatIdx:(0,i.GL)("chat_idx").on(e.chat)}));(0,x.K1)(P,e=>{let{one:t}=e;return{project:t(k,{fields:[P.project],references:[k.projectId]}),chat:t(w,{fields:[P.chat],references:[w.chatId]})}});let J=(0,s.cJ)("messagesAndSources",{message:(0,o.Qq)("messageId"),source:(0,o.Qq)("sourceId")},e=>({messageIdx:(0,i.Pe)("messagesAndSources_message_idx").on(e.message),sourceIdx:(0,i.GL)("messagesAndSources_source_idx").on(e.source)})),T=(0,s.cJ)("chatsAndSources",{chat:(0,o.Qq)("chatId"),source:(0,o.Qq)("sourceId")},e=>({chatIdx:(0,i.Pe)("chatsAndSources_chat_idx").on(e.chat),sourceIdx:(0,i.GL)("chatsAndSources_source_idx").on(e.source)})),V=(0,s.cJ)("projectsAndSources",{project:(0,o.Qq)("projectId"),source:(0,o.Qq)("sourceId")},e=>({projectIdx:(0,i.Pe)("projectsAndSources_project_idx").on(e.project),sourceIdx:(0,i.GL)("projectsAndSources_source_idx").on(e.source)}));(0,x.K1)(J,e=>{let{one:t}=e;return{message:t(C,{fields:[J.message],references:[C.messageId]}),source:t(q,{fields:[J.source],references:[q.sourceId]})}}),(0,x.K1)(T,e=>{let{one:t}=e;return{chat:t(w,{fields:[T.chat],references:[w.chatId]}),source:t(q,{fields:[T.source],references:[q.sourceId]})}}),(0,x.K1)(V,e=>{let{one:t}=e;return{project:t(k,{fields:[V.project],references:[k.projectId]}),source:t(q,{fields:[V.source],references:[q.sourceId]})}});let L=(0,s.cJ)("subdomains",{blockId:(0,o.Qq)("blockId").primaryKey().notNull(),subdomain:(0,o.Qq)("subdomain").notNull().unique()});(0,x.K1)(L,e=>{let{one:t}=e;return{block:t(M,{fields:[L.blockId],references:[M.blockId]})}});let B=(0,s.cJ)("userFavoritedChats",{userId:(0,o.Qq)("userId").notNull(),chatId:(0,o.Qq)("chatId").notNull().references(()=>w.chatId),favoritedAt:(0,n.vE)("favoritedAt").defaultNow().notNull()},e=>({pk:(0,h.ie)({columns:[e.userId,e.chatId]}),chatIdIdx:(0,i.Pe)("userFavoritedChats_chatId_idx").on(e.chatId)}));(0,x.K1)(B,e=>{let{one:t}=e;return{chat:t(w,{fields:[B.chatId],references:[w.chatId]})}});let D=(0,s.cJ)("userFavoritedProjects",{userId:(0,o.Qq)("userId").notNull(),projectId:(0,o.Qq)("projectId").notNull().references(()=>k.projectId),favoritedAt:(0,n.vE)("favoritedAt").defaultNow().notNull()},e=>({pk:(0,h.ie)({columns:[e.userId,e.projectId]}),chatIdIdx:(0,i.Pe)("userFavoritedProjects_projectId_idx").on(e.projectId)}));(0,x.K1)(D,e=>{let{one:t}=e;return{projects:t(k,{fields:[D.projectId],references:[k.projectId]})}}),(0,s.cJ)("integrations",{...N,ownerId:(0,o.Qq)("ownerId").notNull(),creatorId:(0,o.Qq)("creatorId").notNull(),settings:(0,d.Fx)("settings").$type(),accessToken:(0,o.Qq)("accessToken").notNull(),refreshToken:(0,o.Qq)("refreshToken"),tokenExpiresAt:(0,n.vE)("tokenExpiresAt"),integrationUserId:(0,o.Qq)("integrationUserId").notNull(),provider:(0,o.Qq)("provider").$type().notNull()},e=>({pk:(0,h.ie)({columns:[e.provider,e.ownerId,e.creatorId]}),figmaIntegrationUserIdIdx:(0,i.Pe)("integrations_integrationUserId_idx").on(e.integrationUserId)})),(0,s.cJ)("apiKeys",{id:(0,o.Qq)("id").primaryKey(),name:(0,o.Qq)("name").notNull(),hashedKey:(0,o.Qq)("hashedKey").notNull(),partialKey:(0,o.Qq)("partialKey").notNull(),created:(0,n.vE)("createdAt").defaultNow().notNull(),lastUsed:(0,n.vE)("lastUsedAt"),ownerId:(0,o.Qq)("ownerId").notNull(),creatorId:(0,o.Qq)("creatorId").notNull()});let O=(0,u.rL)("templateEventType",["fork"]),U=(0,s.cJ)("templateEvents",{...N,templateEventId:(0,o.Qq)("templateEventId").primaryKey().notNull(),type:O("type").notNull(),templateCanonId:(0,o.Qq)("templateCanonId").notNull(),userId:(0,o.Qq)("userId").notNull()},e=>({templateEventsTypeIndex:(0,i.Pe)("templateEvents_type_idx").on(e.type),templateEventsCanonIdIndex:(0,i.Pe)("templateEvents_templateCanonId_idx").on(e.templateCanonId)}));(0,I.aJ)(U),(0,x.K1)(U,e=>{let{one:t}=e;return{templateCanon:t(G,{fields:[U.templateCanonId],references:[G.templateCanonId]})}});let $=(0,s.cJ)("templateReports",{...N,templateCanonId:(0,o.Qq)("templateCanonId").notNull(),templateReportReasonIds:(0,o.Qq)("templateReportReasonIds").array().notNull().default([]),userId:(0,o.Qq)("userId").notNull()},e=>({pk:(0,h.ie)({columns:[e.userId,e.templateCanonId]})}));(0,I.aJ)($),(0,x.K1)($,e=>{let{one:t}=e;return{templateCanon:t(G,{fields:[$.templateCanonId],references:[G.templateCanonId]}),templateReportReasonIds:t(H,{fields:[$.templateReportReasonIds],references:[H.templateReportReasonId]})}});let H=(0,s.cJ)("templateReportReasons",{...N,templateReportReasonId:(0,o.Qq)("templateReportReasonId").primaryKey().notNull(),text:(0,o.Qq)("text").unique().notNull()});(0,I.aJ)(H);let Z=(0,s.cJ)("templateVersions",{...N,templateVersionId:(0,o.Qq)("templateVersionId").primaryKey().notNull(),templateCanonId:(0,o.Qq)("templateCanonId").notNull(),blockId:(0,o.Qq)("blockId").notNull(),publishedToCommunity:(0,o.Qq)("templatePublishedToCommunity").$type().default("private"),title:(0,o.Qq)("title").notNull(),description:(0,o.Qq)("description"),imageUrl:(0,o.Qq)("imageUrl"),envVarKeys:(0,o.Qq)("envVarKeys").array().notNull().default([])},e=>({blockIdIndex:(0,i.Pe)("templatesBlockIdIndex").on(e.blockId),templateCanonIdIndex:(0,i.Pe)("templateCanonId").on(e.blockId)}));(0,I.aJ)(Z),(0,x.K1)(Z,e=>{let{one:t}=e;return{block:t(M,{fields:[Z.blockId],references:[M.blockId]}),templateCanon:t(G,{fields:[Z.templateCanonId],references:[G.templateCanonId]})}});let G=(0,s.cJ)("templates",{...N,templateCanonId:(0,o.Qq)("templateCanonId").primaryKey().notNull(),templateVersionId:(0,o.Qq)("templateVersionId").unique().notNull(),authorId:(0,o.Qq)("authorId").notNull(),uses:(0,f.nd)("uses").default(0).notNull(),tags:(0,o.Qq)("tags").array().notNull().default([]),category:(0,o.Qq)("category"),trendingScore:(0,c.x)("trendingScore").default(0).notNull(),trendingScoreOffset:(0,c.x)("trendingScoreOffset").default(0).notNull(),order:(0,c.x)("order").default(0).notNull()},e=>({usesIndex:(0,i.Pe)("templatesUsesIndex").on(e.uses)}));(0,I.aJ)(G),(0,x.K1)(G,e=>{let{one:t}=e;return{templateVersion:t(Z,{fields:[G.templateVersionId],references:[Z.templateVersionId]})}});let W=(0,s.cJ)("evalExperiments",{...N,experimentId:(0,o.Qq)("experimentId").primaryKey().notNull(),userId:(0,o.Qq)("userId").notNull(),title:(0,o.Qq)("title").notNull(),modelConfigA:(0,d.Fx)("modelConfigA").notNull(),modelConfigB:(0,d.Fx)("modelConfigB").notNull()}),Y=(0,s.cJ)("experimentExamples",{...N,exampleId:(0,o.Qq)("exampleId").primaryKey().notNull(),experimentId:(0,o.Qq)("experimentId").notNull().references(()=>W.experimentId),urlA:(0,o.Qq)("urlA").notNull(),urlB:(0,o.Qq)("urlB").notNull()}),X=(0,u.rL)("voteChoice",["-2","-1","0","1","2"]),ee=(0,s.cJ)("experimentVotes",{...N,voteId:(0,o.Qq)("voteId").primaryKey().notNull(),userId:(0,o.Qq)("userId").notNull(),exampleId:(0,o.Qq)("exampleId").notNull().references(()=>Y.exampleId),choice:X("choice").notNull()}),et=(0,s.cJ)("evalExperimentPrompts",{...N,promptId:(0,o.Qq)("promptId").primaryKey().notNull(),label:(0,o.Qq)("label").notNull(),value:(0,o.Qq)("value").notNull()}),ea=(0,s.cJ)("examplesAndPrompts",{exampleId:(0,o.Qq)("exampleId").notNull().references(()=>Y.exampleId),promptId:(0,o.Qq)("promptId").notNull().references(()=>et.promptId)},e=>({pk:(0,h.ie)({columns:[e.exampleId,e.promptId]}),exampleIdx:(0,i.Pe)("examplesAndPrompts_example_idx").on(e.exampleId),promptIdx:(0,i.Pe)("examplesAndPrompts_prompt_idx").on(e.promptId)}));(0,x.K1)(W,e=>{let{many:t}=e;return{examples:t(Y)}}),(0,x.K1)(Y,e=>{let{one:t,many:a}=e;return{experiment:t(W,{fields:[Y.experimentId],references:[W.experimentId]}),votes:a(ee),prompts:a(ea)}}),(0,x.K1)(ee,e=>{let{one:t}=e;return{example:t(Y,{fields:[ee.exampleId],references:[Y.exampleId]})}}),(0,x.K1)(et,e=>{let{many:t}=e;return{examples:t(ea)}}),(0,x.K1)(ea,e=>{let{one:t}=e;return{example:t(Y,{fields:[ea.exampleId],references:[Y.exampleId]}),prompt:t(et,{fields:[ea.promptId],references:[et.promptId]})}}),(0,s.cJ)("integrationLinks",{...N,integrationLinkId:(0,o.Qq)("integrationLinkId").primaryKey().notNull(),projectId:(0,o.Qq)("projectId").notNull(),chatId:(0,o.Qq)("chatId").notNull(),integrationId:(0,o.Qq)("integrationId").notNull(),integrationName:(0,o.Qq)("integrationName").notNull(),token:(0,o.Qq)("token").notNull(),expiresAt:(0,n.vE)("expiresAt").notNull(),connected:(0,l.zM)("connected").default(!1).notNull()})},91572:(e,t,a)=>{a.d(t,{B:()=>x,default:()=>v,w:()=>y});var r=a(27545),n=a(41664),s=a(97797),o=a(45629),l=a(70244),d=a(76927),i=a(82325),c=a(88704),u=a(36324),p=a(52337),m=a(5128),f=a(24595),g=a(38898),h=a(85422),I=a(20862);function x(){let{data:e,mutate:t}=(0,n.Ay)("showShareDialog",null,{fallbackData:!1});return{showShareDialog:e,setShareDialog:t}}function y(e){let{isAuthor:t,...a}=e,{setShareDialog:n}=x(),{chatPrivacy:s}=(0,i.kM)(),{copyToClipboard:o}=(0,d.C)({timeout:2e3}),c=(0,f.k)("shareDialog");return"private"!==s||t?(0,r.jsxs)(h.DropdownMenuItem,{onClick:()=>{t?n(!0):("public"===s||"team"===s)&&(o(window.location.href),l.oR.success("Share link copied!"))},...a,children:[(0,r.jsx)(m.S,{}),(0,r.jsx)("span",{children:c("share")})]}):null}function v(){let e=(0,f.k)("shareDialog"),{chatId:t}=(0,o.xz)(),{chatPrivacy:a}=(0,i.kM)(),{title:n}=(0,i.tZ)(),{showShareDialog:l,setShareDialog:m}=x(),{isCopied:h,copyToClipboard:y}=(0,d.C)({timeout:2e3}),{chatId:v,privacy:b}="object"==typeof l?l:{chatId:t,privacy:a};return v?(0,r.jsxs)(c.Modal,{onOpenAutoFocus:e=>{e.preventDefault();let t=document.querySelector(".privacy-picker-selected");t&&t.focus()},onOpenChange:e=>{e||m(!1)},open:!!l,children:[(0,r.jsxs)(c.ModalHeader,{children:[(0,r.jsx)(c.ModalTitle,{children:e("title")}),(0,r.jsx)("p",{className:"text-foreground text-sm",children:"Configure who has access to this chat."})]}),(0,r.jsx)(c.ModalContent,{className:"p-6",children:(0,r.jsx)(g.f,{privacy:b,chatId:v,variant:"chat"})}),(0,r.jsxs)(c.ModalFooter,{className:"bg-muted border-alpha-400 border-t !p-4",children:[(0,r.jsxs)(s.$,{onClick:()=>{y("".concat(window.location.origin,"/chat/").concat((0,I.D)(v,n)))},size:"sm",variant:"secondary",children:[(0,r.jsx)(u.U,{customIcon:(0,r.jsx)(p.N,{}),isCopied:h}),e("copyLink")]}),(0,r.jsx)(c.ModalClose,{asChild:!0,children:(0,r.jsx)(s.$,{tabIndex:0,size:"sm",children:e("done")})})]})]}):null}},93947:(e,t,a)=>{a.d(t,{T:()=>s});var r=a(27545),n=a(3906);function s(e){let{size:t=16,className:a}=e;return(0,r.jsxs)("svg",{className:(0,n.cn)("copy-icon overflow-visible",a),fill:"currentColor",height:t,viewBox:"0 0 16 16",width:t,xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("style",{children:'.copy-icon {\n            * {\n              transition: transform 0.35s cubic-bezier(0.35, 0.2, 0.14, 0.95), d 0.35s cubic-bezier(0.35, 0.2, 0.14, 0.95);\n            }\n          }\n          button:has(.copy-icon):hover, button:has(.copy-icon):focus-visible {\n            .left {\n              d: path("M 2.75 0.5 C 1.7835 0.5 1 1.2835 1 2.25 V 9.75 C 1 10.7165 1.7835 11.5 2.75 11.5 H 3.75 H 6.5 V 10 H 3.75 H 2.75 C 2.6119 10 2.5 9.8881 2.5 9.75 V 2.25 C 2.5 2.1119 2.6119 2 2.75 2 H 8.25 C 8.3881 2 8.5 2.1119 8.5 2.25 V 5 H 10 V 2.25 C 10 1.2835 9.2165 0.5 8.25 0.5 H 2.75 Z");\n              transform: translate(-1px, -1px);\n            }\n            .right {\n              transform: translate(1px, 1px);\n            }\n          }'}),(0,r.jsx)("path",{className:"left",clipRule:"evenodd",d:"M2.75 0.5C1.7835 0.5 1 1.2835 1 2.25V9.75C1 10.7165 1.7835 11.5 2.75 11.5H3.75H4.5V10H3.75H2.75C2.61193 10 2.5 9.88807 2.5 9.75V2.25C2.5 2.11193 2.61193 2 2.75 2H8.25C8.38807 2 8.5 2.11193 8.5 2.25V3H10V2.25C10 1.2835 9.2165 0.5 8.25 0.5H2.75Z",fill:"currentColor",fillRule:"evenodd"}),(0,r.jsx)("path",{className:"right",clipRule:"evenodd",d:"M7.75 4.5C6.7835 4.5 6 5.2835 6 6.25V13.75C6 14.7165 6.7835 15.5 7.75 15.5H13.25C14.2165 15.5 15 14.7165 15 13.75V6.25C15 5.2835 14.2165 4.5 13.25 4.5H7.75ZM7.5 6.25C7.5 6.11193 7.61193 6 7.75 6H13.25C13.3881 6 13.5 6.11193 13.5 6.25V13.75C13.5 13.8881 13.3881 14 13.25 14H7.75C7.61193 14 7.5 13.8881 7.5 13.75V6.25Z",fill:"currentColor",fillRule:"evenodd"})]})}}}]);