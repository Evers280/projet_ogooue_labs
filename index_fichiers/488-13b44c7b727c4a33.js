(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[488],{542:(e,t,l)=>{"use strict";l.d(t,{H:()=>n});var s=l(27545);function n(){return(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsxs)("g",{id:"Icon",children:[(0,s.jsx)("path",{fill:"currentcolor",fillRule:"evenodd",clipRule:"evenodd",d:"M13.7497 10.75L13.7497 11.5L13.7497 13.2494C13.7497 14.2159 12.9662 14.9994 11.9997 14.9994L2.75 14.9994C1.7835 14.9994 1 14.2159 1 13.2494L1 4C1 3.0335 1.7835 2.25 2.75 2.25L4.49966 2.25L5.24966 2.25L5.24966 3.75L4.49966 3.75L2.75 3.75C2.61193 3.75 2.5 3.86193 2.5 4L2.5 13.2494C2.5 13.3875 2.61193 13.4994 2.75 13.4994L11.9997 13.4994C12.1377 13.4994 12.2497 13.3875 12.2497 13.2494L12.2497 11.5L12.2497 10.75L13.7497 10.75Z"}),(0,s.jsx)("path",{fill:"none",stroke:"currentcolor",d:"M7 8V3C7 2.44772 7.44772 2 8 2H13C13.5523 2 14 2.44772 14 3V8C14 8.55228 13.5523 9 13 9H8C7.44772 9 7 8.55228 7 8Z",strokeWidth:"1.5"})]})})}},824:(e,t,l)=>{"use strict";l.d(t,{r:()=>n});var s=l(39149);function n(){let[e,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{t(navigator.userAgent.toUpperCase().includes("MAC"))},[]),e}},2724:(e,t,l)=>{"use strict";l.d(t,{DataProvider:()=>i,Q:()=>r});var s=l(27545),n=l(39149);let a=(0,n.createContext)({});function i(e){let{children:t}=e;return(0,s.jsx)(a.Provider,{value:{},children:t})}function r(){return(0,n.use)(a)}},12145:(e,t,l)=>{"use strict";l.d(t,{S:()=>a});var s=l(39149),n=l(41664);function a(){var e;let{data:t,mutate:l}=(0,n.Ay)("result:full-screen"),{mutate:a}=(0,n.Ay)("state:select"),i=(0,s.useCallback)(e=>{l(t=>{if(!t&&!e)return;let l=new URL(window.location.href),s=l.searchParams;return s.get("b")&&(s.set("f",e?"1":"0"),l.search=s.toString(),window.history.replaceState({},"",l.toString())),a(!1),{value:e}})},[l,a]);return{fullScreenResult:null!==(e=null==t?void 0:t.value)&&void 0!==e&&e,setFullscreenResult:i,source:null==t?void 0:t.source}}},14576:(e,t,l)=>{"use strict";l.d(t,{V:()=>n});var s=l(41664);function n(e){let{blockId:t}=e,{data:l,mutate:n}=(0,s.Ay)(["block:editValueMap",t],{fallbackData:{}});return{editValueMap:l||{},setEditValueMap:n}}},18531:(e,t,l)=>{"use strict";l.d(t,{JS:()=>r,Yv:()=>o,wb:()=>i});var s=l(27545),n=l(3906),a=l(90590);function i(e){let{tabs:t,activeTabKey:l,setActiveTabKey:n,disableOverflow:a=!1,isLoading:i}=e;return(0,s.jsxs)("div",{className:"relative flex w-fit min-w-0 flex-1 items-center gap-2 overflow-x-auto",children:[t.map(e=>(0,s.jsx)(c,{active:e.key===l,onClick:()=>n(e.key),disabled:e.disabled,tooltip:e.tooltip,isLoading:i,children:e.display},e.key)),!a&&(0,s.jsx)("div",{className:"from-muted pointer-events-none sticky -right-2 z-10 h-full min-w-8 bg-gradient-to-l via-80% bg-blend-lighten",style:{backgroundImage:"linear-gradient(to left, var(--tw-gradient-stops))"}})]})}function r(e){let{className:t,tabFiles:l,activeTabKey:a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("relative size-full min-h-0 flex-1",t),children:l.map(e=>(0,s.jsx)("div",{className:(0,n.cn)("size-full",a===e.key?"block":"invisible h-0 overflow-hidden"),children:e.content},e.key))})}function o(e){let{tabFiles:t,activeTabKey:l,className:a,setActiveTabKey:o,isLoading:c}=e,d=t.find(e=>e.key===l),u=d?(0,s.jsx)("div",{className:"flex h-full items-center justify-end gap-1",children:d.actions}):null;return(0,s.jsxs)("div",{className:(0,n.cn)("bg-muted flex size-full flex-col",a),children:[(0,s.jsxs)("div",{className:"border-alpha-200 relative flex justify-between border-y p-2",children:[(0,s.jsx)(i,{tabs:t,activeTabKey:null==d?void 0:d.key,setActiveTabKey:o,isLoading:c}),u]}),(0,s.jsx)(r,{tabFiles:t,activeTabKey:null==d?void 0:d.key})]})}function c(e){let{active:t,children:l,disabled:i,onClick:r,tooltip:o,isLoading:c}=e,d=(0,s.jsx)("button",{className:(0,n.cn)("font-regular group h-7 max-w-56 select-none whitespace-nowrap rounded-md px-2 text-sm font-medium transition-all",t?"bg-alpha-200 text-gray-900":"hover:bg-alpha-200 bg-transparent text-gray-500",i&&!t&&"cursor-not-allowed hover:bg-transparent"),onClick:r,disabled:i,"data-testid":"tab-file-button","data-active-tab":t,children:(0,s.jsx)("div",{className:"truncate",children:l})});return o||i?(0,s.jsx)(a.Tooltip,{side:"bottom",className:"max-w-[250px] text-wrap text-center",content:o||(c?"Preview is loading":"Preview is disabled"),children:d}):d}},27934:(e,t,l)=>{"use strict";l.d(t,{FullscreenContainer:()=>c});var s=l(27545),n=l(12145),a=l(3906),i=l(68617),r=l(2731),o=l(64172);function c(e){let{children:t,allowOnMobile:l}=e,{fullScreenResult:c,setFullscreenResult:d,source:u}=(0,n.S)(),m=(0,o.$)(),f=c&&(l||!m);(0,i.ML)("keydown",e=>{"Escape"===e.key&&d(!1)});let x=e=>{if(!e){d(!1);return}e.target===e.currentTarget&&d(!1)},p=(0,s.jsx)("div",{className:(0,a.cn)(f?"fixed inset-3":"size-full",f&&"ssr"!==u&&"animate-in zoom-in-90"),children:(0,s.jsx)("div",{className:(0,a.cn)("bg-background size-full !overflow-clip",f&&"rounded-lg"),children:t})}),h=(0,a.cn)(f?"bg-alpha-700 dark:bg-alpha-900 fixed inset-0 z-[60]":"h-full w-full",f&&"ssr"!==u&&"animate-in fade-in duration-300");return"ssr"===u?(0,s.jsx)("div",{"data-testid":"fullscreen-overlay-ssr",className:h,onClick:x,children:p}):(0,s.jsx)(r.P.div,{"data-testid":"fullscreen-overlay",className:h,onClick:x,children:p})}},28970:(e,t,l)=>{"use strict";l.d(t,{Ip:()=>m,K5:()=>x,Q2:()=>u,Rc:()=>d,kt:()=>f,tz:()=>c});var s=l(27545),n=l(39149),a=l(46391),i=l(3906),r=l(92289),o=l(85551);let c=e=>{let{...t}=e;return(0,s.jsx)(a.bL,{modal:!1,...t})};c.displayName=a.bL.displayName;let d=a.l9,u=n.forwardRef((e,t)=>{let{className:l,...n}=e;return(0,s.jsx)(a.YJ,{className:(0,i.cn)("p-1.5",l),ref:t,...n})});u.displayName=a.YJ.displayName,a.ZL,a.Pb,a.z6,n.forwardRef((e,t)=>{let{className:l,inset:n,variant:r="default",...o}=e;return(0,s.jsx)(a.ZP,{className:(0,i.cn)("[_>svg]:!text-gray-500 relative flex h-8 w-full select-none items-center gap-3 rounded-md px-1.5 text-sm text-gray-900 outline-none transition-colors data-[disabled]:pointer-events-none data-[state=open]:bg-gray-100 data-[disabled]:opacity-50 [&_svg]:size-4 [&_svg]:transition-colors",n&&"pl-8","destructive"===r?"text-red-700 focus:bg-[#FF666618] [&_svg]:!text-red-700":"text-gray-900 focus:bg-gray-100 [&_svg]:!text-gray-500",l),ref:t,...o})}).displayName=a.ZP.displayName,n.forwardRef((e,t)=>{let{className:l,sideOffset:n=12,...r}=e;return(0,s.jsx)(a.G5,{className:(0,i.cn)("bg-background-subtle z-50 min-w-[13.5rem] max-w-[28rem] overflow-hidden rounded-xl shadow-sm [&_svg]:shrink-0","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),ref:t,sideOffset:n,...r})}).displayName=a.G5.displayName;let m=n.forwardRef((e,t)=>{let{className:l,...n}=e;return(0,s.jsx)(a.ZL,{children:(0,s.jsx)(a.UC,{className:(0,i.cn)("bg-background-subtle z-50 min-w-[13.5rem] max-w-[28rem] overflow-hidden rounded-xl shadow-sm [&_svg]:shrink-0","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),ref:t,...n})})});m.displayName=a.UC.displayName;let f=n.forwardRef((e,t)=>{let{className:l,inset:n,variant:r="default",svgStyling:o=!0,...c}=e;return(0,s.jsx)(a.q7,{className:(0,i.cn)("relative flex h-8 w-full select-none items-center gap-3 whitespace-nowrap rounded-md px-1.5 text-sm text-gray-900 outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_span]:truncate",n&&"pl-8",o&&"[&_svg]:size-4 [&_svg]:transition-colors",o&&{"[&_svg]:!text-gray-500 [&[data-highlighted]_svg]:!text-gray-900":"default"===r,"[&_svg]:!text-red-700":"destructive"===r,"[&_svg]:!text-blue-700":"blue"===r,"[&_svg]:!text-amber-600":"gold"===r},"destructive"===r?"text-red-700 focus:bg-[#FF666618]":"text-gray-900 focus:bg-gray-100 ",l),ref:t,...c})});f.displayName=a.q7.displayName,n.forwardRef((e,t)=>{let{className:l,inset:n,...r}=e;return(0,s.jsx)(a.JU,{className:(0,i.cn)("h-8 content-center px-1.5 text-[13px] text-gray-500",n&&"pl-8",l),ref:t,...r})}).displayName=a.JU.displayName;let x=n.forwardRef((e,t)=>{let{className:l,...n}=e;return(0,s.jsx)(a.wv,{className:(0,i.cn)("h-px bg-gray-200",l),ref:t,...n})});x.displayName=a.wv.displayName,n.forwardRef((e,t)=>{let{className:l,children:n,checked:r,...c}=e;return(0,s.jsxs)(a.H_,{checked:r,className:(0,i.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),ref:t,...c,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(a.VF,{children:(0,s.jsx)(o.J,{className:"h-4 w-4"})})}),n]})}).displayName=a.H_.displayName,n.forwardRef((e,t)=>{let{className:l,children:n,...o}=e;return(0,s.jsxs)(a.hN,{className:(0,i.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),ref:t,...o,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center rounded-full border",children:(0,s.jsx)(a.VF,{children:(0,s.jsx)(r.A,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=a.hN.displayName},42933:(e,t,l)=>{"use strict";l.d(t,{A:()=>P});var s=l(27545),n=l(39149),a=l(20222),i=l(82923),r=l(76112),o=l(46526),c=l(70927),d=l(31747),u=l(92872),m=l(24595),f=l(12145),x=l(3906);l(64726);var p=l(542),h=l(74197),v=l(16426),g=l(64172),b=l(95836),j=l(11043),w=l(86141);function y(e){let{open:t,setOpen:l,missingEnvs:n}=e;return(0,s.jsx)("div",{className:(0,x.cn)("absolute inset-0",!t&&"pointer-events-none"),children:(0,s.jsxs)(w.lG,{open:t,modal:!1,onOpenChange:l,children:[(0,s.jsx)("div",{"data-state":t?"open":"closed",className:(0,x.cn)("bg-alpha-700 dark:bg-alpha-900 absolute inset-0 z-50 transition-opacity data-[state=closed]:pointer-events-none data-[state=closed]:opacity-0 data-[state=open]:opacity-100"),onClick:()=>{t&&l(!1)}}),(0,s.jsxs)(w.Cf,{showClose:!1,onEscapeKeyDown:()=>{var e;return null===(e=document.getElementById("env-warning-trigger"))||void 0===e?void 0:e.focus()},className:"max-h-[400px] max-w-[min(440px,90vw)] gap-2.5 overflow-y-scroll p-3 shadow-sm",omitPortal:!0,onInteractOutside:e=>e.preventDefault(),children:[(0,s.jsxs)(w.HM,{onKeyDown:e=>{"Tab"===e.key&&(e.preventDefault(),document.activeElement instanceof HTMLElement&&document.activeElement.blur())},tabIndex:1,className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:pointer-events-none",children:[(0,s.jsx)(d.F,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,s.jsxs)(w.c7,{className:"items-start text-start",children:[(0,s.jsxs)(w.L3,{className:"flex items-center gap-2 text-lg",children:[(0,s.jsx)(j.o,{className:"!text-amber-600"}),(0,s.jsx)("span",{children:"Missing Environment Variables"})]}),(0,s.jsx)(w.rr,{className:"text-foreground text-sm",children:"This generation may have limited functionality without the following environment variables:"})]}),n.map(e=>(0,s.jsx)("p",{className:"w-fit max-w-full truncate rounded-sm bg-gray-200 px-[3px] py-0.5 font-mono text-[13px] leading-none",children:e},e))]})]})})}var k=l(35366);function N(e,t){e.postMessage({__v0_remote__:1,...t},"*")}function P(e){let{iframeId:t,blockId:l,devTools:w,allowMobileFullscreen:P,isV3:C,children:S}=e,T=(0,m.k)("previewBlock"),{fullScreenResult:R,setFullscreenResult:I}=(0,f.S)(),U=(0,g.$)(),[A,_]=(0,n.useState)(!1),[O,D]=(0,n.useState)(new Map),L=(0,n.useMemo)(()=>{var e;return null!==(e=O.get(t))&&void 0!==e?e:[]},[t,O]),[F,M]=(0,n.useState)(!0),z=(0,n.useMemo)(()=>F&&L.length>0,[F,L]),{canGoBack:H,canGoForward:V,href:B,setHref:W,iframe:Z,latestHref:G,loading:K,setLoading:$,refresh:Q,temporalHref:X,setTemporalHref:Y}=(0,k.Z)(l),J=(0,n.useMemo)(()=>{if(!B)return"";let e=new URL(B);return e.pathname+e.search+e.hash},[B]),q=(0,u.F)(X);(0,n.useEffect)(()=>{if(!Z)return;let e=e=>{let{data:l}=e;if(l&&"object"==typeof l&&l.__v0_remote__&&"missing-envs"===l.type){let e=Array.isArray(l.names)&&l.names.every(e=>"string"==typeof e);D(new Map(O.set(t,e?l.names:[])))}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[Z,t,O]);let ee=(0,n.useCallback)(()=>{Z&&window.open(G.current||Z.src,"_blank","noreferrer,noopener")},[Z,G]),et=(0,n.useCallback)(()=>{Z&&Z.contentWindow&&(N(Z.contentWindow,{type:"navigate_back"}),Y(null))},[Z]),el=(0,n.useCallback)(()=>{Z&&Z.contentWindow&&(N(Z.contentWindow,{type:"navigate_forward"}),Y(null))},[Z]),es=(0,n.useCallback)(()=>{var e;Z&&Z.contentWindow&&(N(Z.contentWindow,{type:"navigate_to",href:null===q.current?G.current:new URL(null!==(e=q.current)&&void 0!==e?e:"",G.current).href}),$(!0))},[Z,G,q]);return(0,s.jsxs)("div",{className:"flex h-full w-full flex-col","data-slot":"browser",children:[(0,s.jsxs)(h.o,{className:C?"h-6 gap-1 px-0":"bg-muted gap-1 px-2",bottomBorder:!C,children:[(0,s.jsx)(v.Z,{disabled:!H,onClick:et,children:(0,s.jsx)(a.J,{})}),(0,s.jsx)(v.Z,{disabled:!V,onClick:el,children:(0,s.jsx)(i.c,{})}),(0,s.jsx)(v.Z,{onClick:Q,children:K?(0,s.jsx)(E,{}):(0,s.jsx)(c.g,{})}),(0,s.jsxs)("div",{className:"relative mx-1 flex-1",children:[(0,s.jsx)("input",{type:"text",className:(0,x.cn)("focus:border-alpha-200 h-6 w-full min-w-0 rounded-full border border-transparent bg-gray-200 px-2.5 text-gray-900 outline-none hover:bg-gray-300/50",R&&"pl-7"),value:null!==X?X:J,onKeyDown:e=>{"Enter"===e.key?(es(),W(new URL(null!=X?X:"",B).href),Y(null),e.stopPropagation(),e.currentTarget.blur()):"Escape"===e.key&&(Y(null),e.stopPropagation(),e.currentTarget.blur())},onChange:e=>void Y(e.currentTarget.value),onFocus:e=>{e.currentTarget.select()}}),R&&(0,s.jsx)("div",{className:"absolute left-2 top-1/2 -translate-y-1/2",children:(0,s.jsx)(b.o,{className:"size-4"})})]}),L.length>0&&(0,s.jsx)(v.Z,{className:"text-amber-600",id:"env-warning-trigger",tooltipDirection:"bottom",tooltip:"Missing Environment Variables",onClick:()=>M(!z),children:(0,s.jsx)(j.o,{})}),w?(0,s.jsx)(v.Z,{"data-slot":"button-select",className:(0,x.cn)(A?"!bg-blue-500/15 text-blue-500":"focus:bg-transparent"),tooltip:{side:"bottom",content:"Select"},onClick:()=>{_(e=>!e);let e=document.getElementById(t);e&&e.contentWindow&&N(e.contentWindow,{type:"devtools_enable"})},children:(0,s.jsx)(o.f,{})}):null,(0,s.jsx)(v.Z,{"data-slot":"button-new-tab",tooltip:{side:"bottom",content:(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{children:"Open in new tab"}),(0,s.jsx)("span",{className:"max-w-[200px] text-center text-sm text-gray-400",children:"This link is insecure and can expose your code and data."})]})},onClick:ee,children:(0,s.jsx)(p.H,{})}),(0,s.jsx)(v.Z,{className:(0,x.cn)(!P&&U?"hidden":null),"data-slot":"button-fullscreen","data-testid":"fullscreen-button",tooltip:{side:"bottom",content:T(R?"close":"fullscreen")},onClick:()=>I(!R),children:R?(0,s.jsx)(d.F,{}):(0,s.jsx)(r.g,{})})]}),(0,s.jsxs)("div",{className:"relative flex w-full flex-1 shrink-0 flex-col","data-slot":"browser-content",children:[(0,s.jsx)(y,{open:z,setOpen:M,missingEnvs:L}),S]})]})}function E(){return(0,s.jsx)("svg",{className:"browserframe-loading-spinner",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("circle",{fill:"none",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round",cx:"33",cy:"33",r:"30"})})}},58032:(e,t,l)=>{"use strict";l.d(t,{o:()=>y,z:()=>k});var s=l(27545),n=l(46751),a=l(97797),i=l(39149),r=l(4432),o=l(24595),c=l(62787),d=l(70244),u=l(36990),m=l(97945),f=l(2731),x=l(10289),p=l(14341),h=l(75951),v=l(15338),g=l(68617),b=l(824),j=l(96008),w=l(3906);function y(e){var t;let{mergedFromBlockId:l,hasUnsavedChanges:u,overrideBlockId:p,resetValue:h,onSave:j,clearEditValueMap:y,isV3:k}=e,[N,P]=(0,i.useState)(!1),[E,C]=(0,i.useState)(!1),S=(0,r.eu)(),T=(0,o.k)("codeBlockActions"),R=(0,b.r)();(0,g.ML)("code-editor-saved",async()=>{u&&await j({setSaving:P,setForceHide:C})}),t=u,(0,i.useEffect)(()=>{let e=e=>{t&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[t]);let I=null!=l?l:(null==S?void 0:S.id)||p;return I?(0,s.jsx)(m.N,{children:u&&!E?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"from-muted pointer-events-none absolute inset-x-0 bottom-0 z-10 flex h-36 items-end justify-center bg-gradient-to-t to-transparent"},"unsaved-changes-bg"),(0,s.jsx)(f.P.div,{initial:{opacity:0,y:20,scale:.95,width:320},animate:{opacity:1,y:0,scale:1,width:N?96:320},exit:{opacity:0},transition:{duration:.15,ease:"easeOut",width:{type:"spring",stiffness:300,damping:30}},className:(0,w.cn)("shadow-modal bg-background absolute inset-x-0 z-50 mx-auto flex h-11 items-center justify-between rounded-full p-2 pl-3 text-sm font-medium",k?"bottom-16":"bottom-3"),children:N?(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,s.jsx)(x.y,{size:16}),"Saving"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.N,{className:"!text-gray-500"}),"Unsaved Changes"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(a.$,{size:"sm",className:"h-7",rounded:!0,variant:"secondary",disabled:N,onClick:()=>{(0,c.u)("ResetUnsavedEditCode",{blockId:I}),P(!0);try{h(),d.oR.success(T("resetChanges"),{position:"bottom-right"}),setTimeout(()=>C(!1),2e3),y()}catch(e){d.oR.error(T("failedToResetChanges"),{position:"bottom-right"})}P(!1)},children:T("reset")}),(0,s.jsx)(a.$,{tooltip:{content:(0,s.jsxs)(v.r,{children:[(0,s.jsx)(v.u,{children:R?"⌘":"Ctrl"}),(0,s.jsx)(v.u,{children:"S"})]})},size:"sm",className:"h-7",rounded:!0,disabled:N,onClick:()=>j({setSaving:P,setForceHide:C}),children:T("save")})]})]})},"unsaved-changes-island")]}):null}):null}function k(e){let{blockId:t,editValueMap:l,source:s,meta:n,files:a,clearEditValueMap:m,isAdminSaving:f}=e,x=(0,o.k)("codeBlockActions"),v=(0,r.eu)(),g=(0,r.y6)(),{updateBlockData:b}=(0,p.P6)({blockId:t});return{onSave:async e=>{let{setSaving:a,setForceHide:i}=e;if((0,c.u)("SaveEditCode",{blockId:t}),f&&!window.confirm("[V0 ADMIN] Are you sure you want to save these changes to the user's block?"))return;let r=Object.entries(l||{});if(null==v?void 0:v.templateCanonId)return d.oR.error("Cannot edit a published generation",{position:"bottom-right"});if(!l||r.length<1||!r.some(e=>{let[t,l]=e;return!!l}))return d.oR.error(x("failedToSaveChanges"),{position:"bottom-right"});let o=r[0][1]||s;if("code-project"===n.type){let e=(0,h.A2)({source:s,blockType:"code-project",blockId:t}).filter(e=>!e.isDeleted);for(let t of e){let e=l[t.meta.file||""];e&&(t.source=e)}o=(0,h.L5)({files:e,blockType:"code-project"})}a(!0);let m=await (0,j.Z)({blockId:t,source:o});a(!1),m.success?(v&&t===v.id&&g({...v,hasSourceBeenEdited:!0,source:o}),b({blockId:t,data:{hasSourceBeenEdited:!0,source:o}}),i(!0),setTimeout(()=>i(!1),2e3),d.oR.success(x("savedChanges"),{position:"bottom-right"})):(0,u.z)(m)||d.oR.error(x("failedToSaveChanges"))},hasUnsavedChanges:(0,i.useMemo)(()=>{let e=!1;if(!l)return!1;for(let t of a){let s=l[t.meta.file||""];if(s&&s.trimEnd()!==t.source.trimEnd()){e=!0;break}}return e},[l,a]),clearEditValueMap:m}}},64726:()=>{},74197:(e,t,l)=>{"use strict";l.d(t,{o:()=>a});var s=l(27545),n=l(3906);function a(e){let{className:t,children:l,bottomBorder:a,onePixelShorter:i}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex w-full shrink-0 items-center pl-3 pr-2 text-[13px] font-medium text-gray-500",i?"h-[calc(2.25rem-1px)]":"h-9",a&&"border-alpha-200 border-b",t),"data-slot":"block-tab-header",children:l})}},78325:(e,t,l)=>{"use strict";l.d(t,{YZ:()=>v,Zf:()=>b,je:()=>g});var s=l(27545),n=l(39149),a=l(2274),i=l(2731),r=l(56495),o=l(97945),c=l(3906),d=l(87240);let u=(0,n.createContext)(void 0),m=()=>{let e=(0,n.useContext)(u);if(void 0===e)throw Error("useResizableContext must be used within a FileTreeProvider");return e};function f(e){let{className:t,...l}=e,{leftId:n,rightId:i,groupId:r,panelGroupRef:o}=m();return(0,s.jsxs)(a.TW,{onDragging:()=>{var e,t,l,s;let c=null===(e=a.PV(n))||void 0===e?void 0:e.offsetWidth,d=null===(t=a.PV(i))||void 0===t?void 0:t.offsetWidth,u=null===(l=a.Gx(r))||void 0===l?void 0:l.offsetWidth;c&&d&&u&&(null===(s=o.current)||void 0===s||s.setLayout([c/u*100,d/u*100]))},className:(0,c.cn)("group relative z-20 w-0 !overflow-visible !outline-none !ring-0",t),...l,children:[(0,s.jsx)("div",{className:"absolute inset-0 h-full w-3 translate-x-[-50%] !outline-0 !ring-0"}),(0,s.jsx)("div",{className:"absolute inset-0 h-full w-0 translate-x-[-50%] !outline-0 !ring-0 transition-all duration-200 group-data-[resize-handle-active=keyboard]:w-[3px] group-data-[resize-handle-state=drag]:w-[3px] group-data-[resize-handle-state=hover]:w-[3px] group-data-[resize-handle-active=keyboard]:bg-gray-400 group-data-[resize-handle-state=drag]:bg-gray-400 group-data-[resize-handle-state=hover]:bg-gray-300 group-data-[resize-handle-active=keyboard]:outline-none"})]})}let x=(0,n.forwardRef)((e,t)=>((0,n.useEffect)(()=>{let l=document.getElementById(e.id);l&&t&&("function"==typeof t?t(l):t.current=l)},[e.id,t]),(0,s.jsx)(a.Zk,{...e})));x.displayName="ForwardPanel";let p=i.P.create(x);function h(e){let t=a.PV(e);if(!t)return 100;let l=parseFloat(getComputedStyle(t).minWidth);return isNaN(l)?100:l}function v(e){let{isFallbackSize:t,collapseSide:l,leftId:i,rightId:r,defaultSizeRef:o,cookie:c,id:m,...f}=e,x=(0,n.useRef)(null),p=(0,n.useRef)(!1);return(0,s.jsx)(u.Provider,{value:{leftId:i,rightId:r,panelGroupRef:x,groupId:m},children:(0,s.jsx)(a.YZ,{id:m,ref:x,onLayout:e=>{var s,n;if(e.length<2)return;let[u,f]=e;if(p.current)return p.current=!1;if(!f||!u)return;let v="right"===l?f:u;o.current=v,t||d.A.set(c,v.toString(),{expires:30});let g=a.PV(i),b=a.PV(r),j=a.Gx(m);if(!g||!b||!j)return;let w=h("right"===l?r:i),y=h("right"===l?i:r);if(v/100*j.offsetWidth<w){let e=w/j.offsetWidth*100;p.current=!0,null===(s=x.current)||void 0===s||s.setLayout("right"===l?[100-e,e]:[e,100-e])}else if(("right"===l?u:f)/100*j.offsetWidth<y){let e=y/j.offsetWidth*100;p.current=!0,null===(n=x.current)||void 0===n||n.setLayout("right"===l?[e,100-e]:[100-e,e])}},...f})})}function g(e){let{collapseSide:t,isOpen:l,order:n,defaultSize:d,className:u,handleTestId:m,collapseId:x,children:h}=e,v=(0,r.d)(0),g=(0,r.d)(1);return(0,s.jsx)(o.N,{initial:!1,mode:"wait",children:l?(0,s.jsxs)(s.Fragment,{children:["right"===t?(0,s.jsx)(f,{"data-testid":m,className:"sticky top-0"},"resize-handle"):null,(0,s.jsx)(p,{transition:{duration:0},variants:{hidden:{flex:"0 1 0px",minWidth:0,overflow:"visible",transition:{when:"beforeChildren",duration:0}}},exit:"hidden",id:x,order:n,defaultSize:d,style:{overflow:"clip"},className:(0,c.cn)("relative",u),children:(0,s.jsx)(i.P.div,{style:{x:v,opacity:g,willChange:"auto"},variants:{initial:{width:"100%",display:"absolute",opacity:0,x:"right"===t?"100%":"-100%"},visible:()=>({width:["100%","100%"],opacity:[g.get(),1],display:["absolute","block"],x:[v.get(),0],transition:{type:"spring",damping:60,stiffness:1100}}),hidden:()=>{var e,l;return{width:null!==(l=null===(e=a.PV(x))||void 0===e?void 0:e.offsetWidth)&&void 0!==l?l:0,display:"absolute",opacity:0,x:"right"===t?"100%":"-100%",transition:{type:"spring",damping:60,stiffness:800}}}},initial:"initial",animate:"visible",exit:"hidden",className:(0,c.cn)("border-alpha-200 absolute inset-y-0 right-0 h-full w-full ","right"===t?"right-0 border-l":"left-0 border-r"),children:h})},"right-panel"),"left"===t?(0,s.jsx)(f,{"data-testid":m,className:"sticky top-0"},"resize-handle"):null]}):(0,s.jsx)(a.Zk,{order:n,defaultSize:0},"zero-panel")})}function b(e){let{initialSize:t,fallbackSize:l=50}=e,[s,a]=(0,n.useState)("number"==typeof t?t:l),i=(0,n.useRef)(s),r=(0,n.useRef)(!0),[o,c]=(0,n.useState)("number"!=typeof t);return(0,n.useEffect)(()=>{"number"!=typeof t&&t.then(e=>{a(e),c(!1),r.current&&(i.current=e,r.current=!1)})},[t]),{initialSize:s,defaultSizeRef:i,isFallbackSize:o}}},80488:(e,t,l)=>{"use strict";l.r(t),l.d(t,{BlockContent:()=>lx,getBlockLogic:()=>lm,useRenderedBlock:()=>lf});var s=l(27545),n=l(39149),a=l(82543),i=l(83075),r=l(91673),o=l(62787),c=l(41664),d=l(85551),u=l(87240),m=l(2731),f=l(3906),x=l(68617);function p(e){let{show:t,axis:l,side:n,resizing:a,dotsHandle:i,onMouseDown:r,onFocus:o,onBlur:c,ref:d}=e,u={"aria-orientation":"x"===l?"vertical":"horizontal",onBlur:c,onFocus:o,onMouseDown:r,ref:d,role:"separator",tabIndex:0};return i?(0,s.jsx)("div",{className:(0,f.cn)("group absolute flex items-center justify-center focus:outline-none","x"===l?(0,f.cn)("inset-y-0 w-5 cursor-col-resize flex-col","start"===n?"left-[-19px]":"right-[-19px]"):(0,f.cn)("inset-x-0 h-5 cursor-row-resize flex-row","start"===n?"top-[-19px]":"bottom-[-19px]")),...u,children:(0,s.jsxs)("div",{className:"flex gap-0.5",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,s.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,s.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,s.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,s.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,s.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,s.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"})]})]})}):t?(0,s.jsx)("div",{className:(0,f.cn)("group absolute z-10 focus:outline-none","x"===l&&(0,f.cn)("inset-y-0 w-3 cursor-col-resize","start"===n?"-left-1.5":"-right-1.5"),"y"===l&&(0,f.cn)("inset-x-0 h-3 cursor-row-resize","start"===n?"-top-1.5":"-bottom-1.5")),...u,children:(0,s.jsx)("div",{className:(0,f.cn)("absolute inset-0 transition-all duration-200 group-hover:bg-gray-300 group-focus:bg-gray-400","x"===l&&(0,f.cn)("mx-auto group-hover:w-[3px] group-focus:w-[3px]",a?"w-1":"w-0"),"y"===l&&(0,f.cn)("my-auto group-hover:h-[3px] group-focus:h-[3px]",a?"h-1":"h-0"))})}):null}let h=(0,n.memo)(e=>{var t,l;let{show:a,innerClassName:i,dotsHandle:r=!1,onTrack:o,className:c,initialSize:d,animated:h=!0,minSizePx:v,minNegativeSpace:g,axis:b,side:j,children:w,cookieName:y,snapTo:k,onResize:N,ref:P}=e,E=(0,n.useRef)(null),C=(0,n.useRef)(null),S=(0,n.useRef)(null),[T,R]=(0,n.useState)(!1),[I,U]=(0,n.useState)(!1),[A,_]=(0,n.useState)(0),[O,D]=(0,n.useState)(0),[L,F]=(0,n.useState)(!1),M=(0,n.useState)(()=>{if("undefined"==typeof document)return null;let e=u.A.get(y);if(null===e)return null;let t=Number(e);return isNaN(t)?null:t})[0],z=(0,n.useRef)(null!=M?M:d);(0,n.useEffect)(()=>{P&&(P.current={setSize:e=>{z.current=e,E.current&&("x"===b?E.current.style.width="".concat(e,"%"):E.current.style.height="".concat(e,"%")),null==N||N(e)},getSize:()=>z.current,getContainer:()=>E.current})},[P,b,N]);let H=(0,n.useCallback)(e=>{var t,l,s,n;e.stopPropagation(),e.preventDefault(),null===(t=C.current)||void 0===t||t.focus(),U(!0),R(!0),_("x"===b?e.clientX:e.clientY),S.current=z.current,D(null!==(n="x"===b?null===(l=E.current)||void 0===l?void 0:l.clientWidth:null===(s=E.current)||void 0===s?void 0:s.clientHeight)&&void 0!==n?n:0),F(!0)},[b]),V=(0,n.useCallback)(e=>{var t,l;if(!T||!I)return;let s=null===(t=E.current)||void 0===t?void 0:t.parentElement,n=null!==(l="x"===b?null==s?void 0:s.clientWidth:null==s?void 0:s.clientHeight)&&void 0!==l?l:0,a=O+(A-("x"===b?e.clientX:e.clientY))*("start"===j?1:-1);k&&"y"===b&&a<k.threshold&&(a=k.size);let i=a/n*100;if(void 0!==g){let e=(n-g)/n*100;i>e&&(i=e)}"x"===b?E.current.style.width="".concat(i,"%"):E.current.style.height="".concat(i,"%"),z.current=i,null==N||N(i)},[b,I,T,j,A,O,k,g,N]),B=(0,n.useCallback)(()=>{var e;T&&(R(!1),U(!1),null===(e=C.current)||void 0===e||e.blur(),u.A.set(y,String(z.current),{expires:7}),null==o||o(S.current,z.current))},[y,o,T]);(0,x.ML)("mousemove",V),(0,x.ML)("mouseup",B),(0,x.ML)("keydown",e=>{var t,l,s,n,a;if(!T||"ArrowLeft"!==e.key&&"ArrowRight"!==e.key)return;let i=(e.shiftKey?12:4)*("ArrowLeft"===e.key?1:-1)*("start"===j?1:-1),r=null===(t=E.current)||void 0===t?void 0:t.parentElement,o=null!==(n="x"===b?null==r?void 0:r.clientWidth:null==r?void 0:r.clientHeight)&&void 0!==n?n:0,c=(null!==(a="x"===b?null===(l=E.current)||void 0===l?void 0:l.clientWidth:null===(s=E.current)||void 0===s?void 0:s.clientHeight)&&void 0!==a?a:0)/o*100+i;if(k&&"y"===b&&c/100*o<k.threshold&&(c=k.size/o*100),void 0!==g){let e=(o-g)/o*100;c>e&&(c=e)}"x"===b?E.current.style.width="".concat(c,"%"):E.current.style.height="".concat(c,"%"),z.current=c},C);let W=(0,n.useCallback)(()=>{var e;if(void 0===g)return;let t=null===(e=E.current)||void 0===e?void 0:e.parentElement,l="x"===b?null==t?void 0:t.clientWidth:null==t?void 0:t.clientHeight;if(l)return(l-g)/l*100},[b,g]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,f.cn)("fixed inset-0 z-50",T?"x"===b?"cursor-col-resize":"cursor-row-resize":"pointer-events-none")}),(0,s.jsxs)(m.P.div,{animate:"x"===b?{width:a?"".concat(null!==(t=z.current)&&void 0!==t?t:d,"%"):"0%",height:"100%",minWidth:a?"".concat(v,"px"):0,maxWidth:a&&g?"".concat(W(),"%"):void 0,opacity:+!!a}:{height:a?"".concat(null!==(l=z.current)&&void 0!==l?l:d,"%"):"0%",width:"100%",minHeight:a?"".concat(v,"px"):0,maxHeight:a&&g?"".concat(W(),"%"):void 0,opacity:+!!a},"aria-hidden":!a,className:(0,f.cn)("relative",c),inert:!a,initial:!1,layout:"size",onAnimationComplete:()=>{L&&F(!1)},ref:E,transition:L||!h?{type:!1}:{type:"spring",damping:25,stiffness:180,mass:1},children:[(0,s.jsx)(p,{axis:b,dotsHandle:r,onBlur:B,onFocus:()=>{R(!0),F(!0)},onMouseDown:H,ref:C,resizing:T,show:a,side:j}),(0,s.jsx)("div",{className:(0,f.cn)("absolute inset-0",i),children:w})]})]})});h.displayName="Resizable";var v=l(16426),g=l(76927),b=l(97797),j=l(10289),w=l(12162);function y(e){let{buttonText:t="Run Code",variant:l="default",setOutput:a,codeExecutionBlockProps:i,execute:r,editedValue:c,disabled:d}=e,[u,m]=(0,n.useState)(!1);return(0,s.jsxs)(b.$,{className:"ghost"===l?"h-6 text-gray-500 has-[>svg]:px-1":"","data-testid":"run-code-button",disabled:u||d,onClick:async()=>{try{m(!0),(0,o.u)("ClickRunCode",{code:c||i.source});let e=await r(i,c);a(e)}finally{m(!1)}},size:"sm",variant:"ghost"===l?"ghost":"secondary",children:[u?(0,s.jsx)(j.y,{size:16,wrapperClassName:"text-gray-500"}):(0,s.jsx)(w.N,{className:(0,f.cn)("translate-y-[-0.5px] [&_circle]:[vector-effect:non-scaling-stroke]","ghost"===l?"text-gray-500 [&_path]:fill-gray-500":"text-gray-900 [&_path]:fill-gray-900")}),t]},"execute")}var k=l(22576),N=l(65618),P=l(11386),E=l(2728),C=l(93947);function S(e){let{size:t=16,className:l}=e;return(0,s.jsxs)("svg",{className:(0,f.cn)("trash-icon overflow-visible",l),fill:"currentColor",height:t,viewBox:"0 0 16 16",width:t,xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("style",{children:"\n        .trash-icon .trash-lid {\n            transition: transform 0.35s cubic-bezier(0.35, 0.2, 0.14, 0.95);\n            transform-origin: center;\n        }\n\n        button:has(.trash-icon):hover .trash-lid, button:has(.trash-icon):focus-visible .trash-lid {\n          transform: translate(-0px, -2px) rotate(-10deg);\n        }\n            \n       "}),(0,s.jsx)("path",{className:"trash-lid",clipRule:"evenodd",d:"M6.75 2.75C6.75 2.0596 7.3096 1.5 8 1.5 8.6904 1.5 9.25 2.0596 9.25 2.75V3H6.75V2.75ZM5.25 3V2.75C5.25 1.2312 6.4812 0 8 0 9.5188 0 10.75 1.2312 10.75 2.75V3H12.9201 13 15V4.5H14.25 13.8846 1.75 1V3H1.75 3.0799 5.25Z",fill:"currentColor",fillRule:"evenodd"}),(0,s.jsx)("path",{clipRule:"evenodd",d:"M2.1154 4.5H13.8846L13.1776 13.6917C13.0774 14.9942 11.9913 16 10.6849 16H5.3151C4.0087 16 2.9226 14.9942 2.8224 13.6917L2.1154 4.5ZM4.318 13.5767 3.6198 4.5H12.3802L11.682 13.5767C11.6419 14.0977 11.2075 14.5 10.6849 14.5H5.3151C4.7925 14.5 4.3581 14.0977 4.318 13.5767Z",fill:"currentColor",fillRule:"evenodd"})]})}var T=l(18531),R=l(49208),I=l(53575),U=l(10772),A=l(62513),_=l(42762),O=l(53901),D=l(70927),L=l(24595);let F=e=>{if(!e)return;let t=document.getElementById((0,U.j)(e));if(t instanceof HTMLIFrameElement){if(t.contentDocument)t.contentDocument.location.reload();else if(t.srcdoc){let e=t.srcdoc;t.srcdoc="",setTimeout(()=>{t.srcdoc=e},10)}else t.src=t.src}};function M(e){let{blockId:t}=e,l=(0,L.k)("previewBlock"),a=(0,n.useCallback)(()=>{t&&F(t)},[t]);return(0,s.jsx)(v.Z,{"aria-label":l("refresh"),onClick:()=>a(),tooltip:{side:"bottom",content:l("refresh")},children:(0,s.jsx)("span",{children:(0,s.jsx)(D.g,{})})})}var z=l(12145),H=l(76112);function V(){let{setFullscreenResult:e}=(0,z.S)(),t=(0,L.k)("previewBlock");return(0,s.jsx)(v.Z,{"aria-label":t("fullscreen"),className:"hidden md:flex",onClick:()=>e(!0),tooltip:{side:"bottom",content:t("fullscreen")},children:(0,s.jsx)(H.g,{})})}var B=l(27934),W=l(46337),Z=l.n(W),G=l(96064),K=l(70244),$=l(97945),Q=l(46751),X=l(86141),Y=l(75951);let J=(0,G.default)(()=>Promise.all([l.e(3616),l.e(6683)]).then(l.bind(l,6683)).then(e=>e.ConflictEditor),{loadableGenerated:{webpack:()=>[6683]}});function q(e){let{hasUnappliedChanges:t,blockId:l,source:a,onApply:i,showFadeOut:r}=e,[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1),f=(0,L.k)("unappliedChanges"),[x,p]=(0,n.useState)(null),[h,v]=(0,n.useState)(null),g=async()=>{c(!0);let e=await fetch("/chat/api/chat/remote/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bid:l,blockSource:a})});if(c(!1),e.ok){let t=await e.json();t.success?(u(!0),setTimeout(()=>u(!1),2e3),K.oR.success(f("savedChanges"))):(K.oR.error("Local: conflict detected. Check your console"),p(t.conflicts)),i()}else K.oR.error(f("failedToApplyChanges"))},w=async()=>{if(h)try{let e=[...(0,Y.A2)({source:a,blockType:"local",blockId:l})];for(let t of h){let l=e.find(e=>e.meta.file===t.file);l&&(l.source=t.content)}let t=(0,Y.L5)({files:e,blockType:"local"}),s=await fetch("/chat/api/chat/remote/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bid:l,blockSource:t,resolvedConflicts:!0})});s.ok&&(await s.json()).success?(u(!0),setTimeout(()=>u(!1),2e3),K.oR.success(f("savedChanges")),i(),p(null)):K.oR.error(f("failedToApplyChanges"))}catch(e){K.oR.error(f("failedToApplyChanges"))}},y=(0,n.useCallback)(e=>{e.every(e=>e.resolved)?v(e):v(null)},[]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)($.N,{children:t&&!d?(0,s.jsxs)(s.Fragment,{children:[r?(0,s.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"from-muted pointer-events-none absolute inset-x-0 bottom-0 z-10 flex h-36 items-end justify-center bg-gradient-to-t to-transparent"},"unsaved-changes-bg"):null,(0,s.jsx)(m.P.div,{initial:{opacity:0,y:20,scale:.95,width:320},animate:{opacity:1,y:0,scale:1,width:o?96:320},exit:{opacity:0},transition:{duration:.15,ease:"easeOut",width:{type:"spring",stiffness:300,damping:30}},className:"shadow-modal bg-background absolute inset-x-0 bottom-3 z-50 mx-auto flex h-11 items-center justify-between rounded-full p-2 pl-3 text-sm font-medium",children:o?(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,s.jsx)(j.y,{size:16}),"Saving"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(Q.N,{className:"!text-gray-500"}),"Unsaved Changes"]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(b.$,{size:"sm",className:"h-7",rounded:!0,disabled:o,onClick:g,children:f("apply")})})]})},"unsaved-changes-island")]}):null}),(0,s.jsx)(X.lG,{open:null!==x,children:(0,s.jsxs)(X.Cf,{className:"max-h-[90vh] w-full max-w-[90vw] overflow-auto",children:[(0,s.jsxs)(X.c7,{children:[(0,s.jsx)(X.L3,{children:"Conflict Detected"}),(0,s.jsx)(X.rr,{children:"Please resolve them before saving."})]}),(0,s.jsx)(n.Suspense,{fallback:(0,s.jsx)(j.y,{}),children:x?(0,s.jsx)(J,{conflicts:x,onEdit:y}):null}),(0,s.jsxs)(X.Es,{children:[(0,s.jsx)(b.$,{variant:"secondary",onClick:()=>{alert("You must resolve conflicts before continuing")},children:"Cancel"}),(0,s.jsx)(b.$,{onClick:w,disabled:null===h,children:"Confirm"})]})]})})]})}var ee=l(58032),et=l(83222),el=l(78325),es=l(2274),en=l(63848),ea=l(17383),ei=l(31781),er=l(2177),eo=l(27725),ec=l(28970),ed=l(64448),eu=l(64793);function em(e){return(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 13.5V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V8H3V1.5H8V5V6.5H9.5H13V13.5C13 14.0523 12.5523 14.5 12 14.5H6V16H12C13.3807 16 14.5 14.8807 14.5 13.5ZM9.5 5V2.12132L12.3787 5H9.5ZM2.31885 12.8194H0V11.3194H2.31885V9H3.81885V11.3194H6.13775V12.8194H3.81885V15.1377H2.31885V12.8194Z",fill:"currentColor"})})}function ef(){return(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M11.3333 8H2",stroke:"currentcolor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M7.33325 12L11.3333 8L7.33325 4",stroke:"currentcolor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M14 3.33203V12.6654",stroke:"currentcolor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}var ex=l(50121),ep=l(37120),eh=l(88704),ev=l(50403),eg=l(96008),eb=l(14341),ej=l(4432);function ew(e){let t=(0,ej.eu)(),{updateBlockData:l}=(0,eb.P6)({blockId:e}),s=(0,ej.y6)();return async function(n,a){let i=(0,Y.L5)({files:n,blockType:"code-project"}),r=await (0,eg.Z)({blockId:e,source:i,movedFile:null==a?void 0:a.moveFile});return r.transformedSource&&(i=r.transformedSource),t&&e===t.id&&s({...t,hasSourceBeenEdited:!0,source:i}),l({blockId:e,data:{hasSourceBeenEdited:!0,source:i}}),r}}function ey(){let{data:e,mutate:t}=(0,c.Ay)("showNewFileDialog",null,{fallbackData:!1}),{data:l,mutate:s}=(0,c.Ay)("newFileDialogData",null,{fallbackData:{folderName:""}});return{newFileDialogData:l,setNewFileDialogData:s,showNewFileDialog:e,setShowNewFileDialog:t}}function ek(e){let{blockId:t,sourceFiles:l,onSuccess:a}=e,{newFileDialogData:i,showNewFileDialog:r,setShowNewFileDialog:o}=ey(),c=ew(t),[d,u]=(0,n.useState)(!1),[m,f]=(0,n.useState)(""),x=(0,L.k)("fileTreeActions");(0,n.useEffect)(()=>{r&&f("")},[r]);let p=(0,n.useCallback)(async e=>{e.preventDefault();try{u(!0);let e="".concat(i.folderName,"/").concat(m);i.folderName||(e=m);let s=m.split(".").pop(),n={source:"",meta:{file:e},blockId:t,lang:(0,ex.SR)(s),isDeleted:!1,isEdit:!1,isMerged:!1,isMoved:!1,isLocked:!1,isFixed:!1,isQuickEdit:!1,isAttachmentQuickEdit:!1,isUserEdit:!0};if((await c([...l,n])).success)null==a||a();else throw Error("Failed")}catch(e){K.oR.error(x("newFileNotificationError"))}finally{u(!1)}},[t,l,i,a,x,c,m]);return(0,s.jsxs)(eh.Modal,{onOpenChange:o,open:r,responsive:!1,children:[(0,s.jsx)(eh.ModalHeader,{children:(0,s.jsx)(eh.ModalTitle,{children:x("newFile")})}),(0,s.jsx)(eh.ModalContent,{children:(0,s.jsx)("form",{className:"flex flex-col gap-6",onSubmit:p,children:(0,s.jsx)(ev.p,{onChange:e=>f(e.target.value),disabled:d,value:m})})}),(0,s.jsxs)(eh.ModalFooter,{children:[(0,s.jsx)(eh.ModalClose,{asChild:!0,children:(0,s.jsx)(b.$,{size:"sm",variant:"secondary",children:x("cancel")})}),(0,s.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:d,onClick:p,size:"sm",children:d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ep.IconSpinner,{className:"size-4"}),x("creating")]}):x("create")})]})]})}function eN(){let{data:e,mutate:t}=(0,c.Ay)("showDeleteFileDialog",null,{fallbackData:!1}),{data:l,mutate:s}=(0,c.Ay)("deleteFileDialogData",null,{fallbackData:{fileName:""}});return{showDeleteFileDialog:e,setShowDeleteFileDialog:t,deleteFileDialogData:l,setDeleteFileDialogData:s}}function eP(e){let{blockId:t,sourceFiles:l,onSuccess:a}=e,{showDeleteFileDialog:i,setShowDeleteFileDialog:r,deleteFileDialogData:o}=eN(),c=ew(t),[d,u]=(0,n.useState)(!1),m=(0,L.k)("fileTreeActions"),f=(0,n.useCallback)(async()=>{try{u(!0);let e=[...l];for(let t of e)if(t.meta.file===o.fileName){t.source="... deleted ...",t.isDeleted=!0,t.isUserEdit=!0,t.isMerged=!1,t.moveToEnd=!0;break}if((await c(e)).success)null==a||a();else throw Error("Failed")}catch(e){K.oR.error(m("fileDeletedNotificationError"))}finally{u(!1)}},[o,l,a,c,m]);return(0,s.jsxs)(eh.Modal,{onOpenChange:r,open:i,responsive:!1,children:[(0,s.jsx)(eh.ModalHeader,{children:(0,s.jsx)(eh.ModalTitle,{children:m("deleteFile")})}),(0,s.jsx)(eh.ModalContent,{children:(0,s.jsxs)("p",{children:["Are you sure you want to delete"," ",(0,s.jsx)("span",{className:"font-bold",children:o.fileName}),"?"]})}),(0,s.jsxs)(eh.ModalFooter,{children:[(0,s.jsx)(eh.ModalClose,{asChild:!0,children:(0,s.jsx)(b.$,{size:"sm",variant:"secondary",children:m("cancel")})}),(0,s.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:d,onClick:f,size:"sm",variant:"destructive",children:d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ep.IconSpinner,{className:"size-4"}),m("deleting")]}):m("delete")})]})]})}function eE(){let{data:e,mutate:t}=(0,c.Ay)("showDeleteFolderDialog",null,{fallbackData:!1}),{data:l,mutate:s}=(0,c.Ay)("deleteFolderDialogData",null,{fallbackData:{folderName:"",source:""}});return{deleteFolderDialogData:l,setDeleteFolderDialogData:s,showDeleteFolderDialog:e,setShowDeleteFolderDialog:t}}function eC(e){let{blockId:t,sourceFiles:l,onSuccess:a}=e,{deleteFolderDialogData:i,showDeleteFolderDialog:r,setShowDeleteFolderDialog:o}=eE(),c=ew(t),[d,u]=(0,n.useState)(!1),m=(0,L.k)("fileTreeActions"),f=(0,n.useCallback)(async()=>{try{u(!0);let e=[...l];for(let t of e)(t.meta.file.startsWith(i.folderName)?i.source:void 0)&&(t.source="... deleted ...",t.isDeleted=!0,t.isUserEdit=!0,t.isMerged=!1,t.moveToEnd=!0);if((await c(e)).success)null==a||a();else throw Error("Failed")}catch(e){K.oR.error(m("folderDeletedNotificationError"))}finally{u(!1)}},[i,l,a,c,m]);return(0,s.jsxs)(eh.Modal,{onOpenChange:o,open:r,responsive:!1,children:[(0,s.jsx)(eh.ModalHeader,{children:(0,s.jsx)(eh.ModalTitle,{children:m("deleteFolder")})}),(0,s.jsx)(eh.ModalContent,{children:(0,s.jsxs)("p",{className:"mb-2",children:["Are you sure you want to delete"," ",(0,s.jsx)("span",{className:"font-bold",children:i.folderName}),"?"]})}),(0,s.jsxs)(eh.ModalFooter,{children:[(0,s.jsx)(eh.ModalClose,{asChild:!0,children:(0,s.jsx)(b.$,{size:"sm",variant:"secondary",children:m("cancel")})}),(0,s.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:d,onClick:f,size:"sm",variant:"destructive",children:d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ep.IconSpinner,{className:"size-4"}),m("deleting")]}):m("delete")})]})]})}function eS(){let{data:e,mutate:t}=(0,c.Ay)("showNewFolderDialog",null,{fallbackData:!1}),{data:l,mutate:s}=(0,c.Ay)("newFolderDialogData",null,{fallbackData:{folderName:""}});return{newFolderDialogData:l,setNewFolderDialogData:s,showNewFolderDialog:e,setShowNewFolderDialog:t}}function eT(e){let{onSuccess:t}=e,{newFolderDialogData:l,showNewFolderDialog:a,setShowNewFolderDialog:i}=eS(),[r,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),u=(0,L.k)("fileTreeActions");(0,n.useEffect)(()=>{a&&d("")},[a]);let m=(0,n.useCallback)(e=>{e.preventDefault(),o(!0);let s=l.folderName?"".concat(l.folderName,"/").concat(c):c;null==t||t(s),o(!1)},[l,t,c]);return(0,s.jsxs)(eh.Modal,{onOpenChange:i,open:a,responsive:!1,children:[(0,s.jsx)(eh.ModalHeader,{children:(0,s.jsx)(eh.ModalTitle,{children:u("newFolder")})}),(0,s.jsx)(eh.ModalContent,{children:(0,s.jsx)("form",{className:"flex flex-col gap-6",onSubmit:m,children:(0,s.jsx)(ev.p,{onChange:e=>d(e.target.value),disabled:r,value:c})})}),(0,s.jsxs)(eh.ModalFooter,{children:[(0,s.jsx)(eh.ModalClose,{asChild:!0,children:(0,s.jsx)(b.$,{size:"sm",variant:"secondary",children:u("cancel")})}),(0,s.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:r,onClick:m,size:"sm",children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ep.IconSpinner,{className:"size-4"}),u("creating")]}):u("create")})]})]})}function eR(){let{data:e,mutate:t}=(0,c.Ay)("showRenameFileDialog",null,{fallbackData:!1}),{data:l,mutate:s}=(0,c.Ay)("renameFileDialogData",null,{fallbackData:{fileName:""}});return{renameFileDialogData:l,setRenameFileDialogData:s,showRenameFileDialog:e,setShowRenameFileDialog:t}}function eI(e){let{blockId:t,sourceFiles:l,onSuccess:a}=e,{renameFileDialogData:i,showRenameFileDialog:r,setShowRenameFileDialog:o}=eR(),c=ew(t),[d,u]=(0,n.useState)(!1),[m,f]=(0,n.useState)(""),x=(0,L.k)("fileTreeActions");(0,n.useEffect)(()=>{f(i.fileName.split("/").slice(-1)[0])},[i.fileName]);let p=(0,n.useCallback)(async e=>{e.preventDefault();try{u(!0);let e=[...l],t=e.findIndex(e=>e.meta.file===i.fileName),s=i.fileName.split("/").slice(0,-1).join("/"),n=s?"".concat(s,"/").concat(m):m;if(e[t].meta.file=n,e[t].isMoved=!0,e[t].isUserEdit=!0,(await c([...e],{moveFile:{from:i.fileName,to:n}})).success)null==a||a(n);else throw Error("Failed")}catch(e){K.oR.error(x("renameFileNotificationError"))}finally{u(!1)}},[l,a,i,x,c,m]);return(0,s.jsxs)(eh.Modal,{onOpenChange:o,open:r,responsive:!1,children:[(0,s.jsx)(eh.ModalHeader,{children:(0,s.jsx)(eh.ModalTitle,{children:x("renameFile")})}),(0,s.jsx)(eh.ModalContent,{children:(0,s.jsx)("form",{className:"flex flex-col gap-6",onSubmit:p,children:(0,s.jsx)(ev.p,{onChange:e=>f(e.target.value),disabled:d,value:m})})}),(0,s.jsxs)(eh.ModalFooter,{children:[(0,s.jsx)(eh.ModalClose,{asChild:!0,children:(0,s.jsx)(b.$,{size:"sm",variant:"secondary",children:x("cancel")})}),(0,s.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:d,onClick:p,size:"sm",children:d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ep.IconSpinner,{className:"size-4"}),x("renaming")]}):x("rename")})]})]})}function eU(e){let{className:t,...l}=e;return(0,s.jsxs)("svg",{className:(0,f.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",...l,children:[(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13 10.4V11.2H10.6V10.4C10.6 9.73726 11.1373 9.2 11.8 9.2C12.4627 9.2 13 9.73726 13 10.4ZM9.4 11.2V10.4C9.4 9.07452 10.4745 8 11.8 8C13.1255 8 14.2 9.07452 14.2 10.4V11.2H15V14.8C15 15.4627 14.4627 16 13.8 16H9.8C9.13726 16 8.6 15.4627 8.6 14.8V11.2H9.4Z",fill:"currentColor"}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 7V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V13.5C1.5 14.8807 2.61929 16 4 16H7V14.5H4C3.44772 14.5 3 14.0523 3 13.5V1.5H8V5V6.5H9.5H13V7H14.5ZM9.5 5V2.12132L12.3787 5H9.5Z",fill:"currentColor"})]})}function eA(e){let{className:t,...l}=e;return(0,s.jsxs)("svg",{className:(0,f.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",...l,children:[(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.39997 10.7499C9.39997 10.1148 8.8851 9.5999 8.24997 9.5999C7.61485 9.5999 7.09997 10.1148 7.09997 10.7499V11.1428H5.89997V10.7499C5.89997 9.45203 6.95211 8.3999 8.24997 8.3999C9.54784 8.3999 10.6 9.45203 10.6 10.7499V11.2H15V14.8C15 15.4627 14.4627 16 13.8 16H9.8C9.13725 16 8.59999 15.4627 8.59999 14.8V11.2H9.39997V10.7499Z",fill:"currentColor"}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 10V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V13.5C1.5 14.8807 2.61929 16 4 16H7V14.5H4C3.44772 14.5 3 14.0523 3 13.5V1.5H8V5V6.5H9.5H13V10H14.5ZM9.5 5V2.12132L12.3787 5H9.5Z",fill:"currentColor"})]})}let e_=e=>{let{blockId:t,sourceFiles:l,onChange:s}=e,a=ew(t),i=(0,L.k)("fileTreeActions"),[r,c]=(0,n.useState)(null);return{handleToggleFileLock:(0,n.useCallback)(async e=>{let n,r;let d=[...l],u="locking";for(let t of d)if(("single-file"!==e.variant||t.meta.file===e.fileNameToEdit)&&("folder"!==e.variant||t.meta.file.startsWith(e.folderName))&&(("single-file"===e.variant&&t.isLocked||"all-files"===e.variant&&"unlock"===e.mode||"folder"===e.variant&&"unlock"===e.mode)&&(u="unlocking"),"single-file"===e.variant?t.isLocked=!t.isLocked:t.isLocked="lock"===e.mode,"single-file"===e.variant))break;"all-files"===e.variant?c({type:"locking"===u?"locking-all":"unlocking-all"}):"folder"===e.variant?c({type:"locking"===u?"locking-folder":"unlocking-folder",folderName:e.folderName}):c({type:u,fileName:e.fileNameToEdit});try{n=await a(d)}catch(e){n={success:!1}}r="single-file"===e.variant?"locking"===u?"fileLockedNotification":"fileUnlockNotification":"locking"===u?"filesLockedNotification":"filesUnlockedNotification",c(null),n.success?((0,o.u)("LockFiles",{variant:e.variant,state:u,blockId:t}),K.oR.success(i(r),{position:"bottom-right"}),s()):((0,o.u)("LockFilesError",{variant:e.variant,state:u,blockId:t}),console.error(n),K.oR.error(i("fileLockNotificationError"),{position:"bottom-right"}))},[l,a,i,s,t]),lockingStatus:r}},eO="file-tree-panel-right",eD="file-tree-panel-left";function eL(e){let{showDiffInfo:t,activeFilePath:l,initialFileTreeSize:a,setActiveFile:i,children:r,files:o,loadingPath:d,blockId:u,source:m,onChange:x}=e,[p,h]=(0,n.useState)(!!(null==o?void 0:o.length)),{defaultSizeRef:v,isFallbackSize:g}=(0,el.Zf)({initialSize:a,fallbackSize:15}),j=(0,n.useRef)(!1),{setDeleteFileDialogData:w,setShowDeleteFileDialog:y}=eN(),{setDeleteFolderDialogData:k,setShowDeleteFolderDialog:P}=eE(),{setRenameFileDialogData:E,setShowRenameFileDialog:C}=eR(),{newFileDialogData:S,setNewFileDialogData:T,setShowNewFileDialog:R}=ey(),{setNewFolderDialogData:I,setShowNewFolderDialog:U}=eS(),{tempFolders:A,setTempFolders:_}=function(e){let{blockId:t}=e,{data:l,mutate:s}=(0,c.Ay)(["tempFolders",t],null,{fallbackData:[]});return{tempFolders:l,setTempFolders:s}}({blockId:u}),O=ew(u);(0,n.useEffect)(()=>{!j.current&&(null==o?void 0:o.length)&&h(!!o.length)},[o]);let D=(0,n.useMemo)(()=>{let e=o?o.map(e=>["file"in e.meta?e.meta.file:"",e]):[];for(let t of A||[])e.push([t,null]);let l=[];for(let[s,n]of e){let e=s.split("/"),a=l;for(let[l,s]of e.entries()){let i=l===e.length-1&&null!==n,r=e.slice(0,l+1).join("/"),o=a.find(e=>e.title===s);if(!o){let e={title:s,value:r,isLocked:(null==n?void 0:n.isLocked)||!1},l=null==n?void 0:n.originalCode,c=null==n?void 0:n.source;if(i){if(t&&l&&l!==c&&c){let t=(0,ed.G)(l,c);e.addedCount=t.filter(e=>e.added).length,e.removedCount=t.filter(e=>e.removed).length}else t&&c&&!l&&(e.addedCount=c.split("\n").length,e.removedCount=0)}else e.items=[];a.push(e),o=e}i||(a=o.items||[])}}return l},[o,t,A]),L=(0,n.useMemo)(()=>(0,Y.A2)({source:m,blockType:"code-project",blockId:u}),[m,u]),F=(0,n.useMemo)(()=>{let e=0,t=l=>{for(let s of l)s.items?t(s.items):e++};return t(D),e},[D]),{handleToggleFileLock:M,lockingStatus:z}=e_({sourceFiles:L,blockId:u,onChange:x}),H=(0,n.useCallback)(e=>{let{item:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(ec.kt,{onSelect:()=>M({fileNameToEdit:t.value,variant:"single-file"}),children:[t.isLocked?(0,s.jsx)(er.e,{}):(0,s.jsx)(ei.C,{}),(0,s.jsx)("span",{children:t.isLocked?"Unlock":"Lock"})]}),(0,s.jsxs)(ec.kt,{onSelect:()=>M({mode:"lock",variant:"all-files"}),children:[(0,s.jsx)(eU,{}),"Lock All"]}),(0,s.jsxs)(ec.kt,{onSelect:()=>M({mode:"unlock",variant:"all-files"}),children:[(0,s.jsx)(eA,{}),"Unlock All"]}),(0,s.jsx)(ec.K5,{}),(0,s.jsxs)(ec.kt,{onSelect:()=>{C(!0),E({fileName:t.value})},children:[(0,s.jsx)(eu.A,{}),"Rename"]}),(0,s.jsxs)(ec.kt,{onSelect:async()=>{try{let e;let l=L.find(e=>e.meta.file===t.value);if(!l)throw Error("File not found");let s=l.meta.file.split("/"),n=s[s.length-1],a=s.length>1?s.slice(0,-1).join("/"):"",i=n.split("."),r=i.reverse().pop()||"",o=i.reverse().join("."),c=r.match(/-copy(-(\d+))?$/),d=r,m=c?c[2]?parseInt(c[2])+1:2:1;do d=c?r.replace(/-copy(-\d+)?$/,"-copy-".concat(m)):"".concat(r,"-copy").concat(m>1?"-".concat(m):""),e="".concat(a?"".concat(a,"/"):"").concat(d).concat(o?".".concat(o):""),m++;while(L.some(t=>t.meta.file===e));let f={source:l.source,meta:{file:e},blockId:u,lang:(0,ex.SR)(o),isDeleted:!1,isEdit:!1,isMerged:!1,isMoved:!1,isFixed:!1,isQuickEdit:!1,isAttachmentQuickEdit:!1,isLocked:!1,isUserEdit:!0};if((await O([...L,f])).success)x();else throw Error("Failed")}catch(e){throw Error("Failed")}},children:[(0,s.jsx)(ea.z,{}),(0,s.jsx)("span",{children:"Duplicate"})]}),(0,s.jsxs)(ec.kt,{variant:"destructive",onSelect:()=>{y(!0),w({fileName:t.value})},children:[(0,s.jsx)(eo.l,{}),"Delete"]})]})},[u,x,w,E,y,C,M,L,O]),V=(0,n.useCallback)(e=>{let{item:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(ec.kt,{onSelect:()=>{T({folderName:t.value}),R(!0)},children:[(0,s.jsx)(em,{}),"New File"]}),(0,s.jsxs)(ec.kt,{onSelect:()=>{I({folderName:t.value}),U(!0)},children:[(0,s.jsx)(en.J,{}),"New Folder"]}),(0,s.jsx)(ec.K5,{}),(0,s.jsxs)(ec.kt,{onSelect:()=>M({variant:"folder",mode:"lock",folderName:t.value}),children:[(0,s.jsx)(eU,{}),"Lock Folder"]}),(0,s.jsxs)(ec.kt,{onSelect:()=>M({variant:"folder",mode:"unlock",folderName:t.value}),children:[(0,s.jsx)(eA,{}),"Unlock Folder"]}),(0,s.jsx)(ec.K5,{}),(0,s.jsxs)(ec.kt,{variant:"destructive",onSelect:()=>{_(e=>(e||[]).filter(e=>e!==t.value)),P(!0),k({folderName:t.value,source:m})},children:[(0,s.jsx)(eo.l,{}),"Delete"]})]})},[k,T,I,P,_,U,M,R,m]),B=(0,n.useCallback)(()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(ec.kt,{onSelect:()=>{R(!0),T({folderName:""})},children:[(0,s.jsx)(em,{}),"New File"]}),(0,s.jsxs)(ec.kt,{onSelect:()=>{U(!0),I({folderName:""})},children:[(0,s.jsx)(en.J,{}),"New Folder"]}),(0,s.jsx)(ec.K5,{}),(0,s.jsxs)(ec.kt,{onSelect:()=>M({mode:"lock",variant:"all-files"}),children:[(0,s.jsx)(eU,{}),"Lock All"]}),(0,s.jsxs)(ec.kt,{onSelect:()=>M({mode:"unlock",variant:"all-files"}),children:[(0,s.jsx)(eA,{}),"Unlock All"]})]}),[R,M,T,U,I]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(el.YZ,{isFallbackSize:g,collapseSide:"left",cookie:N.ao,id:"file-tree-panel-group",className:"h-screen w-screen",direction:"horizontal",leftId:eD,rightId:eO,defaultSizeRef:v,children:[(0,s.jsx)(el.je,{className:"z-10 h-full min-w-[160px]",collapseSide:"left",isOpen:F>1&&p,order:1,defaultSize:v.current,collapseId:eD,children:(0,s.jsx)(n.Suspense,{fallback:null,children:(0,s.jsx)("div",{className:"bg-muted flex h-full flex-col",children:(0,s.jsx)(et.h,{loading:d,active:l,onSelect:i,lockingStatus:z,className:"w-full flex-1 overflow-y-auto p-1.5 pb-12",items:D,FileActions:H,FolderActions:V,TreeActions:B})})})}),(0,s.jsx)(es.Zk,{id:eO,order:2,defaultSize:p?100-v.current:100,className:"h-full min-w-[200px]",children:r}),F>1?(0,s.jsx)(b.$,{tooltip:"".concat(p?"Close":"Open"," File Tree"),className:(0,f.cn)("absolute bottom-2 left-2 z-20 size-7 transition-all",p?"-scale-x-100":""),variant:"secondary",size:"sm",onClick:()=>{j.current=!0,h(!p)},children:(0,s.jsx)(ef,{},"arrow")},"button"):null]}),(0,s.jsx)(eP,{blockId:u,sourceFiles:L,onSuccess:()=>{y(!1),x()}}),(0,s.jsx)(eC,{blockId:u,sourceFiles:L,onSuccess:()=>{P(!1),x()}}),(0,s.jsx)(ek,{blockId:u,sourceFiles:L,onSuccess:()=>{R(!1),x()}}),(0,s.jsx)(eT,{onSuccess:e=>{_(t=>Array.from(new Set([...t||[],e]))),U(!1),x()}}),(0,s.jsx)(eI,{blockId:u,sourceFiles:L,onSuccess:e=>{e&&l===S.fileName&&i(e),C(!1),x()}})]})}var eF=l(15524),eM=l(14576),ez=l(92872);function eH(e){let{data:t,mutate:l}=(0,c.Ay)(["block:consoleEvents",e],{fallbackData:{}});return{blockStatus:null!=t?t:{},flagNewEvent:(0,n.useCallback)(t=>l(l=>({...l,[e]:l&&"error"===l[e]?"error":t})),[e,l]),clearEvents:(0,n.useCallback)(()=>l(t=>{let l={...t};return l[e]=null,l}),[e,l])}}var eV=l(74197);function eB(e){let{data:t,mutate:l}=(0,c.Ay)(["block:file-editing-status",e],{fallbackData:!1});return[t,(0,n.useCallback)(e=>{l(e)},[l])]}var eW=l(82325),eZ=l(70240),eG=l(75838),eK=l(8253),e$=l(84168),eQ=l(50048),eX=l(95836),eY=l(4312),eJ=l(53515),eq=l(63321),e0=l(23082),e1=l(55350);function e5(e){let{event:t,canWriteToChat:l,onAskV0:n}=e;return(0,s.jsxs)("div",{className:"flex items-start gap-4 px-2 py-1 font-mono text-sm",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("time",{className:"text-[13px]",children:[(0,eQ.GP)(new Date(t.timestamp),"HH:mm:ss.SSS"),"Z"]}),t.isServer&&(0,s.jsx)("span",{className:"rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-600",children:"[SERVER]"})]}),(0,s.jsx)("div",{className:"w-full flex-1 whitespace-pre-wrap text-[13px]",children:t.message}),l&&"error"===t.method&&(0,s.jsx)("div",{className:"absolute right-3 top-0.5 opacity-0 transition-opacity group-hover:opacity-100",children:(0,s.jsxs)(b.$,{onClick:()=>n(t),size:"sm",variant:"secondary",className:"h-[24px] gap-0.5 rounded-md border-none px-1.5 py-0.5 font-sans text-[13px] font-medium shadow-sm",children:["Ask ",(0,s.jsx)(eX.o,{className:"ml-0.5 h-3 w-3"})]})})]})}function e2(e){let{event:t,activeFilePath:l,setActiveFilePath:a}=e,r=n.useMemo(()=>{try{let e=JSON.parse(t.content);return"string"==typeof e?e:t.content}catch(e){return t.content}},[t.content]),{isCopied:c,copyToClipboard:d}=(0,g.C)({timeout:2e3}),u=async e=>{if(c)return;let t=(0,e1.z)(e);return await d(t),(0,o.u)("CopyOutputExecutable",{output:t})},m=()=>({stdout:"stdout"===t.method?[[r]]:[],stderr:"stderr"===t.method?[[r]]:[]});return(0,s.jsx)(i.ie,{fileName:t.fileName,isCopied:c,handleCopy:()=>void u(m()),handleDownload:()=>void(0,e1.X)(m()),handleFileOpen:()=>{l!==t.fileName&&(null==a||a(t.fileName))},children:"string"==typeof r?(0,s.jsx)("pre",{className:"whitespace-pre-wrap break-words",children:r}):(0,s.jsx)(i.Ip,{src:r,className:"[&_.jv-chevron]:ml-1 [&_.jv-chevron]:inline-block [&_.jv-chevron]:size-3 [&_.jv-chevron]:text-gray-500 [&_.jv-indent]:pl-4",style:"stderr"===t.method?{color:"rgb(192,27,93)"}:void 0})})}function e3(e){let{consoleEvents:t,clearLogs:l,canWriteToChat:n,hideHeader:a,className:r,activeFilePath:o,setActiveFilePath:c}=e,{setPromptFormInput:d}=(0,eY.Q1)(),u=(0,ej.oQ)(),{containerRef:m,vlistRef:x,handleScroll:p,scrollDownButton:h}=(0,e0.I)({count:t.length,pushToBottom:!0}),v=e=>{d("The code has the following ".concat(e.method,":\n```\n").concat("console"===e.type?e.message:e.content,"\n```\nRevise the code to address this issue.")),(0,eJ.Ny)()&&u(!1)};return(0,s.jsxs)("div",{className:(0,f.cn)("bg-muted flex size-full flex-col items-stretch overflow-hidden",r),children:[!a&&(0,s.jsxs)(eV.o,{className:"justify-between gap-1",bottomBorder:!0,children:[(0,s.jsx)("h3",{className:"text-[13px] font-medium",children:"Console"}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsxs)("span",{children:[t.length," "]}),(0,s.jsx)("span",{children:1===t.length?"event":"events"})]}),(0,s.jsx)("div",{className:"ml-1 h-[16px] w-[1px] bg-gray-200","aria-hidden":!0}),(0,s.jsx)(b.$,{variant:"ghost",size:"xs",className:"text-gray-500",tooltip:"Clear console output",onClick:l,disabled:0===t.length,children:(0,s.jsx)(S,{})})]})]}),(0,s.jsxs)("div",{className:"relative size-full",style:{contain:"strict"},children:[(0,s.jsx)("div",{className:"h-full w-full overflow-y-auto",ref:m,style:{overflowAnchor:"none"},children:(0,s.jsx)("div",{className:"mx-auto w-full",children:0===t.length?(0,s.jsx)("div",{className:"flex h-full items-center justify-center p-8",children:(0,s.jsx)("div",{className:"text-center text-sm text-gray-500",children:"No logs available to display"})}):(0,s.jsx)(eq.YV,{scrollRef:m,ref:x,onScroll:p,children:t.map((e,t)=>(0,s.jsx)("div",{className:(0,f.cn)("group relative flex min-h-[24px] items-center",(0,i.eD)(e.method)),children:"console"===e.type?(0,s.jsx)(e5,{event:e,canWriteToChat:n,onAskV0:v}):(0,s.jsx)(e2,{event:e,activeFilePath:o,setActiveFilePath:c})},"".concat(e.timestamp,"-").concat(t)))})})}),t.length>0?(0,s.jsx)("div",{className:"sticky inset-x-0 bottom-2 z-50 flex justify-center",children:h}):null]})]})}var e4=l(77880);let e9=e=>{let{className:t,dotColor:l}=e;return(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 5.64582V12.5C16 13.8807 14.8807 15 13.5 15H2.5C1.11929 15 0 13.8807 0 12.5V2.5V1H1.5H9.53513C9.27389 1.45161 9.0984 1.95903 9.03095 2.5H1.5V12.5C1.5 13.0523 1.94772 13.5 2.5 13.5H13.5C14.0523 13.5 14.5 13.0523 14.5 12.5V6.70924C15.08 6.47444 15.5925 6.10753 16 5.64582ZM4.44194 10.6919L4 11.1339L3.11612 10.25L3.55806 9.80806L5.36612 8L3.55806 6.19194L3.11612 5.75L4 4.86612L4.44194 5.30806L6.51517 7.38128C6.85687 7.72299 6.85687 8.27701 6.51516 8.61872L4.44194 10.6919ZM8.6225 9.75494H8V10.9999H8.6225H11.75H12.3725V9.75494H11.75H8.6225Z",className:"fill-current"}),(0,s.jsx)("circle",{cx:"13",cy:"3",r:"3",fill:l})]})};function e6(e){let{status:t,isExpanded:l}=e;return!t||l?(0,s.jsx)(e4.b,{}):(0,s.jsx)(e9,{className:"text-gray-500 transition-colors group-hover/log-panel-header:text-gray-900",dotColor:"error"===t?"#DC2626":"#2563EB"})}let e7=(e,t)=>e/t*100,e8=(e,t)=>e/100*t,te=e=>e>N.Tq;function tt(e){let{children:t,blockId:l,consoleEvents:a=[],clearLogs:i,canWriteToChat:r,activeFilePath:o,setActiveFilePath:c,initialSize:d,initialExpanded:m,onShouldExpand:x}=e,[p,v]=(0,n.useState)(""),{blockStatus:g,clearEvents:j}=eH(l),w=g[l],y=(0,n.useRef)(null),[k,P]=(0,n.useState)(null!=m?m:N.XK),E=(0,n.useRef)(null),C=(0,n.useMemo)(()=>{if(!p)return a;let e=p.toLowerCase();return a.filter(t=>"console"===t.type?t.message.toLowerCase().includes(e):t.content.toLowerCase().includes(e))},[a,p]),T=(0,n.useCallback)(()=>{var e,t,l,s,n,a,i;let r=null===(e=y.current)||void 0===e?void 0:e.getContainer(),o=null==r?void 0:null===(t=r.parentElement)||void 0===t?void 0:t.clientHeight;if(!o)return;let c=e7(N.as,o),d=null!==(s=null===(l=y.current)||void 0===l?void 0:l.getSize())&&void 0!==s?s:0;if(k)d>c&&(E.current=d),null===(n=y.current)||void 0===n||n.setSize(c),u.A.set(N.Mo,String(c),{expires:7}),u.A.set(N.jL,String(!1),{expires:7});else{let e=null!==(i=E.current)&&void 0!==i?i:N.uq;null===(a=y.current)||void 0===a||a.setSize(e),u.A.set(N.Mo,String(e),{expires:7}),u.A.set(N.jL,String(!0),{expires:7})}P(!k),j()},[k,j]);(0,n.useEffect)(()=>{x&&!k&&x(T)},[x,T,k]);let R=(0,n.useCallback)(e=>{var t,l,s;let n=null===(t=y.current)||void 0===t?void 0:t.getContainer(),a=te(e8(e,null!==(s=null==n?void 0:null===(l=n.parentElement)||void 0===l?void 0:l.clientHeight)&&void 0!==s?s:0));a&&(E.current=null),k!==a&&(P(a),u.A.set(N.jL,String(a),{expires:7}),j())},[j,k]),I=(0,L.k)("logPanel");return(0,s.jsxs)("div",{className:"relative flex size-full min-h-0 flex-1 flex-col",children:[t,(0,s.jsx)(h,{animated:!1,axis:"y",cookieName:N.Mo,dotsHandle:!1,initialSize:null!=d?d:N.H2,minSizePx:N.as,minNegativeSpace:144,show:!0,side:"start",snapTo:{threshold:N.Tq,size:N.as},onResize:R,className:"z-20",ref:y,children:(0,s.jsxs)("div",{className:"bg-muted group/log-panel-header relative flex size-full flex-col border-t",children:[(0,s.jsxs)("div",{className:"border-alpha-400 flex h-9 w-full shrink-0 cursor-pointer items-center justify-between border-b hover:text-gray-900",onClick:T,children:[(0,s.jsxs)("div",{className:(0,f.cn)("flex items-center gap-1.5 px-3 text-sm text-gray-500 transition-all group-hover/log-panel-header:text-gray-900",k&&"text-gray-900"),children:[(0,s.jsx)(e6,{status:w,isExpanded:k}),(0,s.jsx)("span",{children:I("console")})]}),(0,s.jsxs)("div",{className:"flex gap-0.5 pr-2",children:[k?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(ev.p,{placeholder:"Filter...",size:"xs",className:"w-44 rounded-md px-2 text-[13px]",value:p,onChange:e=>v(e.target.value),onClick:e=>e.stopPropagation()}),(0,s.jsx)(b.$,{variant:"ghost",size:"xs",className:"text-gray-500",tooltip:{side:"bottom",content:"Clear logs"},onClick:e=>{e.stopPropagation(),null==i||i()},disabled:0===a.length,children:(0,s.jsx)(S,{})})]}):null,(0,s.jsx)(b.$,{tooltip:{side:"bottom",content:k?"Collapse panel":"Expand panel"},variant:"ghost",className:"text-gray-500",size:"xs",onClick:e=>{e.stopPropagation(),T()},children:k?(0,s.jsx)(eK.r,{}):(0,s.jsx)(e$.U,{})})]})]}),(0,s.jsx)(e3,{hideHeader:!0,consoleEvents:C,clearLogs:i||(()=>{}),canWriteToChat:r,className:"bg-transparent",activeFilePath:o,setActiveFilePath:c})]})})]})}var tl=l(1064),ts=l(35366);let tn=(0,G.default)(()=>Promise.all([l.e(3616),l.e(2294)]).then(l.bind(l,42294)).then(e=>e.MultiFileLocalCodeBlock),{loadableGenerated:{webpack:()=>[42294]}}),ta=Z()((e,t,l)=>{if(e){var s;null===(s=e.contentWindow)||void 0===s||s.postMessage({type:"preview_code",code:t,version:l},"*")}},300);function ti(e){let{children:t,activeTab:l,setActiveTab:a,allowRefresh:i,allowFullScreen:r=!0,initialFileTreeSize:o,resultId:d,language:u,remoteInfo:m,meta:f,source:p,hasBlockPreview:h,blockId:v,blockType:g,closed:b,hasSourceBeenEdited:w,onEdit:y,files:k,loadingPath:N,originalCode:E,isV3:C,initialConsoleSize:S,initialConsoleExpanded:D}=e,{activeFilePath:F,setActiveFilePath:z,setAutoSwitch:H}=(0,eF.m)({blockId:v,files:k,loadingPath:N}),{setHref:W,latestHref:Z}=(0,ts.Z)(v),{editValueMap:G,setEditValueMap:K}=(0,eM.V)({blockId:v}),[$,Q]=(0,n.useState)(null),{flagNewEvent:X}=eH(v),[J,et]=(0,n.useState)([]),el=(0,n.useCallback)(()=>{et([])},[]),es=(0,n.useCallback)(e=>{et(t=>[...t,e]),"console"!==l&&("message"in e&&e.message.includes("[Fast Refresh]")||("error"===e.method||"stderr"===e.method?X("error"):X("log")))},[l,X]),en=(0,n.useCallback)(e=>{et(t=>[...t,...e]),e.some(e=>"stderr"===e.method)?"console"!==l&&X("error"):"console"!==l&&X("log")},[l,X]);(0,n.useEffect)(()=>{el()},[v,el]);let ea=(0,x.aq)(),{isPublished:ei}=(0,P.usePublishedPage)(),{canWriteToChat:er}=(0,eW.tZ)(),eo=(0,L.k)("previewBlock"),{data:ec,mutate:ed}=(0,c.Ay)(v?["remote:accepted",v]:null,null,{fallbackData:null==m?void 0:m.accepted}),eu=(0,ez.F)(G),em=(0,ez.F)(k),ef=(0,n.useCallback)((e,t,l)=>{if(!b)return;let s={...eu.current,[t]:e};K(s),null==y||y(e);let n=(0,U.j)(null!=d?d:v),a=document.getElementById(n);if(a){if("code-project"===g)ta(a,(0,Y.F7)((0,Y.GP)(s,em.current||[])),l);else if("v0"===g)ta(a,e);else{var i;null===(i=a.contentWindow)||void 0===i||i.postMessage({type:u.toUpperCase()+"_RENDER",source:e},a.dataset.origin||"")}}},[b,eu,K,y,d,v,g,em,u]);(0,n.useEffect)(()=>{let e=(0,U.j)(null!=d?d:v),t=document.getElementById(e);if(!t)return;let l=e=>{var l,s;if(e.data&&"object"==typeof e.data&&e.data.__v0_remote__)switch(e.data.type){case"frame_ready":if("code-project"===g){if(!(null===(l=em.current)||void 0===l?void 0:l.length))return;Object.keys(eu.current).length>0&&ta(t,(0,Y.F7)((0,Y.GP)(eu.current,em.current)))}break;case"inline_edit":if(!em.current)return;let n=em.current.findIndex(t=>t.meta.file===e.data.file);if(-1===n)return;let a=null!==(s=eu.current[e.data.file])&&void 0!==s?s:em.current[n].source,i=a.split("\n"),r=i[e.data.line-1],o=r.substring(0,e.data.column-1),c=r.substring(e.data.column-1+e.data.len),d=e.data.replace;i[e.data.line-1]=o+d+c,ef(a=i.join("\n"),e.data.file,e.data.version);break;case"console":es(e.data)}};return window.addEventListener("message",l),()=>{window.removeEventListener("message",l)}},[v,g,d,em,ef,eu,es]),(0,n.useEffect)(()=>{let e=(0,U.j)(null!=d?d:v);if(!document.getElementById(e))return;let t=e=>{e.data&&"object"==typeof e.data&&e.data.__v0_remote__&&"location_change"===e.data.type&&W(e.data.href)};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}},[v,d]);let ex=k||[{source:p,meta:f,originalCode:E,lang:u,isQuickEdit:!!f.isQuickEdit,blockId:v}],ep=(0,n.useCallback)(()=>{K({})},[K]),{user:eh}=(0,eG.J)(),ev=(0,ee.z)({blockId:v,editValueMap:G,isAdminSaving:!er&&!!(null==eh?void 0:eh.isAdminMode),source:p,meta:f,files:ex,clearEditValueMap:ep}),[,eg]=eB(v),eb=ev.hasUnsavedChanges;(0,n.useEffect)(()=>{eg(eb)},[eb,eg]);let ej=!!(b&&er)||!!(null==eh?void 0:eh.isAdminMode);if(ei)return(0,s.jsx)("div",{className:(0,I.A)("bg-muted h-full min-h-0 overflow-hidden","preview"===l&&"border-alpha-200",!ea&&"opacity-0"),children:t});if("code-project"===g){if(!o)throw Error("code-project block is missing initialFileTreeSize");let e=ex.length?ex.find(e=>e.meta.file===F)||ex[0]:void 0,a=e?[{key:"preview",content:!0===h?(0,s.jsxs)("div",{className:"flex h-full w-full flex-col",children:[(r||i)&&(0,s.jsxs)(eV.o,{className:"bg-muted justify-end gap-1",bottomBorder:!0,children:[r?(0,s.jsx)(V,{}):null,i?(0,s.jsx)(M,{blockId:d||v}):null]}),(0,s.jsx)("div",{className:"w-full flex-1 overflow-auto",children:(0,s.jsx)(B.FullscreenContainer,{children:t})})]}):"object"==typeof h&&"warning"in h?(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center gap-2",children:h.warning}):null},C?null:{key:"code",content:(0,s.jsx)(eL,{showDiffInfo:b,loadingPath:N,activeFilePath:F,setActiveFile:e=>{H&&H(!1),z(e)},initialFileTreeSize:o,files:k,source:p,blockId:v,onChange:()=>{let e=(0,U.j)(null!=d?d:v),t=document.getElementById(e);t&&(t.contentDocument?t.contentDocument.location.reload():Z.current?t.src=Z.current:t.src=t.src)},children:(0,s.jsxs)("div",{className:"flex h-full w-full flex-col",children:[(0,s.jsxs)(eV.o,{className:"justify-between gap-2",onePixelShorter:!0,children:[(0,s.jsx)("div",{className:"flex min-w-0 items-center gap-1 overflow-x-auto",children:F&&F.split("/").map((e,t)=>(0,s.jsxs)(n.Fragment,{children:[(0,s.jsx)("div",{className:"whitespace-nowrap font-medium [&:nth-last-child(2)]:text-gray-900",children:e},"part-".concat(e,"-").concat(t)),(0,s.jsx)("div",{className:"last:hidden",children:(0,s.jsx)(A.b,{})},"chevron-".concat(e,"-").concat(t))]},"part-".concat(e,"-").concat(t)))}),(0,s.jsx)("div",{className:"flex items-center gap-1",children:(0,s.jsx)(R.C,{closed:b,additionalHeaderActions:void 0,allowClose:!1,blockId:v,allowCopyCode:!0,allowDownloadCode:!0,originalCode:e.originalCode,caller:"v0",closeHandler:null,fileName:e.meta.file,isTabbed:!0,value:G[f.file||""]||e.source,isExecutable:"script"===e.meta.type&&"code"===l,transactionMeta:e.meta.transaction,language:e.lang,onExecutionComplete:e=>{en(e),null==$||$()}})})]}),(0,s.jsx)("div",{className:"w-full flex-1 overflow-auto",children:(0,s.jsx)(tr,{blockType:g,remoteInfo:m,isMultiFile:!0,closed:b,blockId:v,setEditValueMap:K,language:e.lang,editValueMap:G,hasSourceBeenEdited:w,handleEdit:ef,file:e,editable:ej,appendCodeOutputEvents:en})})]})})}].filter(tl.R):[];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tt,{blockId:v,consoleEvents:J,clearLogs:el,canWriteToChat:er,activeFilePath:F,setActiveFilePath:z,initialSize:S,initialExpanded:D,onShouldExpand:e=>Q(()=>e),children:(0,s.jsxs)("div",{className:"relative min-h-0 w-full flex-1 grow",children:[(0,s.jsx)(T.JS,{className:(0,I.A)(C?"":"border-alpha-200 border-t"),tabFiles:a,activeTabKey:l}),ej?(0,s.jsx)(ee.o,{...ev,resetValue:()=>{let e=(0,U.j)(null!=d?d:v),t=document.getElementById(e);t&&ta(t,(0,Y.F7)((0,Y.GP)({},em.current||[])))},mergedFromBlockId:v,isV3:C}):null]})}),(0,s.jsx)(T.JS,{className:C?"":"border-alpha-200 border-t",tabFiles:a,activeTabKey:l})]})}let ew=ex.map(e=>({key:void 0!==k?f.file+"code":"code",display:f.file||"Untitled",content:(0,s.jsx)(tr,{blockType:g,remoteInfo:m,closed:b,blockId:v,setEditValueMap:K,language:u,editValueMap:G,hasSourceBeenEdited:w,handleEdit:ef,file:e,editable:ej,appendCodeOutputEvents:en}),actions:(0,s.jsx)(R.C,{closed:b,additionalHeaderActions:void 0,allowClose:!1,blockId:v,allowCopyCode:!0,allowDownloadCode:!0,originalCode:e.originalCode,caller:"v0",closeHandler:null,fileName:e.meta.file,isTabbed:!0,value:G[f.file||""]||e.source})})),ey={key:"preview",disabled:!(0,eZ.O)(h),tooltip:"object"==typeof h&&"error"in h?h.error:b?void 0:eo("previewIsStreaming"),display:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(O.p,{className:"group-disabled:hidden"}),(0,s.jsx)("div",{className:"hidden group-disabled:block",children:b?(0,s.jsx)(_.X,{}):(0,s.jsx)(j.y,{size:16})}),eo("preview")]}),content:(0,s.jsx)(B.FullscreenContainer,{children:t}),actions:(0,s.jsxs)(s.Fragment,{children:[r?(0,s.jsx)(V,{}):null,i?(0,s.jsx)(M,{blockId:d||v}):null]})};return(0,s.jsxs)(s.Fragment,{children:["local"!==g||"@remote"===v||k?null:(0,s.jsx)(q,{blockId:v,hasUnappliedChanges:!!(!0!==ec||G[f.file||""]&&G[f.file||""]!==p),source:G[f.file||""]||p,onApply:()=>{ed(!0)},showFadeOut:"code"===l}),ej?(0,s.jsx)(ee.o,{...ev,resetValue:()=>{let e=(0,U.j)(null!=d?d:v),t=document.getElementById(e);if(t){if("v0"===g)ta(t,ex[0].source);else{var l;null===(l=t.contentWindow)||void 0===l||l.postMessage({type:u.toUpperCase()+"_RENDER",source:ex[0].source},t.dataset.origin||"")}}},mergedFromBlockId:v,isV3:C}):null,(0,s.jsx)(T.Yv,{activeTabKey:l||"code",isLoading:!b,setActiveTabKey:a,tabFiles:[ey,...ew]})]})}function tr(e){let{blockType:t,remoteInfo:l,closed:i,blockId:r,setEditValueMap:o,isMultiFile:c,language:d,editValueMap:u,hasSourceBeenEdited:m,handleEdit:f,file:x,editable:p,className:h,appendCodeOutputEvents:v}=e,{source:g,meta:b,originalCode:j,isQuickEdit:w}=x;return"local"===t?(0,s.jsx)(n.Suspense,{fallback:null,children:(0,s.jsx)(tn,{remoteInfo:l,blockId:r,source:g,onEdit:e=>{i&&o(t=>({...t||{},[b.file||""]:e}))},closed:i})}):(0,s.jsx)(a.N,{isMultiFile:c,allowQuoting:!0,closed:i,caller:"v0",originalCode:j,showQuickEditAnimation:!i&&w,className:(0,I.A)("not-prose flex-1 grow",h),editable:p,fixingBadLines:x.fixingBadLines,fileName:b.file,language:d,blockId:r,editValue:u[b.file||""],hasSourceBeenEdited:m,onEdit:e=>f(e,b.file||""),runnable:!0,showLineNumbers:!0,value:g,type:b.type,onExecutionComplete:v})}var to=l(45629),tc=l(69388);async function td(e){let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch outdated env vars");return t.json()}async function tu(e){if(!(await fetch(e,{method:"POST"})).ok)throw Error("Failed to sync env vars")}var tm=l(67584);function tf(){let[e,t]=(0,n.useState)(!0),{isAuthor:l}=(0,to.Pk)(),{project:a}=(0,eW.tZ)(),i=(0,ej.eu)(),{outdatedEnvVars:r,sync:o,syncError:d}=function(e,t){let{data:l,error:s,isLoading:n,mutate:a}=(0,c.Ay)(e&&t?"/chat/api/chat/env-vars/outdated?bid=".concat(e):null,td,{refreshInterval:18e4}),{trigger:i,error:r}=(0,tc.A)(e&&t?"/chat/api/chat/env-vars/outdated?bid=".concat(e):null,tu),o=async()=>{await i(),await a()};return{outdatedEnvVars:l,isLoading:n,error:s,refresh:a,sync:o,syncError:r}}(null==i?void 0:i.id,null==a?void 0:a.vercelProjectId),[u,m]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{d&&(console.error("Failed to sync environment variables",d),K.oR.error("Failed to sync environment variables",{position:"bottom-right"}))},[d]),e&&(null==r?void 0:r.length))?(0,s.jsx)("div",{className:"shadow-modal bg-background absolute bottom-2 right-2 z-10 max-w-[350px] rounded p-2",children:(0,s.jsxs)("div",{className:" flex min-w-[300px] flex-col items-center gap-3 rounded-[8px]   p-2 text-sm",role:"alert",children:[(0,s.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,s.jsxs)("div",{className:"flex w-full items-center font-semibold",children:[(0,s.jsx)("span",{children:"Outdated Environment Variables"})," "]}),(0,s.jsx)("div",{className:"flex w-full",children:(0,s.jsx)("span",{className:"font-small line-clamp-3 overflow-hidden text-xs",children:"The connected v0 Project has environment variables not in sync with the current block. Sync them to ensure your block works as expected."})})]}),l&&(0,s.jsxs)("div",{className:"flex w-full justify-end gap-2 align-middle",children:[(0,s.jsx)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",size:"sm",variant:"ghost",onClick:()=>{t(!1)},children:"Dismiss"}),(0,s.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",size:"sm",variant:"secondary",onClick:async()=>{m(!0),await o(),m(!1),t(!1),K.oR.success("Environment variables synced",{position:"bottom-right"})},disabled:u,children:[(0,s.jsx)(tm.j,{height:13,width:13})," Sync"]})]})]})}):null}class tx{static Render(e){var t;let{isPublished:l}=(0,P.usePublishedPage)(),u=(0,x.aq)(),{isCopied:m,copyToClipboard:p}=(0,g.C)({timeout:2e3}),{editValueMap:b,setEditValueMap:j}=(0,eM.V)({blockId:e.blockId}),{isAuthor:w}=(0,to.Pk)(),{data:I,mutate:U}=(0,c.Ay)(["block:output",e.blockId]),{data:A}=(0,c.Ay)("block:output:initial");(0,n.useEffect)(()=>{(null==A?void 0:A.id)===e.blockId&&A.result.then(e=>{e&&U(t=>t||e.value)})},[A,e.blockId,U]);let _=I;if(void 0===_&&(null==A?void 0:A.id)===e.blockId&&A){let e=(0,n.use)(A.result);e&&(_=e.value)}let O=async()=>{if(m)return;let e=(0,e1.z)(_);return await p(e),(0,o.u)("CopyOutputExecutable",{output:e})},D=(0,n.useMemo)(()=>k.DS.includes(e.language)&&k._b.some(t=>{var l;return null===(l=e.meta.file)||void 0===l?void 0:l.endsWith(t)}),[e.language,e.meta.file]),L=(0,ee.z)({blockId:e.blockId,editValueMap:b,source:e.source,meta:e.meta,files:[{source:e.source,meta:e.meta}],clearEditValueMap:()=>j({})}),F=l?N.Lk:N.K4,M=[{key:"code",display:e.meta.file,content:(0,s.jsxs)(s.Fragment,{children:[e.closed&&w?(0,s.jsx)(ee.o,{...L,resetValue:()=>{},mergedFromBlockId:e.blockId}):null,(0,s.jsx)(tr,{blockType:e.meta.type,remoteInfo:void 0,isMultiFile:!0,closed:e.closed,blockId:e.blockId,className:L.hasUnsavedChanges?"pb-14":"",setEditValueMap:j,language:e.language,editValueMap:b,hasSourceBeenEdited:e.hasSourceBeenEdited,handleEdit:t=>{t&&e.closed&&j(l=>({...l,[e.meta.file||""]:t}))},file:{source:e.source,meta:e.meta,lang:e.language,blockId:e.blockId,isQuickEdit:!!e.meta.isQuickEdit},editable:e.closed&&w},e.blockId)]}),actions:(0,s.jsx)(R.C,{additionalHeaderActions:void 0,allowClose:!1,allowCopyCode:!0,allowDownloadCode:!0,caller:"v0",closeHandler:null,fileName:e.meta.file,isTabbed:!0,value:b[e.meta.file||""]||e.source,originalCode:e.originalCode,blockId:e.blockId,closed:e.closed,language:e.language})}],z=l?(0,s.jsx)(a.N,{originalCode:e.originalCode,showQuickEditAnimation:!e.closed&&!!e.meta.isQuickEdit,closed:e.closed,blockId:e.blockId,allowQuoting:!0,caller:"executable",className:"min-h-52 flex-1 rounded-md",editable:!1,fileName:e.meta.file,language:e.language,runnable:D,showLineNumbers:!0,value:e.source}):(0,s.jsx)(T.Yv,{isLoading:!e.closed,activeTabKey:"code",className:"min-h-52 w-full flex-1",setActiveTabKey:()=>{},tabFiles:M});return(0,s.jsxs)("div",{className:(0,f.cn)("not-prose flex h-full w-full flex-col",l&&"bg-muted overflow-hidden rounded-md border",!u&&"opacity-0"),children:[z,D&&(0,s.jsx)(h,{animated:!1,axis:"y",cookieName:F,dotsHandle:!1,initialSize:null!==(t=e.initialOutputSize)&&void 0!==t?t:33,minSizePx:200,show:!0,side:"start",children:(0,s.jsx)("div",{className:"border-alpha-400 flex size-full min-h-0 flex-1 flex-col items-center justify-center border-t",children:_?(0,s.jsxs)("div",{className:"flex size-full flex-col items-stretch",children:[(0,s.jsxs)("div",{className:(0,f.cn)("flex items-center justify-between border-b px-2 py-1"),children:[(0,s.jsx)("h3",{className:"select-none text-sm font-medium text-gray-500",children:"Output"}),(0,s.jsxs)("div",{className:"flex select-none items-center gap-1",children:[(0,s.jsx)(y,{buttonText:"Run",codeExecutionBlockProps:e,editedValue:b[e.meta.file||""]||void 0,execute:r.M,setOutput:U,variant:"ghost"}),(0,s.jsx)("div",{className:"bg-alpha-400 h-4 w-px"}),(0,s.jsx)(v.Z,{"aria-label":"Clear",onClick:()=>U(void 0),tooltip:"Clear",children:(0,s.jsx)("span",{"aria-hidden":!0,children:(0,s.jsx)(S,{})})}),(0,s.jsx)(v.Z,{"aria-label":"Download",disabled:"error"in _,onClick:()=>(0,e1.X)(_),tooltip:"Download",children:(0,s.jsx)("span",{"aria-hidden":!0,children:(0,s.jsx)(E.q,{})})}),(0,s.jsx)(v.Z,{disabled:"error"in _,onClick:O,tooltip:"Copy",children:(0,s.jsx)("span",{"aria-hidden":!0,children:m?(0,s.jsx)(d.J,{}):(0,s.jsx)(C.T,{})})})]})]}),(0,s.jsx)(i.X3,{className:"h-full",value:_})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("p",{className:"mb-2 text-base font-medium text-gray-900",children:"No Output"}),(0,s.jsx)("p",{className:"mb-6 text-sm text-gray-500",children:e.closed?"Run the code to generate an output.":"You can execute the code after it has finished streaming."}),(0,s.jsx)(y,{codeExecutionBlockProps:e,disabled:!e.closed,editedValue:b[e.meta.file||""]||void 0,execute:r.M,setOutput:U})]})})}),D&&w&&!l&&(0,s.jsx)(tf,{})]})}static Actions(e){return null}}tx.getIsPreviewable=()=>!1,tx.TitleActions=null;let tp=new WeakMap,th=new WeakSet,tv=new WeakMap;function tg(e){let t=e.replace(/_/g,"--").replace(/[^a-zA-Z0-9-]/g,"").replace(/-+$/,"");if("generated.vusercontent.net".endsWith(".vercel.sh")){let e="generated.vusercontent.net".split(".")[0].replace(/^v0-frame-/g,"");return tb("".concat(e,"--").concat(t,".dev.vusercontent.net"))}return tb("g-".concat(t,".vusercontent.net"))}function tb(e){let t=new URL("https://example.com");return t.hostname=e,t.origin}function tj(e,t){if(!e)return;let l=tp.get(e);l?l.push(t):tp.set(e,[t]),tw(e)}function tw(e){if(!th.has(e))return;let t=tp.get(e);if(t){for(let s of t){var l;null===(l=e.contentWindow)||void 0===l||l.postMessage(s,e.dataset.origin||"")}t.length=0}}let ty=[];window.addEventListener("message",e=>{if(!(e.origin===tg("any")||e.origin.endsWith(".vusercontent.net"))||!e.source)return;let t=Array.from(document.querySelectorAll("iframe[data-v0]")).find(t=>t instanceof HTMLIFrameElement&&t.contentWindow===e.source);if(!t)return;th.add(t),tw(t),window.debug&&console.log("child event handler",e.data);let l=tv.get(t);for(let t of ty)l===t.id&&t.listener(e.data)});var tk=l(1767);let tN={LIGHTNING_WEB_COMPONENTS_UNSUPPORTED:"v0 does not currently support previewing LWC",LAYOUT_UNSUPPORTED:"v0 cannot currently preview Next.js layouts",SERVER_ACTION_UNSUPPORTED:"Server Actions cannot be previewed",RSC_UNSUPPORTED:"v0 cannot currently preview React Server Components",API_KEY_UNSUPPORTED:"v0 cannot currently preview components with API keys",REACT_NATIVE_UNSUPPORTED:"v0 cannot currently preview React Native components",ELECTRON_UNSUPPORTED:"v0 cannot currently preview Electron apps",EXPO_UNSUPPORTED:"v0 cannot currently preview Expo components",CLERK_UNSUPPORTED:"v0 does not currently support previewing Clerk",PRISMA_UNSUPPORTED:"v0 does not currently support previewing @prisma/client",NEXT_INTL_UNSUPPORTED:"v0 does not currently support previewing next-intl",NODEMAILER_UNSUPPORTED:"v0 does not currently support previewing nodemailer",INERTIA_UNSUPPORTED:"v0 does not currently support previewing Inertia.js",EXPRESS_UNSUPPORTED:"v0 does not currently support previewing Express.js",FS_NOT_SUPPORTED:"v0 does not currently support previews with file system access",REMIX_UNSUPPORTED:"v0 does not currently support previewing Remix",REACT_ROUTER_UNSUPPORTED:"v0 does not currently support previewing react-router",MONGODB_UNSUPPORTED:"v0 does not currently support previewing MongoDB",ROUTE_HANDLER_UNSUPPORTED:"v0 cannot preview Route Handlers",REACT_HOOKS:"React hooks cannot be previewed",NON_JS_TS_FILE_UNSUPPORTED:"v0 can not preview this file",TEST_FILES_UNSUPPORTED:"v0 does not currently support previewing tests",NODE_APIS:"v0 does not currently support previewing Node.js APIs",PG_UNSUPPORTED:"v0 does not currently support the pg package",CHAKRA_UNSUPPORTED:"v0 does not currently support previewing Chakra UI",REACT_PDF_UNSUPPORTED:"v0 does not currently support previewing @react-pdf/renderer",SWIPER_UNSUPPORTED:"v0 does not currently support previewing swiper/css",GOOGLEAPIS_UNSUPPORTED:"v0 does not currently support previewing code using googleapis",ANGULAR_UNSUPPORTED:"v0 does not currently support previewing Angular",MATERIAL_UI_ADAPTER_DATE_UNSUPPORTED:"v0 does not currently support previewing @mui/x-date-pickers/AdapterDateFns",PLAYWRIGHT_UNSUPPORTED:"v0 does not currently support previewing Playwright",INSTRUMENTATION_UNSUPPORTED:"v0 does not support previewing instrumentation.ts",LARAVEL_UNSUPPORTED:"v0 does not currently support previewing Laravel",MONGOOSE_UNSUPPORTED:"v0 does not currently support previewing Mongoose"},tP=[["@clerk/nextjs",tN.CLERK_UNSUPPORTED],["@clerk/clerk-react",tN.CLERK_UNSUPPORTED],["next-intl",tN.NEXT_INTL_UNSUPPORTED],["react-native",tN.REACT_NATIVE_UNSUPPORTED],["@prisma/client",tN.PRISMA_UNSUPPORTED],["pg",tN.PG_UNSUPPORTED],["nodemailer",tN.NODEMAILER_UNSUPPORTED],["@sendgrid/mail",tN.NODEMAILER_UNSUPPORTED],["@inertiajs/react",tN.INERTIA_UNSUPPORTED],["@chakra-ui/react",tN.CHAKRA_UNSUPPORTED],["@react-pdf/renderer",tN.REACT_PDF_UNSUPPORTED],["swiper/css",tN.SWIPER_UNSUPPORTED],["swiper/css/navigation",tN.SWIPER_UNSUPPORTED],["@playwright/test",tN.PLAYWRIGHT_UNSUPPORTED],["angular/router",tN.ANGULAR_UNSUPPORTED],["angular/core",tN.ANGULAR_UNSUPPORTED],["@angular/router",tN.ANGULAR_UNSUPPORTED],["@angular/core",tN.ANGULAR_UNSUPPORTED],["@angular/common",tN.ANGULAR_UNSUPPORTED],["@mui/x-date-pickers/AdapterDateFns",tN.MATERIAL_UI_ADAPTER_DATE_UNSUPPORTED],["@react-navigation/native",tN.EXPO_UNSUPPORTED],["@react-navigation/stack",tN.EXPO_UNSUPPORTED],["expo-router",tN.EXPO_UNSUPPORTED],["express",tN.EXPRESS_UNSUPPORTED],["expo-file-system",tN.EXPO_UNSUPPORTED],["googleapis",tN.GOOGLEAPIS_UNSUPPORTED],["fs",tN.FS_NOT_SUPPORTED],["fs/promises",tN.FS_NOT_SUPPORTED],["bcrypt",tN.NODE_APIS],["@remix-run/node",tN.REMIX_UNSUPPORTED],["mongodb",tN.MONGODB_UNSUPPORTED],["react-router-dom",tN.REACT_ROUTER_UNSUPPORTED],["lwc",tN.LIGHTNING_WEB_COMPONENTS_UNSUPPORTED]],tE=["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"],tC=["tsx","html","jsx","js","ts"],tS={NON_SUPPORTED_FILES:"v0 can not preview this file",NO_EXPORTED_COMPONENT:"No exported component found"};function tT(e){return"v0 does not currently support ".concat(e)}let tR={"@clerk/nextjs/server":tN.CLERK_UNSUPPORTED,"@clerk/clerk-react":tN.CLERK_UNSUPPORTED,"next-intl":tN.NEXT_INTL_UNSUPPORTED,"react-native":tN.REACT_NATIVE_UNSUPPORTED,electron:tN.ELECTRON_UNSUPPORTED,pg:tN.PG_UNSUPPORTED,nodemailer:tN.NODEMAILER_UNSUPPORTED,"@sendgrid/mail":tN.NODEMAILER_UNSUPPORTED,"@chakra-ui/react":tN.CHAKRA_UNSUPPORTED,lwc:tN.LIGHTNING_WEB_COMPONENTS_UNSUPPORTED,"@playwright/test":tN.PLAYWRIGHT_UNSUPPORTED,"angular/router":tN.ANGULAR_UNSUPPORTED,"angular/core":tN.ANGULAR_UNSUPPORTED,"@angular/router":tN.ANGULAR_UNSUPPORTED,"@angular/core":tN.ANGULAR_UNSUPPORTED,"@angular/common":tN.ANGULAR_UNSUPPORTED,"@mui/x-date-pickers/AdapterDateFns":tN.MATERIAL_UI_ADAPTER_DATE_UNSUPPORTED,"@react-navigation/native":tN.EXPO_UNSUPPORTED,"@react-navigation/stack":tN.EXPO_UNSUPPORTED,"expo-router":tN.EXPO_UNSUPPORTED,express:tN.EXPRESS_UNSUPPORTED,"expo-file-system":tN.EXPO_UNSUPPORTED,googleapis:tN.GOOGLEAPIS_UNSUPPORTED,"@remix-run/node":tN.REMIX_UNSUPPORTED,mongodb:tN.MONGODB_UNSUPPORTED,"react-router-dom":tN.REACT_ROUTER_UNSUPPORTED,"laravel-mix":tN.LARAVEL_UNSUPPORTED,mongoose:tN.MONGOOSE_UNSUPPORTED,"discord-player":tT("discord-player"),"fluent-ffmpeg":tT("fluent-ffmpeg"),"@prisma/client":tT("@prisma/client"),hono:tT("hono"),undici:tT("undici"),http2:tT("http2"),payload:tT("payload"),"@nestjs/mongoose":tT("@nestjs/mongoose"),"@nestjs/core":tT("@nestjs/core"),"@ionic/angular":tT("@ionic/angular"),"firebase-admin/database":tT("firebase-admin/database"),"firebase-admin":tT("firebase-admin"),"firebase-functions":tT("firebase-functions"),"puppeteer-core":tT("puppeteer-core"),"coffee-script":tT("coffee-script"),msw:tT("msw"),"msw/node":tT("msw/node"),mysql2:tT("mysql2"),"mysql2/promise":tT("mysql2"),"@worldcoin/idkit":tT("@worldcoin/idkit"),"discord.js":tT("discord.js"),"@vitejs/plugin-react":tT("Vite"),"vite-plugin-react":tT("Vite"),nativewind:tT("nativewind"),commander:tT("commander"),cosmiconfig:tT("cosmiconfig"),"react-native-svg":tT("react-native-svg"),"google-auth-library":tT("google-auth-library"),nextra:tT("nextra")},tI=Object.keys(tR).join("|"),tU=new RegExp("from ['\"](".concat(tI,")['\"]")),tA=new RegExp("import ['\"](".concat(tI,")['\"]")),t_=new RegExp("import\\(['\"](".concat(tI,")['\"]\\)")),tO=new RegExp("require\\(['\"](".concat(tI,")['\"]\\)")),tD={"@mui/utils":"v0 is currently investigating an issue with @mui/utils. We appreciate your patience."},tL=Object.keys(tD).join("|"),tF=new RegExp("from ['\"](".concat(tL,")['\"]")),tM=new RegExp("import ['\"](".concat(tL,")['\"]")),tz=new RegExp("import\\(['\"](".concat(tL,")['\"]\\)")),tH=new RegExp("require\\(['\"](".concat(tL,")['\"]\\)"));var tV=l(21276);function tB(e){let{iframeId:t,iframeRef:l,activeTab:n,isPublished:a,src:i,origin:r,onLoad:o}=e;return(0,s.jsx)("iframe",{allow:"fullscreen; camera; microphone; gyroscope; accelerometer; clipboard-write; autoplay",title:"v0 block",className:(0,I.A)("h-full w-full select-none","preview"!==n&&(a?"hidden":"sr-only invisible")),"data-origin":r,"data-v0":!0,id:t,loading:"eager",onLoad:o,ref:l,sandbox:"allow-scripts allow-same-origin allow-forms allow-downloads allow-popups-to-escape-sandbox allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-presentation",src:"".concat(r).concat(i),fetchPriority:"high"})}var tW=l(86025),tZ=l(36324),tG=l(76201);function tK(e){let{error:t,onDismiss:l}=e,{submit:a}=(0,tG.yI)(),{isAuthor:i}=(0,to.Pk)(),r=(0,ej.oQ)(),{isCopied:o,copyToClipboard:c}=(0,g.C)({timeout:2e3}),[d,u]=(0,n.useState)(!1);return t?(0,s.jsx)("div",{className:"light absolute bottom-0 left-0 z-10 max-w-[400px] p-4",children:(0,s.jsxs)("div",{className:"text-background flex min-w-[300px] flex-col items-center gap-3 rounded-[8px] bg-red-600 p-2 text-sm",role:"alert",children:[(0,s.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between font-semibold",children:[(0,s.jsx)("span",{children:"Error"})," ",(0,s.jsxs)(b.$,{className:"text text-background m-[-4px] hover:text-gray-200",onClick:l,size:"xs",variant:"ghost",children:[(0,s.jsx)(tW.a,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,s.jsx)("div",{className:"flex w-full",children:(0,s.jsx)("span",{className:(0,f.cn)("font-small text-background cursor-pointer overflow-hidden whitespace-pre-wrap font-mono text-[11px]",{"line-clamp-2":!d}),onClick:()=>u(!d),children:t})})]}),i&&(0,s.jsxs)("div",{className:"flex w-full justify-end gap-2 align-middle",children:[(0,s.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:()=>{c(t)},size:"sm",variant:"link",children:(0,s.jsx)(tZ.U,{isCopied:o})}),(0,s.jsx)("div",{className:"border-alpha-400 border-l"}),(0,s.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",onClick:()=>{(0,eJ.Ny)()&&r(!1),a({type:"fix-with-v0",action:"fix-with-v0",input:"The code returns the following error:\n```\n".concat(t,"\n```\nRevise the code to address the error.")})},size:"sm",variant:"secondary",children:["Fix with ",(0,s.jsx)(eX.o,{className:"mt-[1px]"})]})]})]})}):null}function t$(e,t){let l=isNaN(parseInt(e))?e:"An unexpected error occurred (".concat(e,")");return t?"".concat(l,"\n\n").concat(t):l.replace("FatalRendererError: ","")}var tQ=l(33631);class tX{}tX.getIsPreviewable=e=>{let{source:t,closed:l,meta:s}=e,n=function(e,t){if(t){if(t.startsWith("use-"))return tN.REACT_HOOKS;if("instrumentation.ts"===t)return tN.INSTRUMENTATION_UNSUPPORTED;let e=t.split("."),l=e[e.length-1],s=e.length>2?e[e.length-2]:void 0;if(l&&!tC.some(e=>l===e))return tN.NON_JS_TS_FILE_UNSUPPORTED;if(s&&("test"===s||"spec"===s))return tN.TEST_FILES_UNSUPPORTED}for(let[t,l]of tP)if(new RegExp("from ['\"]".concat(t.replace("/","/"),"['\"]")).test(e))return l;return/\<ClerkProvider/.test(e)?tN.CLERK_UNSUPPORTED:/export default function (Root)?Layout/.test(e)?tN.LAYOUT_UNSUPPORTED:/(^|\n)['"]use server['"]/.test(e)?tN.SERVER_ACTION_UNSUPPORTED:/export default async function/.test(e)?tN.RSC_UNSUPPORTED:/(API_KEY|_SECRET) =/.test(e)||/YOUR_API_KEY/.test(e)?tN.API_KEY_UNSUPPORTED:!tE.some(t=>new RegExp("export (default )?async function ".concat(t,"\\(")).test(e)||new RegExp("export const ".concat(t," =")).test(e))||tN.ROUTE_HANDLER_UNSUPPORTED}(t,s.file);return"string"==typeof n?{error:n}:!!n&&l},tX.Render=n.memo(e=>{let t=(0,to.jo)(),{isPublished:l}=(0,P.usePublishedPage)(),{chatId:a}=(0,to.xz)(),{getBlockForked:i}=(0,tQ.t)(),{activeTab:r,setActiveTab:c,hasBlockPreview:d}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),{projectBlocks:u,projectBlockIndex:m,allBlocks:f}=(0,eb.P6)({blockId:e.blockId}),x=(0,n.useMemo)(()=>{var e;let t={},l=(null===(e=u[m])||void 0===e?void 0:e.meta.file)||".";for(let e of f)e.resultId&&e.meta.file&&(t[e.meta.file]=e.resultId);for(let e=0;e<=m;e++){let l=u[e],s=l.meta.file;s&&l.resultId&&(t[s]=l.resultId)}return{mapping:t,rootFileName:l}},[f,u,m]),p=(0,n.useRef)(null),[h,v]=(0,n.useState)(null);return(0,n.useEffect)(()=>{if(p.current)return function(e,t){let l=tv.get(e)||Math.random().toString();return tv.set(e,l),ty.push({id:l,listener:t}),()=>{let e=ty.findIndex(e=>e.listener===t);e>=0&&ty.splice(e,1)}}(p.current,t=>{switch(t.type){case"set_loading":p.current&&(tj(p.current,{type:"parent_ready"}),tj(p.current,{type:"sync_file_mapping",data:x}));break;case"error":case"runtime-error":{let l=t$(t.error);t.resultId===e.resultId&&v(s=>(s!==l&&e.isPreviewable&&(0,o.u)("V0BlockPreviewError",{messageId:e.messageId,blockId:e.blockId,resultId:t.resultId,from:e.meta.isQuickEdit?"quick-edit":void 0,forkedFromBlockId:i(e.blockId)},{errorMsg:l,errorCode:tV.rU}),l));break}case"started_visible_render":e.setIsPreviewable(!0)}})},[i,e,e.blockId,e.meta.from,e.resultId,e.setIsPreviewable,x,t]),(0,n.useEffect)(()=>{v(null)},[e.blockId]),(0,s.jsxs)(ti,{activeTab:r,allowRefresh:!0,hasBlockPreview:d,setActiveTab:c,...e,blockType:"v0",language:"typescriptreact",children:[h?(0,s.jsx)(tK,{error:h,onDismiss:()=>{v(null)}}):null,e.resultId&&"boolean"==typeof e.isPreviewable?(0,s.jsx)(tB,{activeTab:r,iframeId:(0,U.j)(e.resultId),iframeRef:p,isPublished:l,onLoad:()=>{p.current&&tj(p.current,{type:"sync_file_mapping",data:x})},origin:tg(a||e.blockId),src:"/p/".concat(e.resultId,"?c=1&flags=1&bid=").concat(e.blockId)}):null]})}),tX.Actions=n.memo(e=>{let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,s.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}),tX.TitleActions=()=>null;var tY=l(23271),tJ=l(2724);let tq=e=>{let t=(0,tJ.Q)(),l=t.globalSessionTokenCache||(t.globalSessionTokenCache=new Map),{data:s,error:n}=(0,tY.A)(e?"/chat/api/chat/frame-token?bid=".concat(e):null,async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch session token");return t.text()});return"string"!=typeof s||"string"!=typeof e||l.has(e)||l.set(e,s),{token:void 0===e?void 0:l.get(e),error:n}};var t0=l(42933),t1=l(37390),t5=l(23875);function t2(e){let{status:t="log"}=e;return(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",className:"absolute -translate-y-0.5 translate-x-0.5",children:(0,s.jsx)("circle",{cx:"12.5",cy:"5.5",r:"3.5",strokeWidth:"1.5",stroke:"hsl(var(--background))",className:"error"===t?"fill-red-500":"log"===t?"fill-blue-600":"fill-yellow-500"})})}function t3(e){let{blockId:t,isPreviewable:l,closed:n}=e,{hasBlockPreview:a,activeTab:i,setActiveTab:r}=(0,tk.P5)({blockId:t,isPreviewable:l}),o=(0,L.k)("previewBlock"),[c]=eB(t),d=e=>({key:"preview",disabled:!(0,eZ.O)(a),tooltip:"object"==typeof a&&"error"in a?a.error:n?e?o("preview"):void 0:o("previewIsStreaming"),display:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(O.p,{className:"group-disabled:hidden"}),(0,s.jsx)("div",{className:"hidden group-disabled:block",children:n?(0,s.jsx)(_.X,{}):(0,s.jsx)(j.y,{size:16})}),e?null:(0,s.jsx)("span",{children:o("preview")})]})}),u=e=>({key:"code",tooltip:e?o("code"):void 0,display:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[c?(0,s.jsx)(t2,{status:"warn"}):null,(0,s.jsx)(t5.Y,{}),e?null:(0,s.jsx)("span",{children:o("code")})]})});return(0,s.jsxs)("div",{className:"@container/tabs flex-1",children:[(0,s.jsx)("div",{className:"@[11rem]/tabs:hidden flex items-center gap-2",children:(0,s.jsx)(T.wb,{disableOverflow:!0,tabs:[d(!0),u(!0)],activeTabKey:i,setActiveTabKey:r,isLoading:!1})}),(0,s.jsx)("div",{className:"@[11rem]/tabs:flex hidden items-center gap-2",children:(0,s.jsx)(T.wb,{disableOverflow:!0,tabs:[d(!1),u(!1)],activeTabKey:i,setActiveTabKey:r,isLoading:!1})})]})}var t4=l(20222),t9=l(82923);function t6(e){let{errors:t,onDismiss:l}=e,{submit:a}=(0,tG.yI)(),{isAuthor:i}=(0,to.Pk)(),r=(0,ej.oQ)(),[o,c]=(0,n.useState)(!1),{isCopied:d,copyToClipboard:u}=(0,g.C)({timeout:2e3}),[m,x]=(0,n.useState)(0),[p,h]=(0,n.useState)(!1),v=(0,n.useMemo)(()=>t.find(e=>e.isFatal),[t]),j=(0,n.useCallback)(()=>{m<=0?x(t.length-1):x(m-1)},[t,m]),w=(0,n.useCallback)(()=>{m>=t.length-1?x(0):x(m+1)},[t,m]);if(!t.length)return null;let y=()=>{var e;u(null!==(e=null==v?void 0:v.text)&&void 0!==e?e:t[m].text)},k=()=>{var e;c(!0),v||l();let s="The code returns the following error:\n```\n".concat(null!==(e=null==v?void 0:v.text)&&void 0!==e?e:t[m].text,"\n```\nRevise the code to address the error.");(0,eJ.Ny)()&&r(!1),a({type:"fix-with-v0",action:"fix-with-v0",input:s})};return v?(0,s.jsx)("div",{className:"flex w-full justify-center",children:(0,s.jsx)("div",{className:"text-foreground absolute z-10 flex min-h-full max-w-4xl flex-col items-center justify-center px-10",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("h1",{className:"text-nowrap text-2xl font-semibold",children:"Runtime Error"}),(0,s.jsxs)("div",{className:"border-l-alpha-600 ml-5 flex flex-col gap-2 border-l pl-5",children:[(0,s.jsx)("h2",{className:"text-sm",children:v.text}),i&&(0,s.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,s.jsx)(b.$,{className:"border-background text-foreground bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:y,size:"sm",variant:"link",children:(0,s.jsx)(tZ.U,{isCopied:d})}),(0,s.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",onClick:k,size:"sm",variant:"secondary",disabled:o,children:["Fix with ",(0,s.jsx)(eX.o,{className:"mt-[1px]"})]})]})]})]})})}):(0,s.jsx)("div",{className:"light absolute bottom-0 left-0 z-10 max-w-[400px] p-4",children:(0,s.jsxs)("div",{className:"text-background flex min-w-[300px] flex-col items-center gap-3 rounded-[8px] bg-red-600 p-2 text-sm",role:"alert",children:[(0,s.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between font-semibold",children:[(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{children:t[m].isServer?"Server":null})," Error"]})," ",(0,s.jsxs)(b.$,{className:"text text-background m-[-4px] hover:text-gray-200",onClick:l,size:"xs",variant:"ghost",children:[(0,s.jsx)(tW.a,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,s.jsx)("div",{className:"flex w-full",children:(0,s.jsx)("span",{className:(0,f.cn)("font-small text-background cursor-pointer overflow-hidden whitespace-pre-wrap font-mono text-[11px]",{"line-clamp-2":!p}),onClick:()=>h(!p),children:t[m].text})})]}),(0,s.jsxs)("div",{className:"flex w-full justify-between gap-2 align-middle",children:[(0,s.jsx)("div",{className:"flex items-center gap-2 align-middle",children:t.length>1&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:j,variant:"link",children:(0,s.jsx)(t4.J,{})}),(0,s.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:w,variant:"link",children:(0,s.jsx)(t9.c,{})}),(0,s.jsxs)("span",{className:"text-xs",children:[m+1," of ",t.length]})]})}),(0,s.jsx)("div",{className:"flex items-center gap-2 align-middle",children:i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:y,size:"sm",variant:"link",children:(0,s.jsx)(tZ.U,{isCopied:d})}),(0,s.jsx)("div",{className:"border-alpha-400 border-l"}),(0,s.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",onClick:k,size:"sm",variant:"secondary",children:["Fix with ",(0,s.jsx)(eX.o,{className:"mt-[1px]"})]})]})})]})]})})}class t7{static Render(e){let{isPublished:t}=(0,P.usePublishedPage)(),{token:l,error:a}=tq(e.blockId),{activeForkKey:i}=(0,to.Pk)(),[r,c]=(0,n.useState)([]),d=(0,ez.F)(e.isPreviewable),{getBlockForked:u}=(0,tQ.t)();(0,n.useEffect)(()=>{c([])},[e.blockId,c]);let{projectBlocks:m,projectBlockIndex:f}=(0,eb.P6)({blockId:e.blockId}),{activeTab:x,setActiveTab:p,hasBlockPreview:h}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),v=(0,n.useMemo)(()=>{if("code-project"===e.meta.type)return(0,Y.A2)({source:e.source,blockType:"code-project",blockId:e.blockId})},[e.source,e.blockId,e.meta.type]),g=(0,n.useMemo)(()=>{if(e.closed||!v||!v.length)return;let t=v[v.length-1];if("file"in t.meta&&!t.isDeleted)return t.meta.file},[v,e.closed]),b=(0,n.useMemo)(()=>{if(!v)return;let e=[],t=new Map,l=m.slice(0,f),s=new Map;for(let t of l){let l=(0,Y.A2)({source:t.source,blockType:"code-project",blockId:t.id});e.push(...l)}for(let l of(e.push(...v),e)){let e=t.get(l.meta.file);e?t.set(l.meta.file,{...l,originalCode:e.source}):t.set(l.meta.file,{...l,originalCode:l.isQuickEdit&&!l.source?"// ".concat(l.isAttachmentQuickEdit?"Reading from":"Generating"," ").concat(l.meta.file):void 0}),s.has(l.meta.file)||s.set(l.meta.file,s.size)}return Array.from(t.values()).filter(e=>!e.isDeleted)},[f,m,v]),j=(0,ez.F)(b),w=(0,U.j)(e.blockId),{submit:y}=(0,tG.yI)();(0,n.useEffect)(()=>{let t=t=>{if(t.data&&"object"==typeof t.data&&t.data.__v0_remote__){if("error"===t.data.type){let l=t$(t.data.error,t.data.stack);c(s=>s.some(e=>e.text===l)||!d.current?s:((0,o.u)(t.data.isFatal?"V0BlockPreviewError":"V0BlockPreviewSoftError",{messageId:e.messageId,blockId:e.blockId,from:void 0!==e.meta.isQuickEdit?"quick-edit":void 0,forkedFromBlockId:u(e.blockId),resultId:e.resultId||""},{errorMsg:l,errorCode:tV.rU}),s.concat({isFatal:t.data.isFatal,isServer:t.data.isServer,text:l})))}if("frame_onload"===t.data.type&&c([]),"refine"===t.data.type&&j.current){var l;let s=j.current.find(e=>e.meta.file===t.data.file);if(!s){alert("File not found");return}let n=s.source.split("\n"),a=t.data.line,r=t.data.column;for(;n[a-1].length<r;)r-=n[a-1].length,a++;for(;r-1<n[a-1].length&&/\s/.test(n[a-1][r-1]);)r++;let o=n.slice(Math.max(0,a-4),a-1),c=n[a-1],d=n.slice(a,a+3),u=null===(l=c.substring(r).match(/^[\w.]+/))||void 0===l?void 0:l[0],m=u?(a>4?"...\n":"")+o.join("\n")+"\n"+c+"\n"+(" ".repeat(r)+"^".repeat(u.length))+"\n"+d.join("\n")+"\n"+(a+3<n.length?"...\n":""):c,f=(0,t1.ru)({file:s.meta.file,componentName:u,sourceContext:m,prompt:t.data.prompt}),x=(null==i?void 0:i.indexOf(e.messageId))||-1;i&&x>0&&x<i.length-1?y({action:"edit",input:f,userMessageId:i[x+1],type:"refinement"}):y({action:"new",input:f,attachments:[],type:"refinement"})}}};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}},[w,y,i,c,e.messageId,j,e.blockId,d,e.meta.isQuickEdit,u]);let k=null;if(e.blockId&&e.isPreviewable&&(l||a)){let n=new URLSearchParams;t&&n.set("mql","true"),a||!l?n.set("__v0",""):l&&n.set("__v0_token",l),k=(0,s.jsx)(tB,{activeTab:x,iframeId:w,isPublished:t,origin:function(e){let{disableLocalhost:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=function(e){let t="";for(let l=0;l<e.length;l++){let s=e.charCodeAt(l).toString(16);s.length<2&&(s="0"+s),t+=s}return BigInt("0x"+t).toString(36)}(e);if("generated.vusercontent.net".endsWith(".vercel.sh")){let e="generated.vusercontent.net".split(".")[0].replace(/^v0-frame-/g,"");return tb("".concat(l,"--").concat(e,".dev-lite.vusercontent.net"))}return tb("".concat(l,".lite.vusercontent.net"))}(e.blockId),src:"/?".concat(n.toString())}),"code-project"===e.meta.type&&(k=e.isV3?(0,s.jsx)("div",{className:"size-full","data-slot":"browser-content",children:k}):(0,s.jsx)(t0.A,{allowMobileFullscreen:e.allowMobileFullscreen,blockId:e.blockId,iframeId:w,devTools:!!e.isAuthor,isV3:e.isV3,children:(0,s.jsx)("div",{className:"flex-1 shrink-0","data-slot":"browser-content",children:k})}))}return(0,s.jsxs)(ti,{activeTab:x,hasBlockPreview:h,setActiveTab:p,initialFileTreeSize:e.initialFileTreeSize,...e,loadingPath:g,files:b,blockType:"code-project"===e.meta.type?"code-project":"v0",language:"typescriptreact",allowRefresh:"code-project"!==e.meta.type,allowFullScreen:"code-project"!==e.meta.type,isV3:e.isV3,initialConsoleSize:e.initialConsoleSize,initialConsoleExpanded:e.initialConsoleExpanded,children:[r.length?(0,s.jsx)(t6,{errors:r,onDismiss:()=>{c([])}}):null,k]})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,s.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}}t7.getIsPreviewable=e=>{let{closed:t,source:l,meta:s}=e;if(!t)return!1;let n=function(e,t){let l=/\.(ts|tsx|js|jsx|mjs|mts|cjs)$/i,s=!1,n="code-project"===t.type?(0,Y.A2)({source:e,blockType:"code-project",blockId:"fake-block-id"}):[{source:e,meta:t,isDeleted:!1}];if(!(n=n.filter(e=>!e.isDeleted))||0===n.length||!n.some(e=>e.meta.file&&(e.meta.file.endsWith(".tsx")||e.meta.file.endsWith(".jsx"))))return tS.NON_SUPPORTED_FILES;let a=n.filter(e=>e.meta.file&&l.test(e.meta.file));if(!a.length)return tS.NON_SUPPORTED_FILES;for(let{source:e}of a){let t=e.split("\n").filter(e=>e.trim().startsWith("import")).join("\n"),l=t.match(tU)||t.match(tA)||e.match(t_)||e.match(tO);if(l)return tR[l[1]];let n=t.match(tF)||t.match(tM)||e.match(tz)||e.match(tH);if(n)return{warning:tD[n[1]]};e.includes("export")&&(s=!0)}return!!s||tS.NO_EXPORTED_COMPONENT}(l,s);return"string"==typeof n?{error:n}:n},t7.TitleActions=n.memo(e=>{let{blockId:t,isPreviewable:l,closed:n}=e;return(0,s.jsx)(t3,{blockId:t,isPreviewable:l,closed:n})});class t8{static Actions(){return null}}function le(e,t,l){let[s,a]=(0,n.useState)(!1),i=(0,ez.F)(s),r=(0,ez.F)(t);(0,n.useEffect)(()=>{let t=document.getElementById(l),s=l=>{if(l.origin===t.dataset.origin&&l.data.type===e+"_READY"&&(a(!0),r.current)){var s;null===(s=t.contentWindow)||void 0===s||s.postMessage({type:e+"_RENDER",source:r.current},t.dataset.origin||"")}};return window.addEventListener("message",s),()=>{window.removeEventListener("message",s)}},[e,l,r]),(0,n.useEffect)(()=>{let s=document.getElementById(l);if(s){var n,a;i.current?null===(n=s.contentWindow)||void 0===n||n.postMessage({type:e+"_RENDER",source:t},s.dataset.origin||""):null===(a=s.contentWindow)||void 0===a||a.postMessage({type:e+"_PING"},s.dataset.origin||"")}},[t,e,l,i])}t8.getIsPreviewable=()=>!1,t8.Render=n.memo(e=>(0,s.jsx)(ti,{activeTab:"code",hasBlockPreview:!1,hidePreviewPane:!0,setActiveTab:()=>{},...e,blockType:"code"})),t8.TitleActions=null;let lt=RegExp("<!DOCTYPE html>.*?<\\/html>","s");class ll{static Render(e){let{isPublished:t}=(0,P.usePublishedPage)(),{chatId:l}=(0,to.xz)(),{activeTab:n,setActiveTab:a,hasBlockPreview:i}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),r=(0,U.j)(e.blockId);return le("HTML",e.source,r),(0,s.jsx)(ti,{activeTab:n,hasBlockPreview:i,setActiveTab:a,...e,blockType:"html",language:"html",children:(0,s.jsx)(tB,{activeTab:n,iframeId:r,isPublished:t,origin:tg(l||e.blockId),src:"/render/html"})})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,s.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}}ll.getIsPreviewable=e=>{let{source:t,closed:l}=e;return l||lt.test(t)},ll.TitleActions=null;var ls=l(16129),ln=l(23248),la=l(54080),li=l(14866),lr=l(91022);class lo{static Render(e){let{isPublished:t}=(0,P.usePublishedPage)(),{activeTab:l,setActiveTab:a,hasBlockPreview:i}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),[r,o]=(0,n.useState)(void 0),c=e.source.replaceAll(/\\+`/g,"`");return(0,s.jsx)(ti,{activeTab:l,hasBlockPreview:i,setActiveTab:a,...e,blockType:"markdown",language:"markdown",source:c,onEdit:o,children:(0,s.jsx)("div",{className:(0,f.cn)("flex h-full w-full justify-center overflow-y-auto p-4 md:py-6","preview"!==l&&(t?"hidden":"sr-only invisible")),children:(0,s.jsx)(ls.s,{children:(0,s.jsx)(ln.c,{remarkPlugins:[la.A,li.A],rehypePlugins:[lr.A],children:void 0===r?c:r})})})})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,s.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}}lo.getIsPreviewable=()=>!0,lo.TitleActions=null;class lc{static Render(e){let{chatId:t}=(0,to.xz)(),{isPublished:l}=(0,P.usePublishedPage)(),{activeTab:n,setActiveTab:a,hasBlockPreview:i}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),r=(0,U.j)(e.blockId);return le("VUE",e.source,r),(0,s.jsx)(ti,{activeTab:n,allowRefresh:!0,hasBlockPreview:i,setActiveTab:a,...e,blockType:"vue",language:"vue",resultId:e.blockId,children:(0,s.jsx)(tB,{activeTab:n,iframeId:r,isPublished:l,origin:tg(t||e.blockId),src:"/render/vue"},r)})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,s.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}}lc.getIsPreviewable=e=>{let{closed:t}=e;return t},lc.TitleActions=null;class ld{static Render(e){let{chatId:t}=(0,to.xz)(),{isPublished:l}=(0,P.usePublishedPage)(),{activeTab:n,setActiveTab:a,hasBlockPreview:i}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),r=(0,U.j)(e.blockId);return le("SVELTE",e.source,r),(0,s.jsx)(ti,{activeTab:n,hasBlockPreview:i,setActiveTab:a,...e,blockType:"svelte",language:"svelte",children:(0,s.jsx)(tB,{activeTab:n,iframeId:r,isPublished:l,origin:tg(t||e.blockId),src:"/render/svelte"},r)})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tk.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,s.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}}ld.getIsPreviewable=e=>{let{closed:t}=e;return t},ld.TitleActions=null;class lu{static Render(e){let{source:t,blockId:l,remoteInfo:a,closed:i}=e,{chatId:r}=(0,to.xz)(),o=(0,U.j)("remote-preview"),{data:d}=(0,c.Ay)(l?["remote:preview",l]:null,null,{fallbackData:(null==a?void 0:a.accepted)||!1}),{activeTab:u,setActiveTab:m}=(0,tk.P5)({blockId:e.blockId,isPreviewable:i});return(0,n.useEffect)(()=>{if(!i||!(l||r))return;let e=new AbortController,t=async()=>{try{await fetch("/chat/api/chat/remote/preview?".concat("@remote"===l?"cid=".concat(r):"bid=".concat(l)),{signal:e.signal})}catch(e){}};return setTimeout(()=>{t()},0),()=>{e.abort()}},[i,r,l]),(0,s.jsx)(ti,{activeTab:"@remote"===l?"preview":u,setActiveTab:m,...e,meta:"@remote"===l?{...e.meta}:{...e.meta,file:"Files"},allowFullScreen:!1,language:"plaintext",blockType:"local",remoteInfo:a,source:t,hasBlockPreview:!!d||e.closed,children:i||"@remote"===l?(0,s.jsx)(t0.A,{iframeId:o,children:(0,s.jsx)(tB,{activeTab:"@remote"===l?"preview":u,iframeId:o,isPublished:!1,origin:"",src:"/chat/api/chat/remote/proxy?cid=".concat(r)},o)}):null})}static Actions(e){let{blockId:t,isPreviewable:l}=e,{hasBlockPreview:n,activeTab:a,setActiveTab:i}=(0,tk.P5)({blockId:t,isPreviewable:l});return"@remote"===t?null:(0,s.jsx)(U.r,{hasBlockPreview:n,activeTab:a,setActiveTab:i})}}function lm(e){switch(e){case"node.js":case"nodejs":case"python":return tx;case"markdown":return lo;case"html":return ll;case"v0":case"react":case"tsx":return tX;case"vue":return lc;case"svelte":return ld;case"code":return t8;case"local":return lu;case"code-project":return t7;case"inline-sql":return null}}function lf(e){var t;let{block:l,initialSize:a,initialConsoleSize:i,initialConsoleExpanded:r,initialFileTreeSize:o,allowMobileFullscreen:c,location:d="header",isAuthor:u}=e,{isPublished:m}=(0,P.usePublishedPage)(),{history:f,currentBlockIndex:x}=(0,eb.P6)({blockId:(null==l?void 0:l.id)||""}),p=l?lm(l.type):null,h=!!p&&!!l&&p.getIsPreviewable({source:l.source,closed:l.closed,meta:l.meta,id:l.id}),[v,g]=(0,n.useState)(),b=v||h;return((0,n.useEffect)(()=>{g(void 0)},[null==l?void 0:l.id]),l&&p)?{action:m&&"footer"!==d?null:(0,s.jsx)(p.Actions,{blockId:l.id,isPreviewable:b,closed:l.closed}),titleActions:"code-project"===l.meta.type&&p.TitleActions?(0,s.jsx)(p.TitleActions,{blockId:l.id,isPreviewable:b,closed:l.closed}):null,content:(0,s.jsx)(p.Render,{allowMobileFullscreen:c,initialFileTreeSize:o,blockId:l.id,resultId:l.resultId,closed:l.closed,initialOutputSize:a,messageId:l.messageId,language:l.language,meta:l.meta,source:l.source,remoteInfo:l.remoteInfo,isPreviewable:b,isAuthor:u,setIsPreviewable:g,hasSourceBeenEdited:l.hasSourceBeenEdited,originalCode:x>0?null===(t=f[x-1])||void 0===t?void 0:t.source:void 0,latestDeploymentInfo:l.latestDeploymentInfo,initialConsoleSize:null!=i?i:void 0,initialConsoleExpanded:null!=r?r:void 0})}:{action:null,content:null}}function lx(e){let{block:t,allowMobileFullscreen:l,initialSize:s}=e,{content:n}=lf({block:t,initialSize:s,allowMobileFullscreen:l,location:void 0});return n}lu.getIsPreviewable=e=>{let{closed:t}=e;return t},lu.TitleActions=null},83222:(e,t,l)=>{"use strict";l.d(t,{h:()=>k});var s=l(27545),n=l(3906),a=l(16579),i=l(31781),r=l(39149),o=l(38680);let c=o.bL,d=o.R6,u=o.Ke;var m=l(97797),f=l(10289);function x(e){let{className:t}=e;return(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:(0,n.cn)(t),children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 13.5V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V8H3V1.5H8V5V6.5H9.5H13V13.5C13 14.0523 12.5523 14.5 12 14.5H6V16H12C13.3807 16 14.5 14.8807 14.5 13.5ZM9.5 5V2.12132L12.3787 5H9.5ZM2.31885 12.8194H0V11.3194H2.31885V9H3.81885V11.3194H6.13775V12.8194H3.81885V15.1377H2.31885V12.8194Z",fill:"currentColor"})})}function p(e){let{className:t}=e;return(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:(0,n.cn)(t),children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 6.5V13.5C14.5 14.8807 13.3807 16 12 16H5V14.5H12C12.5523 14.5 13 14.0523 13 13.5V6.5H9.5H8V5V1.5H3V9H1.5V1.5V0H3H8H9.08579C9.351 0 9.60536 0.105357 9.79289 0.292893L14.2071 4.70711C14.3946 4.89464 14.5 5.149 14.5 5.41421V6.5ZM9.5 2.12132V5H12.3787L9.5 2.12132ZM0 11.25V12.75H6V11.25H0Z",fill:"currentColor"})})}var h=l(28970),v=l(96262),g=l(83147);function b(e){let{added:t,removed:l,className:a}=e;if(!t&&!l)return null;let i=t?(0,s.jsx)("div",{className:"text-green-700",children:"number"==typeof t?"+".concat(t):"+"}):null,r=l?(0,s.jsx)("div",{className:"text-red-700",children:"number"==typeof l?"-".concat(l):"-"}):null;return(0,s.jsxs)("div",{className:(0,n.cn)("flex items-center gap-0.5 text-xs text-gray-500",a),children:[i,i&&r?(0,s.jsx)("div",{children:"/"}):null,r]})}function j(e){return e?(0,v.n)(e,(e,t)=>e.items&&!t.items?-1:!e.items&&t.items?1:e.title.localeCompare(t.title)):[]}let w=(0,r.createContext)(void 0),y=()=>{let e=(0,r.useContext)(w);if(void 0===e)throw Error("useFileTree must be used within a FileTreeProvider");return e};function k(e){let{loading:t,active:l,items:a,onSelect:i,FileActions:o,FolderActions:c,TreeActions:d,className:u,lockingStatus:m}=e,f=(0,r.useMemo)(()=>j(a),[a]),x=(0,s.jsx)("ul",{className:(0,n.cn)("group flex list-none flex-col",u),children:f.map(e=>(0,s.jsx)(N,{item:e},e.value))}),p=x;return d&&(p=(0,s.jsxs)(h.tz,{children:[(0,s.jsx)(h.Rc,{asChild:!0,children:x}),(0,s.jsx)(h.Ip,{children:(0,s.jsx)(h.Q2,{children:(0,s.jsx)(d,{})})})]})),(0,s.jsx)(w.Provider,{value:{onSelect:i,active:l,lockingStatus:m,loading:t,FileActions:null!=o?o:()=>null,FolderActions:null!=c?c:()=>null,TreeActions:null!=d?d:()=>null},children:p})}function N(e){let{item:t}=e;return t.items?(0,s.jsx)(P,{item:t}):(0,s.jsx)(E,{item:t})}function P(e){var t;let{className:l,item:a}=e,{active:i,FolderActions:o}=y(),[m,f]=(0,r.useState)(!0),x=!!a.items&&function e(t,l){return t.some(t=>t.value===l||!!t.items&&e(t.items,l))}(a.items,i);(0,r.useEffect)(()=>{x&&f(!0)},[x]);let p=(0,r.useMemo)(()=>j(a.items),[a.items]),v=(null===(t=a.items)||void 0===t?void 0:t.length)?(0,s.jsx)("div",{"data-sidebar":"menu-sub",className:"border-alpha-400 group-hover:border-l-alpha-400 duration-250 ml-3 flex min-w-0 translate-x-[0.5px] flex-col border-l border-l-transparent pl-1 transition-colors",children:p.map(e=>(0,s.jsx)(N,{item:e},e.value))}):null;return(0,s.jsxs)(h.tz,{children:[(0,s.jsxs)(c,{className:"flex flex-col gap-0",open:m,onOpenChange:f,children:[(0,s.jsx)(d,{asChild:!0,children:(0,s.jsx)(h.Rc,{asChild:!0,children:(0,s.jsx)(C,{icon:(0,s.jsx)(g.A,{className:(0,n.cn)("h-4 w-4 transition-transform",{"rotate-90":m})}),onClick:e=>{e.currentTarget instanceof HTMLButtonElement&&e.currentTarget.blur(),f(e=>!e)},className:l,status:null,children:a.title})})}),(0,s.jsx)(u,{children:v})]}),(0,s.jsx)(h.Ip,{children:(0,s.jsx)(h.Q2,{children:(0,s.jsx)(o,{item:a})})})]})}function E(e){let t,{item:l,className:o,...c}=e,{onSelect:d,active:u,loading:m,FileActions:v,lockingStatus:g}=y(),j=(0,r.useMemo)(()=>m===l.value?(0,s.jsx)(f.y,{size:16}):l.addedCount&&!l.removedCount?(0,s.jsx)(x,{}):!l.addedCount&&l.removedCount?(0,s.jsx)(p,{}):(0,s.jsx)(a.Z,{}),[l.addedCount,l.removedCount,l.value,m]);return l.value?(t=(null==g?void 0:g.type)==="locking-all"||(null==g?void 0:g.type)==="unlocking-all"||((null==g?void 0:g.type)==="locking"||(null==g?void 0:g.type)==="unlocking")&&g.fileName===l.value||((null==g?void 0:g.type)==="locking-folder"||(null==g?void 0:g.type)==="unlocking-folder")&&l.value.startsWith(g.folderName)?(0,s.jsx)("div",{className:"flex items-center justify-end",children:(0,s.jsx)(f.y,{size:14,className:"m-0 w-fit p-0"})}):l.isLocked?(0,s.jsx)("div",{className:"flex items-center justify-end",children:(0,s.jsx)(i.C,{size:14,className:"m-0 w-fit p-0"})}):(0,s.jsx)(b,{added:l.addedCount,removed:l.removedCount}),(0,s.jsxs)(h.tz,{children:[(0,s.jsx)(h.Rc,{asChild:!0,children:(0,s.jsx)(C,{active:l.value===u,onClick:()=>d(l.value),className:(0,n.cn)(o,l.isLocked&&"text-gray-500"),icon:j,status:t,...c,children:l.title})}),(0,s.jsx)(h.Ip,{children:(0,s.jsx)(h.Q2,{children:(0,s.jsx)(v,{item:l})})})]})):null}function C(e){let{className:t,active:l,icon:a,status:i,children:r,...o}=e;return(0,s.jsx)("li",{children:(0,s.jsxs)(m.$,{className:(0,n.cn)("data-[active=true]:bg-alpha-200 mb-0 h-[26px] w-full min-w-36 justify-between gap-2 pl-0.5 pr-1",t),"data-active":l,size:"sm",variant:"ghost",title:r,...o,children:[(0,s.jsxs)("div",{className:"flex min-w-0 items-center gap-1",children:[(0,s.jsx)("div",{className:"p-0.5 text-gray-500 group-focus:text-gray-900 group-[[data-active=true]]:text-gray-900",children:a}),(0,s.jsx)("span",{className:"truncate font-normal",children:r})]}),i]})})}},96008:(e,t,l)=>{"use strict";async function s(e){let t=await fetch("/chat/api/blocks",{method:"PUT",body:JSON.stringify(e)});if(!t.ok)return{success:!1};let l=await t.json();return{success:l.success,transformedSource:l.success?l.transformedSource:void 0}}l.d(t,{Z:()=>s})}}]);